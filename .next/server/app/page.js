(()=>{var e={};e.id=931,e.ids=[931],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},20629:e=>{"use strict";e.exports=require("fs/promises")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},35816:e=>{"use strict";e.exports=require("process")},68621:e=>{"use strict";e.exports=require("punycode")},86624:e=>{"use strict";e.exports=require("querystring")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},72477:e=>{"use strict";e.exports=require("node:stream/web")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},58359:()=>{},93739:()=>{},53721:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>h,tree:()=>c}),r(33079),r(4817),r(35866);var n=r(23191),i=r(88716),s=r(37922),o=r.n(s),a=r(95231),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,33079)),"/Users/macbook/Desktop/Projects/visionvalu_-ai-property-valuation/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,4817)),"/Users/macbook/Desktop/Projects/visionvalu_-ai-property-valuation/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],u=["/Users/macbook/Desktop/Projects/visionvalu_-ai-property-valuation/app/page.tsx"],d="/page",p={require:r,loadChunk:()=>Promise.resolve()},h=new n.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},66515:(e,t,r)=>{Promise.resolve().then(r.bind(r,33136)),Promise.resolve().then(r.bind(r,56915))},77618:(e,t,r)=>{Promise.resolve().then(r.bind(r,58327))},9617:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,12994,23)),Promise.resolve().then(r.t.bind(r,96114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,79671,23)),Promise.resolve().then(r.t.bind(r,41868,23)),Promise.resolve().then(r.t.bind(r,84759,23))},58327:(e,t,r)=>{"use strict";let n,i;r.d(t,{default:()=>rD});var s,o,a,l,c,u,d,p,h,f,m,g,y,v,_,E,b,x,A,T,S,C,w,O,I,N,k,R,P,j,D,U,M,L,G,q,F,B,H,V,$,J,W,K,Y,z,X,Z,Q,ee,et=r(10326),er=r(17577);let en=({onNavigateToApp:e})=>et.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:et.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,et.jsxs)("div",{className:"flex items-center justify-between",children:[(0,et.jsxs)("div",{className:"flex items-center space-x-3",children:[et.jsx("span",{className:"text-3xl",children:"\uD83C\uDFE0"}),et.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"HomeWorth"})]}),(0,et.jsxs)("nav",{className:"hidden md:flex items-center space-x-8",children:[et.jsx("a",{href:"#features",className:"text-slate-600 hover:text-slate-900 font-medium transition-colors duration-200",children:"Features"}),et.jsx("a",{href:"#pricing",className:"text-slate-600 hover:text-slate-900 font-medium transition-colors duration-200",children:"Pricing"}),et.jsx("a",{href:"#testimonials",className:"text-slate-600 hover:text-slate-900 font-medium transition-colors duration-200",children:"Reviews"}),et.jsx("a",{href:"/login",className:"text-slate-600 hover:text-slate-900 font-medium transition-colors duration-200",children:"Sign In"}),et.jsx("a",{href:"/signup",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition-colors duration-200",children:"Get Started"}),et.jsx("button",{onClick:e,className:"bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-2 px-6 rounded-lg transition-colors duration-200",children:"Try Free Demo"})]})]})})}),ei=({onNavigateToApp:e})=>(0,et.jsxs)("section",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 via-white to-indigo-50 py-20 lg:py-32",children:[(0,et.jsxs)("div",{className:"absolute inset-0 -z-10",children:[et.jsx("div",{className:"absolute top-0 left-1/4 w-72 h-72 bg-blue-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse"}),et.jsx("div",{className:"absolute top-0 right-1/4 w-72 h-72 bg-purple-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse animation-delay-2000"}),et.jsx("div",{className:"absolute -bottom-8 left-1/3 w-72 h-72 bg-pink-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-pulse animation-delay-4000"})]}),et.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,et.jsxs)("div",{className:"text-center",children:[(0,et.jsxs)("div",{className:"max-w-4xl mx-auto fade-in",children:[(0,et.jsxs)("div",{className:"inline-flex items-center px-4 py-2 rounded-full bg-blue-100 text-blue-800 text-sm font-medium mb-8 animate-pulse",children:[et.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),"AI-Powered Property Valuation"]}),(0,et.jsxs)("h1",{className:"text-4xl sm:text-5xl lg:text-7xl font-bold text-slate-900 mb-6 leading-tight",children:[et.jsx("span",{className:"block",children:"AI-Powered"}),et.jsx("span",{className:"block gradient-text",children:"HomeWorth"}),et.jsx("span",{className:"block text-3xl sm:text-4xl lg:text-5xl font-normal text-slate-600 mt-2",children:"Property Valuation"})]}),et.jsx("p",{className:"text-xl sm:text-2xl text-slate-600 mb-8 max-w-3xl mx-auto leading-relaxed",children:"Get instant, accurate property valuations using advanced AI technology. Upload photos and receive detailed market analysis in minutes, not weeks."}),(0,et.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-12",children:[(0,et.jsxs)("button",{onClick:e,className:"btn-primary text-lg px-8 py-4 hover-lift group relative overflow-hidden",children:[(0,et.jsxs)("span",{className:"relative z-10 flex items-center",children:[et.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Try Free Demo"]}),et.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),et.jsx("button",{onClick:()=>{let e=document.getElementById("pricing");e&&e.scrollIntoView({behavior:"smooth"})},className:"btn-outline text-lg px-8 py-4 hover-lift",children:(0,et.jsxs)("span",{className:"flex items-center",children:[et.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),"View Pricing"]})})]}),(0,et.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 text-sm text-slate-500 mb-16",children:[(0,et.jsxs)("div",{className:"flex items-center gap-2 hover:text-slate-700 transition-colors duration-200",children:[et.jsx("div",{className:"w-5 h-5 bg-green-100 rounded-full flex items-center justify-center",children:et.jsx("span",{className:"text-green-500 text-xs",children:"✓"})}),et.jsx("span",{children:"No registration required"})]}),(0,et.jsxs)("div",{className:"flex items-center gap-2 hover:text-slate-700 transition-colors duration-200",children:[et.jsx("div",{className:"w-5 h-5 bg-green-100 rounded-full flex items-center justify-center",children:et.jsx("span",{className:"text-green-500 text-xs",children:"✓"})}),et.jsx("span",{children:"Instant results"})]}),(0,et.jsxs)("div",{className:"flex items-center gap-2 hover:text-slate-700 transition-colors duration-200",children:[et.jsx("div",{className:"w-5 h-5 bg-green-100 rounded-full flex items-center justify-center",children:et.jsx("span",{className:"text-green-500 text-xs",children:"✓"})}),et.jsx("span",{children:"Professional accuracy"})]})]})]}),et.jsx("div",{className:"mt-16 max-w-6xl mx-auto",children:et.jsx("div",{className:"relative bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl p-8 border border-slate-200/50 hover-lift",children:(0,et.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-center",children:[(0,et.jsxs)("div",{className:"space-y-6",children:[(0,et.jsxs)("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl p-6 border border-slate-200 hover:shadow-md transition-shadow duration-200",children:[(0,et.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[et.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),et.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),et.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),et.jsx("span",{className:"ml-2 text-sm text-slate-500",children:"Property Photos"})]}),et.jsx("div",{className:"text-sm text-slate-600 font-medium",children:"Upload Property Photos"}),et.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Drag & drop or click to browse"})]}),(0,et.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200 hover:shadow-md transition-shadow duration-200",children:[(0,et.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[et.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),et.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"AI Analysis in Progress..."})]}),et.jsx("div",{className:"text-sm text-blue-600 mb-3",children:"Processing images and market data"}),et.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:et.jsx("div",{className:"bg-blue-500 h-2 rounded-full w-3/4 animate-pulse"})})]})]}),et.jsx("div",{className:"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 rounded-2xl p-8 border border-slate-200 hover:shadow-lg transition-all duration-200",children:(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"text-4xl font-bold gradient-text mb-2",children:"$425,000"}),et.jsx("div",{className:"text-sm text-slate-600 mb-6 font-medium",children:"Estimated Property Value"}),(0,et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,et.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow duration-200",children:[et.jsx("div",{className:"font-semibold text-slate-700 text-sm mb-1",children:"Confidence"}),et.jsx("div",{className:"text-2xl font-bold text-green-600",children:"92%"}),et.jsx("div",{className:"text-xs text-slate-500",children:"High accuracy"})]}),(0,et.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-slate-200 hover:shadow-md transition-shadow duration-200",children:[et.jsx("div",{className:"font-semibold text-slate-700 text-sm mb-1",children:"Market Trend"}),et.jsx("div",{className:"text-2xl font-bold text-green-600",children:"+5.2%"}),et.jsx("div",{className:"text-xs text-slate-500",children:"YoY growth"})]})]}),(0,et.jsxs)("div",{className:"mt-6",children:[et.jsx("div",{className:"text-xs text-slate-500 mb-2",children:"Property Type"}),et.jsx("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-medium",children:"Single Family Home"})]})]})})]})})})]})})]}),es=()=>et.jsx("section",{id:"features",className:"py-20 bg-slate-50",children:(0,et.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,et.jsxs)("div",{className:"text-center mb-16",children:[et.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Why Choose HomeWorth?"}),et.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Our AI-powered platform revolutionizes property valuation with speed, accuracy, and affordability."})]}),et.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[{icon:"\uD83E\uDD16",title:"Advanced AI Technology",description:"Powered by cutting-edge machine learning algorithms trained on millions of property transactions.",benefits:["Market trend analysis","Property condition assessment","Location-based insights"]},{icon:"⚡",title:"Instant Results",description:"Get professional property valuations in seconds, not weeks. No waiting for appraisers.",benefits:["30-second analysis","Real-time market data","Immediate reports"]},{icon:"\uD83D\uDCCA",title:"Comprehensive Reports",description:"Detailed valuation reports with market comparisons, trend analysis, and confidence scores.",benefits:["Market comparisons","Historical trends","Confidence indicators"]},{icon:"\uD83C\uDFAF",title:"Professional Accuracy",description:"Our AI models achieve 95%+ accuracy compared to traditional appraisals.",benefits:["95%+ accuracy rate","Professional standards","Market validation"]},{icon:"\uD83D\uDD12",title:"Secure & Private",description:"Your property data is encrypted and never shared. Complete privacy protection.",benefits:["End-to-end encryption","No data sharing","GDPR compliant"]},{icon:"\uD83D\uDCB0",title:"Cost Effective",description:"Save thousands compared to traditional appraisals. Professional results at a fraction of the cost.",benefits:["90% cost savings","No hidden fees","Transparent pricing"]}].map((e,t)=>(0,et.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-sm hover:shadow-md transition-shadow duration-200",children:[et.jsx("div",{className:"text-4xl mb-4",children:e.icon}),et.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:e.title}),et.jsx("p",{className:"text-slate-600 mb-6",children:e.description}),et.jsx("ul",{className:"space-y-2",children:e.benefits.map((e,t)=>(0,et.jsxs)("li",{className:"flex items-center text-sm text-slate-600",children:[et.jsx("span",{className:"text-green-500 mr-2",children:"✓"}),e]},t))})]},t))}),(0,et.jsxs)("div",{className:"mt-20 bg-white rounded-2xl p-8 lg:p-12 shadow-sm",children:[(0,et.jsxs)("div",{className:"text-center mb-12",children:[et.jsx("h3",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-4",children:"Trusted by Thousands"}),et.jsx("p",{className:"text-slate-600",children:"Join the growing community of professionals using HomeWorth"})]}),(0,et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:[(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"50K+"}),et.jsx("div",{className:"text-slate-600",children:"Properties Valued"})]}),(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"95%"}),et.jsx("div",{className:"text-slate-600",children:"Accuracy Rate"})]}),(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"30s"}),et.jsx("div",{className:"text-slate-600",children:"Average Analysis Time"})]}),(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"$2M+"}),et.jsx("div",{className:"text-slate-600",children:"Saved in Appraisal Costs"})]})]})]})]})}),eo=({onNavigateToApp:e})=>{let[t,r]=(0,er.useState)(!1);return et.jsx("section",{className:"py-20 bg-white",children:(0,et.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,et.jsxs)("div",{className:"text-center mb-16",children:[et.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Try Our AI Valuation Engine"}),et.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Experience the power of AI-driven property valuation. Upload your property photos and see how our advanced algorithms analyze market data in real-time."})]}),et.jsx("div",{className:"max-w-4xl mx-auto",children:t?(0,et.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-8 text-center",children:[et.jsx("div",{className:"w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-2xl text-white",children:"✓"})}),et.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Demo Started!"}),et.jsx("p",{className:"text-slate-600 mb-6",children:"Scroll down to upload your property photos and see our AI in action."}),et.jsx("button",{onClick:()=>r(!1),className:"text-blue-600 hover:text-blue-700 font-medium",children:"← Back to Demo Info"})]}):(0,et.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl p-8 lg:p-12 text-center",children:[(0,et.jsxs)("div",{className:"mb-8",children:[et.jsx("div",{className:"w-20 h-20 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-6",children:et.jsx("span",{className:"text-3xl text-white",children:"\uD83D\uDCF8"})}),et.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Upload & Analyze in 3 Simple Steps"}),(0,et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,et.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[et.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-blue-600 font-bold",children:"1"})}),et.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Upload Photos"}),et.jsx("p",{className:"text-sm text-slate-600",children:"Add 3-5 clear property images"})]}),(0,et.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[et.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-blue-600 font-bold",children:"2"})}),et.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"AI Analysis"}),et.jsx("p",{className:"text-sm text-slate-600",children:"Our AI analyzes your property"})]}),(0,et.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[et.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-blue-600 font-bold",children:"3"})}),et.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Get Results"}),et.jsx("p",{className:"text-sm text-slate-600",children:"Receive detailed valuation report"})]})]})]}),et.jsx("button",{onClick:()=>{e?e():(r(!0),setTimeout(()=>{let e=document.querySelector("[data-main-app]");e&&e.scrollIntoView({behavior:"smooth"})},500))},className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-8 rounded-lg text-lg transition-colors duration-200 shadow-lg hover:shadow-xl",children:"Start Free Demo"}),et.jsx("p",{className:"text-sm text-slate-500 mt-4",children:"No registration required • Instant results • Professional accuracy"})]})}),(0,et.jsxs)("div",{className:"mt-16 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-blue-600 text-xl",children:"⚡"})}),et.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Lightning Fast"}),et.jsx("p",{className:"text-sm text-slate-600",children:"Get results in under 30 seconds"})]}),(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-blue-600 text-xl",children:"\uD83C\uDFAF"})}),et.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Highly Accurate"}),et.jsx("p",{className:"text-sm text-slate-600",children:"Professional-grade valuation models"})]}),(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-blue-600 text-xl",children:"\uD83D\uDCCA"})}),et.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Detailed Reports"}),et.jsx("p",{className:"text-sm text-slate-600",children:"Comprehensive market analysis"})]}),(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-blue-600 text-xl",children:"\uD83D\uDD12"})}),et.jsx("h4",{className:"font-semibold text-slate-900 mb-2",children:"Secure & Private"}),et.jsx("p",{className:"text-sm text-slate-600",children:"Your data is protected"})]})]})]})})},ea=()=>et.jsx("section",{id:"pricing",className:"py-20 bg-white",children:(0,et.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,et.jsxs)("div",{className:"text-center mb-16",children:[et.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Pay-as-You-Go Pricing"}),et.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Purchase credits and use them whenever you need. Each property valuation costs 5 credits. No subscriptions, no monthly commitments."})]}),et.jsx("div",{children:et.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{name:"Basic Pack",credits:10,price:10,originalPrice:15,popular:!1,features:["2 property valuations","AI-powered market analysis","Detailed PDF reports","Email support","30-day money-back guarantee"]},{name:"Starter Pack",credits:35,price:29,originalPrice:39,popular:!1,features:["7 property valuations","AI-powered market analysis","Detailed PDF reports","Email support","30-day money-back guarantee"]},{name:"Professional Pack",credits:110,price:99,originalPrice:149,popular:!0,features:["22 property valuations","AI-powered market analysis","Detailed PDF reports","Email support","30-day money-back guarantee"]}].map((e,t)=>(0,et.jsxs)("div",{className:`relative bg-white rounded-2xl p-8 shadow-sm border-2 transition-all duration-200 hover:shadow-lg ${e.popular?"border-blue-500 shadow-lg":"border-slate-200 hover:border-blue-300"}`,children:[e.popular&&et.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:et.jsx("span",{className:"bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-semibold",children:"Most Popular"})}),(0,et.jsxs)("div",{className:"text-center mb-6",children:[et.jsx("h4",{className:"text-xl font-bold text-slate-900 mb-2",children:e.name}),(0,et.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:[(0,et.jsxs)("span",{className:"text-4xl font-bold text-slate-900",children:["$",e.price]}),(0,et.jsxs)("span",{className:"text-slate-500 line-through",children:["$",e.originalPrice]})]}),(0,et.jsxs)("div",{className:"text-slate-600 mb-2",children:[e.credits," Credits"]}),et.jsx("div",{className:"text-sm text-slate-500",children:"5 credits per valuation"})]}),et.jsx("ul",{className:"space-y-3 mb-8",children:e.features.map((e,t)=>(0,et.jsxs)("li",{className:"flex items-center text-slate-600",children:[et.jsx("span",{className:"text-green-500 mr-3",children:"✓"}),e]},t))}),et.jsx("button",{className:`w-full py-3 px-6 rounded-lg font-semibold transition-colors duration-200 ${e.popular?"bg-blue-600 hover:bg-blue-700 text-white":"bg-slate-100 hover:bg-slate-200 text-slate-900"}`,children:"Choose Plan"})]},t))})}),et.jsx("div",{className:"mt-16 text-center",children:(0,et.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-8 max-w-2xl mx-auto",children:[et.jsx("div",{className:"text-green-600 text-4xl mb-4",children:"\uD83D\uDEE1️"}),et.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"30-Day Money-Back Guarantee"}),et.jsx("p",{className:"text-slate-600",children:"Not satisfied with your results? Get a full refund within 30 days, no questions asked."})]})})]})}),el=()=>et.jsx("section",{className:"py-20 bg-slate-50",children:(0,et.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,et.jsxs)("div",{className:"text-center mb-16",children:[et.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"Compare All Features"}),et.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"See exactly what's included in each plan. Choose the one that best fits your needs."})]}),(0,et.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:[et.jsx("div",{className:"bg-slate-50 border-b border-slate-200",children:(0,et.jsxs)("div",{className:"grid grid-cols-4 gap-4 p-6",children:[et.jsx("div",{className:"text-left",children:et.jsx("h3",{className:"font-semibold text-slate-900",children:"Features"})}),[{name:"Basic Pack",price:"$10",description:"10 credits (2 valuations)"},{name:"Starter Pack",price:"$29",description:"35 credits (7 valuations)"},{name:"Professional Pack",price:"$99",description:"110 credits (22 valuations)"}].map((e,t)=>(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"font-bold text-slate-900 mb-1",children:e.name}),et.jsx("div",{className:"text-lg font-semibold text-blue-600 mb-1",children:e.price}),et.jsx("div",{className:"text-xs text-slate-600",children:e.description})]},t))]})}),[{category:"Credits & Valuations",items:[{name:"Credits included",basic:"10",starter:"35",professional:"110"},{name:"Property valuations",basic:"2",starter:"7",professional:"22"},{name:"Cost per valuation",basic:"5 credits",starter:"5 credits",professional:"5 credits"}]},{category:"Features",items:[{name:"AI-powered analysis",basic:"✓",starter:"✓",professional:"✓"},{name:"Market trend analysis",basic:"✓",starter:"✓",professional:"✓"},{name:"Detailed PDF reports",basic:"✓",starter:"✓",professional:"✓"},{name:"95% accuracy rate",basic:"✓",starter:"✓",professional:"✓"}]},{category:"Support & Guarantees",items:[{name:"Email support",basic:"✓",starter:"✓",professional:"✓"},{name:"30-day money-back guarantee",basic:"✓",starter:"✓",professional:"✓"},{name:"Credits never expire",basic:"✓",starter:"✓",professional:"✓"}]}].map((e,t)=>(0,et.jsxs)("div",{children:[et.jsx("div",{className:"bg-slate-100 px-6 py-3",children:et.jsx("h4",{className:"font-semibold text-slate-900",children:e.category})}),e.items.map((e,t)=>et.jsx("div",{className:"border-b border-slate-200 last:border-b-0",children:(0,et.jsxs)("div",{className:"grid grid-cols-4 gap-4 p-6 items-center",children:[et.jsx("div",{className:"text-slate-700 font-medium",children:e.name}),et.jsx("div",{className:"text-center",children:et.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${"✓"===e.basic?"bg-green-100 text-green-800":"✗"===e.basic?"bg-red-100 text-red-800":"bg-slate-100 text-slate-800"}`,children:e.basic})}),et.jsx("div",{className:"text-center",children:et.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${"✓"===e.starter?"bg-green-100 text-green-800":"✗"===e.starter?"bg-red-100 text-red-800":"bg-slate-100 text-slate-800"}`,children:e.starter})}),et.jsx("div",{className:"text-center",children:et.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${"✓"===e.professional?"bg-green-100 text-green-800":"✗"===e.professional?"bg-red-100 text-red-800":"bg-slate-100 text-slate-800"}`,children:e.professional})})]})},t))]},t)),et.jsx("div",{className:"bg-slate-50 p-6",children:(0,et.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[et.jsx("div",{}),et.jsx("div",{className:"text-center",children:et.jsx("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200",children:"Choose Plan"})}),et.jsx("div",{className:"text-center",children:et.jsx("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200",children:"Choose Plan"})}),et.jsx("div",{className:"text-center",children:et.jsx("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200",children:"Choose Plan"})})]})})]}),(0,et.jsxs)("div",{className:"mt-12 text-center",children:[et.jsx("p",{className:"text-slate-600 mb-4",children:"All credit packages include our 30-day money-back guarantee"}),(0,et.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-6 text-sm text-slate-500",children:[(0,et.jsxs)("div",{className:"flex items-center gap-2",children:[et.jsx("span",{className:"text-green-500",children:"✓"}),et.jsx("span",{children:"No monthly commitments"})]}),(0,et.jsxs)("div",{className:"flex items-center gap-2",children:[et.jsx("span",{className:"text-green-500",children:"✓"}),et.jsx("span",{children:"Credits never expire"})]}),(0,et.jsxs)("div",{className:"flex items-center gap-2",children:[et.jsx("span",{className:"text-green-500",children:"✓"}),et.jsx("span",{children:"5 credits per valuation"})]})]})]})]})}),ec=()=>et.jsx("section",{id:"testimonials",className:"py-20 bg-white",children:(0,et.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,et.jsxs)("div",{className:"text-center mb-16",children:[et.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-6",children:"What Our Customers Say"}),et.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Join thousands of real estate professionals who trust HomeWorth for accurate, fast property valuations."})]}),et.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:[{number:"4.9/5",label:"Average Rating",icon:"⭐"},{number:"10K+",label:"Happy Customers",icon:"\uD83D\uDE0A"},{number:"95%",label:"Accuracy Rate",icon:"\uD83C\uDFAF"},{number:"30s",label:"Average Time",icon:"⚡"}].map((e,t)=>(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"text-4xl mb-2",children:e.icon}),et.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:e.number}),et.jsx("div",{className:"text-slate-600",children:e.label})]},t))}),et.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16",children:[{name:"Sarah Johnson",role:"Real Estate Agent",company:"Premier Properties",image:"\uD83D\uDC69‍\uD83D\uDCBC",rating:5,text:"HomeWorth has revolutionized how I present properties to clients. The AI analysis is incredibly accurate and saves me hours of research. My clients love the detailed reports!",location:"San Francisco, CA"},{name:"Michael Chen",role:"Property Developer",company:"Urban Development Co.",image:"\uD83D\uDC68‍\uD83D\uDCBC",rating:5,text:"As a developer, I need quick, accurate valuations for multiple properties. HomeWorth delivers professional-grade analysis in minutes. It's become an essential tool in my workflow.",location:"Austin, TX"},{name:"Emily Rodriguez",role:"Real Estate Investor",company:"Rodriguez Investments",image:"\uD83D\uDC69‍\uD83D\uDCBB",rating:5,text:"The market trend analysis feature is incredible. I can make informed investment decisions quickly. The accuracy is impressive - it's saved me thousands in due diligence costs.",location:"Miami, FL"},{name:"David Thompson",role:"Property Manager",company:"Thompson Properties",image:"\uD83D\uDC68‍\uD83C\uDFE2",rating:5,text:"Managing 200+ properties requires efficient valuation processes. HomeWorth's bulk upload feature and detailed reports have streamlined our operations significantly.",location:"Seattle, WA"},{name:"Lisa Wang",role:"Real Estate Broker",company:"Wang & Associates",image:"\uD83D\uDC69‍\uD83D\uDCBC",rating:5,text:"My clients are impressed with the professional reports. The AI analysis provides insights I never would have considered. It's elevated my service quality.",location:"New York, NY"},{name:"James Wilson",role:"Property Appraiser",company:"Wilson Appraisals",image:"\uD83D\uDC68‍\uD83D\uDCBC",rating:5,text:"As a traditional appraiser, I was skeptical of AI valuations. But HomeWorth's accuracy and detailed analysis have made it a valuable tool in my practice.",location:"Chicago, IL"}].map((e,t)=>(0,et.jsxs)("div",{className:"bg-slate-50 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[(0,et.jsxs)("div",{className:"flex items-center mb-4",children:[et.jsx("div",{className:"text-3xl mr-3",children:e.image}),(0,et.jsxs)("div",{children:[et.jsx("div",{className:"font-semibold text-slate-900",children:e.name}),et.jsx("div",{className:"text-sm text-slate-600",children:e.role}),et.jsx("div",{className:"text-sm text-slate-500",children:e.company})]})]}),et.jsx("div",{className:"flex mb-3",children:[...Array(e.rating)].map((e,t)=>et.jsx("span",{className:"text-yellow-400",children:"⭐"},t))}),(0,et.jsxs)("p",{className:"text-slate-700 mb-4 italic",children:['"',e.text,'"']}),et.jsx("div",{className:"text-sm text-slate-500",children:e.location})]},t))}),(0,et.jsxs)("div",{className:"bg-slate-50 rounded-2xl p-8 lg:p-12",children:[(0,et.jsxs)("div",{className:"text-center mb-8",children:[et.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Trusted by Industry Leaders"}),et.jsx("p",{className:"text-slate-600",children:"Our AI technology is used by top real estate companies and professionals nationwide."})]}),(0,et.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 items-center opacity-60",children:[et.jsx("div",{className:"text-center",children:et.jsx("div",{className:"text-2xl font-bold text-slate-700",children:"REMAX"})}),et.jsx("div",{className:"text-center",children:et.jsx("div",{className:"text-2xl font-bold text-slate-700",children:"Coldwell Banker"})}),et.jsx("div",{className:"text-center",children:et.jsx("div",{className:"text-2xl font-bold text-slate-700",children:"Keller Williams"})}),et.jsx("div",{className:"text-center",children:et.jsx("div",{className:"text-2xl font-bold text-slate-700",children:"Century 21"})})]})]}),(0,et.jsxs)("div",{className:"text-center mt-16",children:[et.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-4",children:"Ready to Experience the Future of Property Valuation?"}),et.jsx("p",{className:"text-slate-600 mb-8",children:"Join thousands of satisfied customers and start getting accurate valuations today."}),(0,et.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[et.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-8 rounded-lg text-lg transition-colors duration-200 shadow-lg hover:shadow-xl",children:"Start Free Trial"}),et.jsx("button",{className:"border-2 border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white font-semibold py-4 px-8 rounded-lg text-lg transition-colors duration-200",children:"View All Reviews"})]})]})]})}),eu=({onNavigateToApp:e})=>et.jsx("section",{className:"py-20 bg-gradient-to-br from-blue-600 to-indigo-700",children:et.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold text-white mb-6",children:"Ready to Transform Your Property Valuation Process?"}),et.jsx("p",{className:"text-xl text-blue-100 mb-12 max-w-3xl mx-auto",children:"Join thousands of real estate professionals who are already using HomeWorth to get faster, more accurate property valuations. Start your free trial today."}),(0,et.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center mb-12",children:[et.jsx("button",{onClick:e,className:"bg-white text-blue-600 hover:bg-blue-50 font-bold py-4 px-8 rounded-lg text-lg transition-colors duration-200 shadow-lg hover:shadow-xl",children:"Start Free Trial"}),et.jsx("button",{onClick:()=>{let e=document.getElementById("pricing");e&&e.scrollIntoView({behavior:"smooth"})},className:"border-2 border-white text-white hover:bg-white hover:text-blue-600 font-semibold py-4 px-8 rounded-lg text-lg transition-colors duration-200",children:"View Pricing"})]}),(0,et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-12",children:[(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-2xl",children:"⚡"})}),et.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Instant Results"}),et.jsx("p",{className:"text-blue-100",children:"Get valuations in under 30 seconds"})]}),(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-2xl",children:"\uD83C\uDFAF"})}),et.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"95% Accuracy"}),et.jsx("p",{className:"text-blue-100",children:"Professional-grade precision"})]}),(0,et.jsxs)("div",{className:"text-center",children:[et.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-4",children:et.jsx("span",{className:"text-2xl",children:"\uD83D\uDCB0"})}),et.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Cost Effective"}),et.jsx("p",{className:"text-blue-100",children:"Save 90% vs traditional appraisals"})]})]}),(0,et.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-8 text-blue-100",children:[(0,et.jsxs)("div",{className:"flex items-center gap-2",children:[et.jsx("span",{className:"text-green-400",children:"✓"}),et.jsx("span",{children:"No credit card required"})]}),(0,et.jsxs)("div",{className:"flex items-center gap-2",children:[et.jsx("span",{className:"text-green-400",children:"✓"}),et.jsx("span",{children:"30-day money-back guarantee"})]}),(0,et.jsxs)("div",{className:"flex items-center gap-2",children:[et.jsx("span",{className:"text-green-400",children:"✓"}),et.jsx("span",{children:"Cancel anytime"})]})]})]})})}),ed=()=>et.jsx("footer",{className:"bg-slate-900 text-white",children:(0,et.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,et.jsxs)("div",{className:"col-span-1 md:col-span-2",children:[(0,et.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[et.jsx("span",{className:"text-3xl",children:"\uD83C\uDFE0"}),et.jsx("h3",{className:"text-2xl font-bold",children:"HomeWorth"})]}),et.jsx("p",{className:"text-slate-300 mb-6 max-w-md",children:"AI-powered property valuation platform that delivers accurate, instant property assessments for real estate professionals and investors."}),(0,et.jsxs)("div",{className:"flex space-x-4",children:[(0,et.jsxs)("a",{href:"#",className:"text-slate-400 hover:text-white transition-colors duration-200",children:[et.jsx("span",{className:"sr-only",children:"Twitter"}),et.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:et.jsx("path",{d:"M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"})})]}),(0,et.jsxs)("a",{href:"#",className:"text-slate-400 hover:text-white transition-colors duration-200",children:[et.jsx("span",{className:"sr-only",children:"LinkedIn"}),et.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:et.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})})]})]})]}),(0,et.jsxs)("div",{children:[et.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Product"}),(0,et.jsxs)("ul",{className:"space-y-2",children:[et.jsx("li",{children:et.jsx("a",{href:"#features",className:"text-slate-300 hover:text-white transition-colors duration-200",children:"Features"})}),et.jsx("li",{children:et.jsx("a",{href:"#pricing",className:"text-slate-300 hover:text-white transition-colors duration-200",children:"Pricing"})}),et.jsx("li",{children:et.jsx("a",{href:"#",className:"text-slate-300 hover:text-white transition-colors duration-200",children:"API"})}),et.jsx("li",{children:et.jsx("a",{href:"#",className:"text-slate-300 hover:text-white transition-colors duration-200",children:"Integrations"})})]})]}),(0,et.jsxs)("div",{children:[et.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Support"}),(0,et.jsxs)("ul",{className:"space-y-2",children:[et.jsx("li",{children:et.jsx("a",{href:"#",className:"text-slate-300 hover:text-white transition-colors duration-200",children:"Help Center"})}),et.jsx("li",{children:et.jsx("a",{href:"#",className:"text-slate-300 hover:text-white transition-colors duration-200",children:"Contact Us"})}),et.jsx("li",{children:et.jsx("a",{href:"#",className:"text-slate-300 hover:text-white transition-colors duration-200",children:"Status"})}),et.jsx("li",{children:et.jsx("a",{href:"#",className:"text-slate-300 hover:text-white transition-colors duration-200",children:"Documentation"})})]})]})]}),et.jsx("div",{className:"border-t border-slate-800 mt-12 pt-8",children:(0,et.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[et.jsx("div",{className:"text-slate-400 text-sm",children:"\xa9 2024 HomeWorth. All rights reserved."}),(0,et.jsxs)("div",{className:"flex space-x-6 mt-4 md:mt-0",children:[et.jsx("a",{href:"#",className:"text-slate-400 hover:text-white text-sm transition-colors duration-200",children:"Privacy Policy"}),et.jsx("a",{href:"#",className:"text-slate-400 hover:text-white text-sm transition-colors duration-200",children:"Terms of Service"}),et.jsx("a",{href:"#",className:"text-slate-400 hover:text-white text-sm transition-colors duration-200",children:"Cookie Policy"})]})]})})]})});var ep=r(44401),eh=r(92048),ef=r(84492);r(42504),r(83958),r(74036);var em=r(46342);r(30359);var eg=r(20629);class ey{}function ev(e,t){return e.replace(/\{([^}]+)\}/g,(e,r)=>{if(Object.prototype.hasOwnProperty.call(t,r)){let e=t[r];return null!=e?String(e):""}throw Error(`Key '${r}' not found in valueMap.`)})}function e_(e,t,r){for(let n=0;n<t.length-1;n++){let i=t[n];if(i.endsWith("[]")){let s=i.slice(0,-2);if(!(s in e)){if(Array.isArray(r))e[s]=Array.from({length:r.length},()=>({}));else throw Error(`Value must be a list given an array path ${i}`)}if(Array.isArray(e[s])){let i=e[s];if(Array.isArray(r))for(let e=0;e<i.length;e++)e_(i[e],t.slice(n+1),r[e]);else for(let e of i)e_(e,t.slice(n+1),r)}return}if(i.endsWith("[0]")){let s=i.slice(0,-3);s in e||(e[s]=[{}]),e_(e[s][0],t.slice(n+1),r);return}e[i]&&"object"==typeof e[i]||(e[i]={}),e=e[i]}let n=t[t.length-1],i=e[n];if(void 0!==i){if(!r||"object"==typeof r&&0===Object.keys(r).length||r===i)return;if("object"==typeof i&&"object"==typeof r&&null!==i&&null!==r)Object.assign(i,r);else throw Error(`Cannot set value for an existing key. Key: ${n}`)}else"_self"!==n||"object"!=typeof r||null===r||Array.isArray(r)?e[n]=r:Object.assign(e,r)}function eE(e,t,r){try{if(1===t.length&&"_self"===t[0])return e;for(let n=0;n<t.length;n++){if("object"!=typeof e||null===e)return r;let i=t[n];if(i.endsWith("[]")){let s=i.slice(0,-2);if(!(s in e))return r;{let i=e[s];if(!Array.isArray(i))return r;return i.map(e=>eE(e,t.slice(n+1),r))}}e=e[i]}return e}catch(e){if(e instanceof TypeError)return r;throw e}}function eb(e){if("string"!=typeof e)throw Error("fromImageBytes must be a string");return e}(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(s||(s={})),function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"}(o||(o={})),function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"}(a||(a={})),function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"}(l||(l={})),function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"}(c||(c={})),function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"}(u||(u={})),function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"}(d||(d={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(p||(p={})),function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"}(h||(h={})),function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"}(f||(f={})),function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"}(m||(m={})),function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE"}(g||(g={})),function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(y||(y={})),function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(v||(v={})),function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"}(_||(_={})),function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(E||(E={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"}(b||(b={})),function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(x||(x={})),function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(A||(A={})),function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"}(T||(T={})),function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(S||(S={})),function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V"}(C||(C={})),function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"}(w||(w={})),function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"}(O||(O={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"}(I||(I={})),function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(N||(N={})),function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"}(k||(k={})),function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"}(R||(R={})),function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"}(P||(P={})),function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"}(j||(j={})),function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(D||(D={})),function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(U||(U={})),function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(M||(M={})),function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(L||(L={})),function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"}(G||(G={})),function(e){e.ASSET="ASSET",e.STYLE="STYLE"}(q||(q={})),function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"}(F||(F={})),function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"}(B||(B={})),function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"}(H||(H={})),function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"}(V||(V={})),function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"}($||($={})),function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"}(J||(J={})),function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(W||(W={})),function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(K||(K={})),function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"}(Y||(Y={})),function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(z||(z={})),function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(X||(X={})),function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"}(Z||(Z={})),function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"}(Q||(Q={}));class ex{constructor(e){let t={};for(let r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class eA{get text(){var e,t,r,n,i,s,o,a;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let l="",c=!1,u=[];for(let e of null!==(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(let[t,r]of Object.entries(e))"text"!==t&&"thought"!==t&&(null!==r||void 0!==r)&&u.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;c=!0,l+=e.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?l:void 0}get data(){var e,t,r,n,i,s,o,a;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let l="",c=[];for(let e of null!==(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)&&void 0!==a?a:[]){for(let[t,r]of Object.entries(e))"inlineData"!==t&&(null!==r||void 0!==r)&&c.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(l+=atob(e.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),l.length>0?btoa(l):void 0}get functionCalls(){var e,t,r,n,i,s,o,a;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let l=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==l?void 0:l.length)!==0)return l}get executableCode(){var e,t,r,n,i,s,o,a,l;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let c=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==c?void 0:c.length)!==0)return null===(l=null==c?void 0:c[0])||void 0===l?void 0:l.code}get codeExecutionResult(){var e,t,r,n,i,s,o,a,l;if((null===(n=null===(r=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===r?void 0:r.parts)||void 0===n?void 0:n.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let c=null===(a=null===(o=null===(s=null===(i=this.candidates)||void 0===i?void 0:i[0])||void 0===s?void 0:s.content)||void 0===o?void 0:o.parts)||void 0===a?void 0:a.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==c?void 0:c.length)!==0)return null===(l=null==c?void 0:c[0])||void 0===l?void 0:l.output}}class eT{}class eS{}class eC{}class ew{}class eO{}class eI{}class eN{}class ek{}class eR{}class eP{}class ej{_fromAPIResponse({apiResponse:e,isVertexAI:t}){let r=new ej;return Object.assign(r,t?function(e){let t={},r=eE(e,["name"]);null!=r&&e_(t,["name"],r);let n=eE(e,["metadata"]);null!=n&&e_(t,["metadata"],n);let i=eE(e,["done"]);null!=i&&e_(t,["done"],i);let s=eE(e,["error"]);null!=s&&e_(t,["error"],s);let o=eE(e,["response"]);return null!=o&&e_(t,["response"],function(e){let t={},r=eE(e,["videos"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["_self"]);return null!=r&&e_(t,["video"],function(e){let t={},r=eE(e,["gcsUri"]);null!=r&&e_(t,["uri"],r);let n=eE(e,["bytesBase64Encoded"]);null!=n&&e_(t,["videoBytes"],eb(n));let i=eE(e,["mimeType"]);return null!=i&&e_(t,["mimeType"],i),t}(r)),t})(e))),e_(t,["generatedVideos"],e)}let n=eE(e,["raiMediaFilteredCount"]);null!=n&&e_(t,["raiMediaFilteredCount"],n);let i=eE(e,["raiMediaFilteredReasons"]);return null!=i&&e_(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e):function(e){let t={},r=eE(e,["name"]);null!=r&&e_(t,["name"],r);let n=eE(e,["metadata"]);null!=n&&e_(t,["metadata"],n);let i=eE(e,["done"]);null!=i&&e_(t,["done"],i);let s=eE(e,["error"]);null!=s&&e_(t,["error"],s);let o=eE(e,["response","generateVideoResponse"]);return null!=o&&e_(t,["response"],function(e){let t={},r=eE(e,["generatedSamples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["video"]);return null!=r&&e_(t,["video"],function(e){let t={},r=eE(e,["uri"]);null!=r&&e_(t,["uri"],r);let n=eE(e,["encodedVideo"]);null!=n&&e_(t,["videoBytes"],eb(n));let i=eE(e,["encoding"]);return null!=i&&e_(t,["mimeType"],i),t}(r)),t})(e))),e_(t,["generatedVideos"],e)}let n=eE(e,["raiMediaFilteredCount"]);null!=n&&e_(t,["raiMediaFilteredCount"],n);let i=eE(e,["raiMediaFilteredReasons"]);return null!=i&&e_(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e)),r}}class eD{}class eU{}class eM{}class eL{}class eG{}class eq{}class eF{}class eB{get text(){var e,t,r;let n="",i=!1,s=[];for(let o of null!==(r=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==r?r:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&s.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;i=!0,n+=o.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?n:void 0}get data(){var e,t,r;let n="",i=[];for(let s of null!==(r=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==r?r:[]){for(let[e,t]of Object.entries(s))"inlineData"!==e&&null!==t&&i.push(e);s.inlineData&&"string"==typeof s.inlineData.data&&(n+=atob(s.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),n.length>0?btoa(n):void 0}}class eH{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function eV(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;{let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function e$(e,t){let r=eV(e,t);return r?r.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}`:r.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${r}`:r:""}function eJ(e){return Array.isArray(e)?e.map(e=>eW(e)):[eW(e)]}function eW(e){if("object"==typeof e&&null!==e)return e;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function eK(e){let t=eW(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function eY(e){let t=eW(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`)}function ez(e){if(null==e)throw Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw Error(`Unsupported part type: ${typeof e}`)}function eX(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>ez(e)):[ez(e)]}function eZ(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts)}function eQ(e){return null!=e&&"object"==typeof e&&"functionCall"in e}function e0(e){return null!=e&&"object"==typeof e&&"functionResponse"in e}function e1(e){if(null==e)throw Error("ContentUnion is required");return eZ(e)?e:{role:"user",parts:eX(e)}}function e2(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{let t=e1(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[]});if(e.isVertexAI()){let e=e1(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>e1(e)):[e1(t)]}function e4(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("contents are required");if(!Array.isArray(e)){if(eQ(e)||e0(e))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[e1(e)]}let t=[],r=[],n=eZ(e[0]);for(let i of e){let e=eZ(i);if(e!=n)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(i);else if(eQ(i)||e0(i))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else r.push(i)}return n||t.push({role:"user",parts:eX(r)}),t}function e6(e){let t={},r=["items"],n=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let s=e.anyOf;for(let[o,a]of(null!=s&&2==s.length&&("null"===s[0].type?(t.nullable=!0,e=s[1]):"null"===s[1].type&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let r=e.filter(e=>"null"!==e);if(1===r.length)t.type=Object.values(l).includes(r[0].toUpperCase())?r[0].toUpperCase():l.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],r))t.anyOf.push({type:Object.values(l).includes(e.toUpperCase())?e.toUpperCase():l.TYPE_UNSPECIFIED})}(e.type,t),Object.entries(e)))if(null!=a){if("type"==o){if("null"===a)throw Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;t.type=Object.values(l).includes(a.toUpperCase())?a.toUpperCase():l.TYPE_UNSPECIFIED}else if(r.includes(o))t[o]=e6(a);else if(n.includes(o)){let e=[];for(let r of a){if("null"==r.type){t.nullable=!0;continue}e.push(e6(r))}t[o]=e}else if(i.includes(o)){let e={};for(let[t,r]of Object.entries(a))e[t]=e6(r);t[o]=e}else{if("additionalProperties"===o)continue;t[o]=a}}return t}function e3(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw Error(`Unsupported speechConfig type: ${typeof e}`)}function e5(e){if("multiSpeakerVoiceConfig"in e)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function e8(e){if(e.functionDeclarations)for(let t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=e6(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=e6(t.response));return e}function e9(e){if(null==e)throw Error("tools is required");if(!Array.isArray(e))throw Error("tools is required and must be an array of Tools");let t=[];for(let r of e)t.push(r);return t}function e7(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,r,n=1){let i=!t.startsWith(`${r}/`)&&t.split("/").length===n;if(e.isVertexAI())return t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${r}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${r}/${t}`:t;return i?`${r}/${t}`:t}(e,t,"cachedContents")}function te(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function tt(e){return null!=e&&"object"==typeof e&&"video"in e}function tr(e){return null!=e&&"object"==typeof e&&"uri"in e}function tn(e){var t;let r;if(null!=e&&"object"==typeof e&&"name"in e&&(r=e.name),!(tr(e)&&void 0===(r=e.uri)||tt(e)&&void 0===(r=null===(t=e.video)||void 0===t?void 0:t.uri))){if("string"==typeof e&&(r=e),void 0===r)throw Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){let e=r.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw Error(`Could not extract file name from URI ${r}`);r=e[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function ti(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels"}function ts(e){for(let t of["models","tunedModels","publisherModels"]){if(null!==e&&"object"==typeof e&&t in e)return e[t]}return[]}function to(e,t){let r;if("string"==typeof t){if(e.isVertexAI()){if(t.startsWith("gs://"))r={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))r={format:"bigquery",bigqueryUri:t};else throw Error(`Unsupported string source for Vertex AI: ${t}`)}else if(t.startsWith("files/"))r={fileName:t};else throw Error(`Unsupported string source for Gemini API: ${t}`)}else if(Array.isArray(t)){if(e.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");r={inlinedRequests:t}}else r=t;let n=[r.gcsUri,r.bigqueryUri].filter(Boolean).length,i=[r.inlinedRequests,r.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||1!==n)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||1!==i)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return r}function ta(e){if("object"!=typeof e||null===e)return{};let t=e.inlinedResponses;if("object"!=typeof t||null===t)return e;let r=t.inlinedResponses;if(!Array.isArray(r)||0===r.length)return e;let n=!1;for(let e of r){if("object"!=typeof e||null===e)continue;let t=e.response;if("object"==typeof t&&null!==t&&void 0!==t.embedding){n=!0;break}}return n&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),e}function tl(e,t){if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw Error(`Invalid batch job name: ${t}.`)}function tc(e){if("BATCH_STATE_UNSPECIFIED"===e)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===e)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===e)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===e)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===e)return"JOB_STATE_FAILED";if("BATCH_STATE_CANCELLED"===e)return"JOB_STATE_CANCELLED";if("BATCH_STATE_EXPIRED"===e)return"JOB_STATE_EXPIRED";else return e}function tu(e){let t={},r=eE(e,["name"]);null!=r&&e_(t,["name"],r);let n=eE(e,["metadata","displayName"]);null!=n&&e_(t,["displayName"],n);let i=eE(e,["metadata","state"]);null!=i&&e_(t,["state"],tc(i));let s=eE(e,["metadata","createTime"]);null!=s&&e_(t,["createTime"],s);let o=eE(e,["metadata","endTime"]);null!=o&&e_(t,["endTime"],o);let a=eE(e,["metadata","updateTime"]);null!=a&&e_(t,["updateTime"],a);let l=eE(e,["metadata","model"]);null!=l&&e_(t,["model"],l);let c=eE(e,["metadata","output"]);return null!=c&&e_(t,["dest"],function(e){let t={},r=eE(e,["responsesFile"]);null!=r&&e_(t,["fileName"],r);let n=eE(e,["inlinedResponses","inlinedResponses"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["response"]);null!=r&&e_(t,["response"],function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["content"]);null!=r&&e_(t,["content"],r);let n=eE(e,["citationMetadata"]);null!=n&&e_(t,["citationMetadata"],function(e){let t={},r=eE(e,["citationSources"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["citations"],e)}return t}(n));let i=eE(e,["tokenCount"]);null!=i&&e_(t,["tokenCount"],i);let s=eE(e,["finishReason"]);null!=s&&e_(t,["finishReason"],s);let o=eE(e,["urlContextMetadata"]);null!=o&&e_(t,["urlContextMetadata"],o);let a=eE(e,["avgLogprobs"]);null!=a&&e_(t,["avgLogprobs"],a);let l=eE(e,["groundingMetadata"]);null!=l&&e_(t,["groundingMetadata"],l);let c=eE(e,["index"]);null!=c&&e_(t,["index"],c);let u=eE(e,["logprobsResult"]);null!=u&&e_(t,["logprobsResult"],u);let d=eE(e,["safetyRatings"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["safetyRatings"],e)}return t})(e))),e_(t,["candidates"],e)}let i=eE(e,["modelVersion"]);null!=i&&e_(t,["modelVersion"],i);let s=eE(e,["promptFeedback"]);null!=s&&e_(t,["promptFeedback"],s);let o=eE(e,["responseId"]);null!=o&&e_(t,["responseId"],o);let a=eE(e,["usageMetadata"]);return null!=a&&e_(t,["usageMetadata"],a),t}(r));let n=eE(e,["error"]);return null!=n&&e_(t,["error"],n),t})(e))),e_(t,["inlinedResponses"],e)}let i=eE(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["inlinedEmbedContentResponses"],e)}return t}(ta(c))),t}function td(e){let t={},r=eE(e,["name"]);null!=r&&e_(t,["name"],r);let n=eE(e,["displayName"]);null!=n&&e_(t,["displayName"],n);let i=eE(e,["state"]);null!=i&&e_(t,["state"],tc(i));let s=eE(e,["error"]);null!=s&&e_(t,["error"],s);let o=eE(e,["createTime"]);null!=o&&e_(t,["createTime"],o);let a=eE(e,["startTime"]);null!=a&&e_(t,["startTime"],a);let l=eE(e,["endTime"]);null!=l&&e_(t,["endTime"],l);let c=eE(e,["updateTime"]);null!=c&&e_(t,["updateTime"],c);let u=eE(e,["model"]);null!=u&&e_(t,["model"],u);let d=eE(e,["inputConfig"]);null!=d&&e_(t,["src"],function(e){let t={},r=eE(e,["instancesFormat"]);null!=r&&e_(t,["format"],r);let n=eE(e,["gcsSource","uris"]);null!=n&&e_(t,["gcsUri"],n);let i=eE(e,["bigquerySource","inputUri"]);return null!=i&&e_(t,["bigqueryUri"],i),t}(d));let p=eE(e,["outputConfig"]);return null!=p&&e_(t,["dest"],function(e){let t={},r=eE(e,["predictionsFormat"]);null!=r&&e_(t,["format"],r);let n=eE(e,["gcsDestination","outputUriPrefix"]);null!=n&&e_(t,["gcsUri"],n);let i=eE(e,["bigqueryDestination","outputUri"]);return null!=i&&e_(t,["bigqueryUri"],i),t}(ta(p))),t}function tp(e){let t={},r=eE(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["videoMetadata"]);null!=r&&e_(t,["videoMetadata"],r);let n=eE(e,["thought"]);null!=n&&e_(t,["thought"],n);let i=eE(e,["inlineData"]);null!=i&&e_(t,["inlineData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["data"]);null!=r&&e_(t,["data"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(i));let s=eE(e,["fileData"]);null!=s&&e_(t,["fileData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["fileUri"]);null!=r&&e_(t,["fileUri"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(s));let o=eE(e,["thoughtSignature"]);null!=o&&e_(t,["thoughtSignature"],o);let a=eE(e,["functionCall"]);null!=a&&e_(t,["functionCall"],a);let l=eE(e,["codeExecutionResult"]);null!=l&&e_(t,["codeExecutionResult"],l);let c=eE(e,["executableCode"]);null!=c&&e_(t,["executableCode"],c);let u=eE(e,["functionResponse"]);null!=u&&e_(t,["functionResponse"],u);let d=eE(e,["text"]);return null!=d&&e_(t,["text"],d),t})(e))),e_(t,["parts"],e)}let n=eE(e,["role"]);return null!=n&&e_(t,["role"],n),t}function th(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["src"]);null!=i&&e_(r,["batch","inputConfig"],function(e,t){let r={};if(void 0!==eE(t,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==eE(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==eE(t,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let n=eE(t,["fileName"]);null!=n&&e_(r,["fileName"],n);let i=eE(t,["inlinedRequests"]);if(null!=i){let t=i;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["request","model"],eV(e,n));let i=eE(t,["contents"]);if(null!=i){let e=e4(i);Array.isArray(e)&&(e=e.map(e=>tp(e))),e_(r,["request","contents"],e)}let s=eE(t,["metadata"]);null!=s&&e_(r,["metadata"],s);let o=eE(t,["config"]);return null!=o&&e_(r,["request","generationConfig"],function(e,t,r){let n={},i=eE(t,["systemInstruction"]);void 0!==r&&null!=i&&e_(r,["systemInstruction"],tp(e1(i)));let s=eE(t,["temperature"]);null!=s&&e_(n,["temperature"],s);let o=eE(t,["topP"]);null!=o&&e_(n,["topP"],o);let a=eE(t,["topK"]);null!=a&&e_(n,["topK"],a);let l=eE(t,["candidateCount"]);null!=l&&e_(n,["candidateCount"],l);let c=eE(t,["maxOutputTokens"]);null!=c&&e_(n,["maxOutputTokens"],c);let u=eE(t,["stopSequences"]);null!=u&&e_(n,["stopSequences"],u);let d=eE(t,["responseLogprobs"]);null!=d&&e_(n,["responseLogprobs"],d);let p=eE(t,["logprobs"]);null!=p&&e_(n,["logprobs"],p);let h=eE(t,["presencePenalty"]);null!=h&&e_(n,["presencePenalty"],h);let f=eE(t,["frequencyPenalty"]);null!=f&&e_(n,["frequencyPenalty"],f);let m=eE(t,["seed"]);null!=m&&e_(n,["seed"],m);let g=eE(t,["responseMimeType"]);null!=g&&e_(n,["responseMimeType"],g);let y=eE(t,["responseSchema"]);null!=y&&e_(n,["responseSchema"],e6(y));let v=eE(t,["responseJsonSchema"]);if(null!=v&&e_(n,["responseJsonSchema"],v),void 0!==eE(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==eE(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let _=eE(t,["safetySettings"]);if(void 0!==r&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==eE(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let r=eE(e,["category"]);null!=r&&e_(t,["category"],r);let n=eE(e,["threshold"]);return null!=n&&e_(t,["threshold"],n),t})(e))),e_(r,["safetySettings"],e)}let E=eE(t,["tools"]);if(void 0!==r&&null!=E){let e=e9(E);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["functionDeclarations"],e)}if(void 0!==eE(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=eE(e,["googleSearch"]);null!=n&&e_(t,["googleSearch"],function(e){let t={},r=eE(e,["timeRangeFilter"]);if(null!=r&&e_(t,["timeRangeFilter"],r),void 0!==eE(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=eE(e,["googleSearchRetrieval"]);if(null!=i&&e_(t,["googleSearchRetrieval"],i),void 0!==eE(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=eE(e,["googleMaps"]);null!=s&&e_(t,["googleMaps"],function(e){let t={};if(void 0!==eE(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=eE(e,["enableWidget"]);return null!=r&&e_(t,["enableWidget"],r),t}(s));let o=eE(e,["urlContext"]);null!=o&&e_(t,["urlContext"],o);let a=eE(e,["computerUse"]);null!=a&&e_(t,["computerUse"],a);let l=eE(e,["codeExecution"]);return null!=l&&e_(t,["codeExecution"],l),t})(e8(e)))),e_(r,["tools"],e)}let b=eE(t,["toolConfig"]);if(void 0!==r&&null!=b&&e_(r,["toolConfig"],b),void 0!==eE(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let x=eE(t,["cachedContent"]);void 0!==r&&null!=x&&e_(r,["cachedContent"],e7(e,x));let A=eE(t,["responseModalities"]);null!=A&&e_(n,["responseModalities"],A);let T=eE(t,["mediaResolution"]);null!=T&&e_(n,["mediaResolution"],T);let S=eE(t,["speechConfig"]);if(null!=S&&e_(n,["speechConfig"],e3(S)),void 0!==eE(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let C=eE(t,["thinkingConfig"]);null!=C&&e_(n,["thinkingConfig"],C);let w=eE(t,["imageConfig"]);return null!=w&&e_(n,["imageConfig"],w),n}(e,o,eE(r,["request"],{}))),r})(e,t))),e_(r,["requests","requests"],t)}return r}(e,to(e,i)));let s=eE(t,["config"]);return null!=s&&function(e,t){let r=eE(e,["displayName"]);if(void 0!==t&&null!=r&&e_(t,["batch","displayName"],r),void 0!==eE(e,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(s,r),r}!function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"}(ee||(ee={}));class tf{constructor(e,t,r,n){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,n)}init(e,t,r){var n,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let s={config:{}};(s=r&&0!==Object.keys(r).length?"object"==typeof r?Object.assign({},r):r:{config:{}}).config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=null!==(i=null===(n=s.config)||void 0===n?void 0:n.pageSize)&&void 0!==i?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage()}let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)!==void 0}}class tm extends ey{constructor(e){super(),this.apiClient=e,this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e)},this.list=async(e={})=>new tf(ee.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e)}createInlinedGenerateContentRequest(e){let t=th(this.apiClient,e),r=ev("{model}:batchGenerateContent",t._url),n=t.batch.inputConfig.requests,i=n.requests,s=[];for(let e of i){let t=Object.assign({},e);if(t.systemInstruction){let e=t.systemInstruction;delete t.systemInstruction;let r=t.request;r.systemInstruction=e,t.request=r}s.push(t)}return n.requests=s,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri}formatDestination(e,t){let r=t?Object.assign({},t):{},n=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${n}`),void 0===r.dest){let t=this.getGcsUri(e),i=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?r.dest=`${t.slice(0,-6)}/dest`:r.dest=`${t}_dest_${n}`;else if(i)r.dest=`${i}_dest_${n}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["model"],eV(e,n));let i=eE(t,["src"]);null!=i&&e_(r,["inputConfig"],function(e){let t={},r=eE(e,["format"]);null!=r&&e_(t,["instancesFormat"],r);let n=eE(e,["gcsUri"]);null!=n&&e_(t,["gcsSource","uris"],n);let i=eE(e,["bigqueryUri"]);if(null!=i&&e_(t,["bigquerySource","inputUri"],i),void 0!==eE(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==eE(e,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return t}(to(e,i)));let s=eE(t,["config"]);return null!=s&&function(e,t){let r=eE(e,["displayName"]);void 0!==t&&null!=r&&e_(t,["displayName"],r);let n=eE(e,["dest"]);void 0!==t&&null!=n&&e_(t,["outputConfig"],function(e){let t={},r=eE(e,["format"]);null!=r&&e_(t,["predictionsFormat"],r);let n=eE(e,["gcsUri"]);null!=n&&e_(t,["gcsDestination","outputUriPrefix"],n);let i=eE(e,["bigqueryUri"]);if(null!=i&&e_(t,["bigqueryDestination","outputUri"],i),void 0!==eE(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==eE(e,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==eE(e,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}(function(e){if("string"!=typeof e)return e;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw Error(`Unsupported destination: ${e}`)}(n)))}(s,r),r}(this.apiClient,e);return s=ev("batchPredictionJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>td(e))}{let t=th(this.apiClient,e);return s=ev("{model}:batchGenerateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tu(e))}}async createEmbeddingsInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["src"]);null!=i&&e_(r,["batch","inputConfig"],function(e,t){let r={},n=eE(t,["fileName"]);null!=n&&e_(r,["file_name"],n);let i=eE(t,["inlinedRequests"]);return null!=i&&e_(r,["requests"],function(e,t){let r={},n=eE(t,["contents"]);if(null!=n){let t=e2(e,n);Array.isArray(t)&&(t=t.map(e=>e)),e_(r,["requests[]","request","content"],t)}let i=eE(t,["config"]);return null!=i&&(e_(r,["_self"],function(e,t){let r=eE(e,["taskType"]);void 0!==t&&null!=r&&e_(t,["requests[]","taskType"],r);let n=eE(e,["title"]);void 0!==t&&null!=n&&e_(t,["requests[]","title"],n);let i=eE(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&e_(t,["requests[]","outputDimensionality"],i),void 0!==eE(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==eE(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(i,r)),function(e,t){for(let[r,n]of Object.entries(t)){let t=r.split("."),i=n.split("."),s=new Set,o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break}if(-1!==o&&i.length>o)for(let e=o;e<i.length;e++){let t=i[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||s.add(t)}(function e(t,r,n,i,s){if(i>=r.length||"object"!=typeof t||null===t)return;let o=r[i];if(o.endsWith("[]")){let a=o.slice(0,-2);if(a in t&&Array.isArray(t[a]))for(let o of t[a])e(o,r,n,i+1,s)}else if("*"===o){if("object"==typeof t&&null!==t&&!Array.isArray(t)){let e=Object.keys(t).filter(e=>!e.startsWith("_")&&!s.has(e)),r={};for(let n of e)r[n]=t[n];for(let[e,s]of Object.entries(r)){let r=[];for(let t of n.slice(i))"*"===t?r.push(e):r.push(t);e_(t,r,s)}for(let r of e)delete t[r]}}else o in t&&e(t[o],r,n,i+1,s)})(e,t,i,0,s)}}(r,{"requests[].*":"requests[].request.*"})),r}(e,i)),r}(e,i));let s=eE(t,["config"]);return null!=s&&function(e,t){let r=eE(e,["displayName"]);void 0!==t&&null!=r&&e_(t,["batch","displayName"],r)}(s,r),r}(this.apiClient,e);return n=ev("{model}:asyncBatchEmbedContent",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>tu(e))}}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],tl(e,n)),r}(this.apiClient,e);return s=ev("batchPredictionJobs/{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>td(e))}{let t=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],tl(e,n)),r}(this.apiClient,e);return s=ev("batches/{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tu(e))}}async cancel(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],tl(e,n)),r}(this.apiClient,e);s=ev("batchPredictionJobs/{name}:cancel",n._url),o=n._query,delete n._url,delete n._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal})}else{let t=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],tl(e,n)),r}(this.apiClient,e);s=ev("batches/{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=eE(e,["config"]);return null!=r&&function(e,t){let r=eE(e,["pageSize"]);void 0!==t&&null!=r&&e_(t,["_query","pageSize"],r);let n=eE(e,["pageToken"]);void 0!==t&&null!=n&&e_(t,["_query","pageToken"],n);let i=eE(e,["filter"]);void 0!==t&&null!=i&&e_(t,["_query","filter"],i)}(r,t),t}(e);return s=ev("batchPredictionJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["nextPageToken"]);null!=n&&e_(t,["nextPageToken"],n);let i=eE(e,["batchPredictionJobs"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>td(e))),e_(t,["batchJobs"],e)}return t}(e),r=new eF;return Object.assign(r,t),r})}{let t=function(e){let t={},r=eE(e,["config"]);return null!=r&&function(e,t){let r=eE(e,["pageSize"]);void 0!==t&&null!=r&&e_(t,["_query","pageSize"],r);let n=eE(e,["pageToken"]);if(void 0!==t&&null!=n&&e_(t,["_query","pageToken"],n),void 0!==eE(e,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(r,t),t}(e);return s=ev("batches",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["nextPageToken"]);null!=n&&e_(t,["nextPageToken"],n);let i=eE(e,["operations"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>tu(e))),e_(t,["batchJobs"],e)}return t}(e),r=new eF;return Object.assign(r,t),r})}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],tl(e,n)),r}(this.apiClient,e);return s=ev("batchPredictionJobs/{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["name"]);null!=n&&e_(t,["name"],n);let i=eE(e,["done"]);null!=i&&e_(t,["done"],i);let s=eE(e,["error"]);return null!=s&&e_(t,["error"],s),t})(e))}{let t=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],tl(e,n)),r}(this.apiClient,e);return s=ev("batches/{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["name"]);null!=n&&e_(t,["name"],n);let i=eE(e,["done"]);null!=i&&e_(t,["done"],i);let s=eE(e,["error"]);return null!=s&&e_(t,["error"],s),t})(e))}}}function tg(e){let t={},r=eE(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["videoMetadata"]);null!=r&&e_(t,["videoMetadata"],r);let n=eE(e,["thought"]);null!=n&&e_(t,["thought"],n);let i=eE(e,["inlineData"]);null!=i&&e_(t,["inlineData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["data"]);null!=r&&e_(t,["data"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(i));let s=eE(e,["fileData"]);null!=s&&e_(t,["fileData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["fileUri"]);null!=r&&e_(t,["fileUri"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(s));let o=eE(e,["thoughtSignature"]);null!=o&&e_(t,["thoughtSignature"],o);let a=eE(e,["functionCall"]);null!=a&&e_(t,["functionCall"],a);let l=eE(e,["codeExecutionResult"]);null!=l&&e_(t,["codeExecutionResult"],l);let c=eE(e,["executableCode"]);null!=c&&e_(t,["executableCode"],c);let u=eE(e,["functionResponse"]);null!=u&&e_(t,["functionResponse"],u);let d=eE(e,["text"]);return null!=d&&e_(t,["text"],d),t})(e))),e_(t,["parts"],e)}let n=eE(e,["role"]);return null!=n&&e_(t,["role"],n),t}class ty extends ey{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new tf(ee.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e)}async create(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["model"],e$(e,n));let i=eE(t,["config"]);return null!=i&&function(e,t){let r=eE(e,["ttl"]);void 0!==t&&null!=r&&e_(t,["ttl"],r);let n=eE(e,["expireTime"]);void 0!==t&&null!=n&&e_(t,["expireTime"],n);let i=eE(e,["displayName"]);void 0!==t&&null!=i&&e_(t,["displayName"],i);let s=eE(e,["contents"]);if(void 0!==t&&null!=s){let e=e4(s);Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["contents"],e)}let o=eE(e,["systemInstruction"]);void 0!==t&&null!=o&&e_(t,["systemInstruction"],e1(o));let a=eE(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==eE(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=eE(e,["description"]);null!=r&&e_(t,["description"],r);let n=eE(e,["name"]);null!=n&&e_(t,["name"],n);let i=eE(e,["parameters"]);null!=i&&e_(t,["parameters"],i);let s=eE(e,["parametersJsonSchema"]);null!=s&&e_(t,["parametersJsonSchema"],s);let o=eE(e,["response"]);null!=o&&e_(t,["response"],o);let a=eE(e,["responseJsonSchema"]);return null!=a&&e_(t,["responseJsonSchema"],a),t})(e))),e_(t,["functionDeclarations"],e)}let n=eE(e,["retrieval"]);null!=n&&e_(t,["retrieval"],n);let i=eE(e,["googleSearch"]);null!=i&&e_(t,["googleSearch"],i);let s=eE(e,["googleSearchRetrieval"]);null!=s&&e_(t,["googleSearchRetrieval"],s);let o=eE(e,["enterpriseWebSearch"]);null!=o&&e_(t,["enterpriseWebSearch"],o);let a=eE(e,["googleMaps"]);null!=a&&e_(t,["googleMaps"],a);let l=eE(e,["urlContext"]);null!=l&&e_(t,["urlContext"],l);let c=eE(e,["computerUse"]);null!=c&&e_(t,["computerUse"],c);let u=eE(e,["codeExecution"]);return null!=u&&e_(t,["codeExecution"],u),t})(e))),e_(t,["tools"],e)}let l=eE(e,["toolConfig"]);void 0!==t&&null!=l&&e_(t,["toolConfig"],l);let c=eE(e,["kmsKeyName"]);void 0!==t&&null!=c&&e_(t,["encryption_spec","kmsKeyName"],c)}(i,r),r}(this.apiClient,e);return s=ev("cachedContents",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}{let t=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["model"],e$(e,n));let i=eE(t,["config"]);return null!=i&&function(e,t){let r=eE(e,["ttl"]);void 0!==t&&null!=r&&e_(t,["ttl"],r);let n=eE(e,["expireTime"]);void 0!==t&&null!=n&&e_(t,["expireTime"],n);let i=eE(e,["displayName"]);void 0!==t&&null!=i&&e_(t,["displayName"],i);let s=eE(e,["contents"]);if(void 0!==t&&null!=s){let e=e4(s);Array.isArray(e)&&(e=e.map(e=>tg(e))),e_(t,["contents"],e)}let o=eE(e,["systemInstruction"]);void 0!==t&&null!=o&&e_(t,["systemInstruction"],tg(e1(o)));let a=eE(e,["tools"]);if(void 0!==t&&null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["functionDeclarations"],e)}if(void 0!==eE(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=eE(e,["googleSearch"]);null!=n&&e_(t,["googleSearch"],function(e){let t={},r=eE(e,["timeRangeFilter"]);if(null!=r&&e_(t,["timeRangeFilter"],r),void 0!==eE(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=eE(e,["googleSearchRetrieval"]);if(null!=i&&e_(t,["googleSearchRetrieval"],i),void 0!==eE(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=eE(e,["googleMaps"]);null!=s&&e_(t,["googleMaps"],function(e){let t={};if(void 0!==eE(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=eE(e,["enableWidget"]);return null!=r&&e_(t,["enableWidget"],r),t}(s));let o=eE(e,["urlContext"]);null!=o&&e_(t,["urlContext"],o);let a=eE(e,["computerUse"]);null!=a&&e_(t,["computerUse"],a);let l=eE(e,["codeExecution"]);return null!=l&&e_(t,["codeExecution"],l),t})(e))),e_(t,["tools"],e)}let l=eE(e,["toolConfig"]);if(void 0!==t&&null!=l&&e_(t,["toolConfig"],l),void 0!==eE(e,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(i,r),r}(this.apiClient,e);return s=ev("cachedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>e)}}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],e7(e,n)),r}(this.apiClient,e);return s=ev("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}{let t=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],e7(e,n)),r}(this.apiClient,e);return s=ev("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],e7(e,n)),r}(this.apiClient,e);return s=ev("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);return null!=r&&e_(t,["sdkHttpResponse"],r),t}(e),r=new eU;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=eE(t,["name"]);return null!=n&&e_(r,["_url","name"],e7(e,n)),r}(this.apiClient,e);return s=ev("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);return null!=r&&e_(t,["sdkHttpResponse"],r),t}(e),r=new eU;return Object.assign(r,t),r})}}async update(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["name"]);null!=n&&e_(r,["_url","name"],e7(e,n));let i=eE(t,["config"]);return null!=i&&function(e,t){let r=eE(e,["ttl"]);void 0!==t&&null!=r&&e_(t,["ttl"],r);let n=eE(e,["expireTime"]);void 0!==t&&null!=n&&e_(t,["expireTime"],n)}(i,r),r}(this.apiClient,e);return s=ev("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}{let t=function(e,t){let r={},n=eE(t,["name"]);null!=n&&e_(r,["_url","name"],e7(e,n));let i=eE(t,["config"]);return null!=i&&function(e,t){let r=eE(e,["ttl"]);void 0!==t&&null!=r&&e_(t,["ttl"],r);let n=eE(e,["expireTime"]);void 0!==t&&null!=n&&e_(t,["expireTime"],n)}(i,r),r}(this.apiClient,e);return s=ev("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>e)}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=eE(e,["config"]);return null!=r&&function(e,t){let r=eE(e,["pageSize"]);void 0!==t&&null!=r&&e_(t,["_query","pageSize"],r);let n=eE(e,["pageToken"]);void 0!==t&&null!=n&&e_(t,["_query","pageToken"],n)}(r,t),t}(e);return s=ev("cachedContents",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["nextPageToken"]);null!=n&&e_(t,["nextPageToken"],n);let i=eE(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["cachedContents"],e)}return t}(e),r=new eM;return Object.assign(r,t),r})}{let t=function(e){let t={},r=eE(e,["config"]);return null!=r&&function(e,t){let r=eE(e,["pageSize"]);void 0!==t&&null!=r&&e_(t,["_query","pageSize"],r);let n=eE(e,["pageToken"]);void 0!==t&&null!=n&&e_(t,["_query","pageToken"],n)}(r,t),t}(e);return s=ev("cachedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["nextPageToken"]);null!=n&&e_(t,["nextPageToken"],n);let i=eE(e,["cachedContents"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["cachedContents"],e)}return t}(e),r=new eM;return Object.assign(r,t),r})}}}function tv(e){return this instanceof tv?(this.v=e,this):new tv(e)}function t_(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function o(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||a(e,t)})},t&&(n[e]=t(n[e])))}function a(e,t){try{var r;(r=i[e](t)).value instanceof tv?Promise.resolve(r.value.v).then(l,c):u(s[0][2],r)}catch(e){u(s[0][3],e)}}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function tE(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,i,(t=e[r](t)).done,t.value)})}}}function tb(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0}function tx(e){if(void 0===e||0===e.length)return[];let t=[],r=e.length,n=0;for(;n<r;)if("user"===e[n].role)t.push(e[n]),n++;else{let i=[],s=!0;for(;n<r&&"model"===e[n].role;)i.push(e[n]),s&&!tb(e[n])&&(s=!1),n++;s?t.push(...i):t.pop()}return t}"function"==typeof SuppressedError&&SuppressedError;class tA{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new tT(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class tT{constructor(e,t,r,n={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=n,this.history=i,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`)}}(i)}async sendMessage(e){var t;await this.sendPromise;let r=e1(e.message),n=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,i;let s=await n,o=null===(t=null===(e=s.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,a=s.automaticFunctionCallingHistory,l=this.getHistory(!0).length,c=[];null!=a&&(c=null!==(i=a.slice(l))&&void 0!==i?i:[]),this.recordHistory(r,o?[o]:[],c)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),n}async sendMessageStream(e){var t;await this.sendPromise;let r=e1(e.message),n=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=n.then(()=>void 0).catch(()=>void 0);let i=await n;return this.processStreamResponse(i,r)}getHistory(e=!1){return structuredClone(e?tx(this.history):this.history)}processStreamResponse(e,t){var r,n;return t_(this,arguments,function*(){var i,s,o,a;let l=[];try{for(var c,u=!0,d=tE(e);!(i=(c=yield tv(d.next())).done);u=!0){if(a=c.value,u=!1,function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let r=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==r&&tb(r)}(a)){let e=null===(n=null===(r=a.candidates)||void 0===r?void 0:r[0])||void 0===n?void 0:n.content;void 0!==e&&l.push(e)}yield yield tv(a)}}catch(e){s={error:e}}finally{try{!u&&!i&&(o=d.return)&&(yield tv(o.call(d)))}finally{if(s)throw s.error}}this.recordHistory(t,l)})}recordHistory(e,t,r){let n=[];t.length>0&&t.every(e=>void 0!==e.role)?n=t:n.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...tx(r)):this.history.push(e),this.history.push(...n)}}class tS extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,tS.prototype)}}class tC extends ey{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new tf(ee.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e)}async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=eE(e,["config"]);return null!=r&&function(e,t){let r=eE(e,["pageSize"]);void 0!==t&&null!=r&&e_(t,["_query","pageSize"],r);let n=eE(e,["pageToken"]);void 0!==t&&null!=n&&e_(t,["_query","pageToken"],n)}(r,t),t}(e);return n=ev("files",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["nextPageToken"]);null!=n&&e_(t,["nextPageToken"],n);let i=eE(e,["files"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["files"],e)}return t}(e),r=new eL;return Object.assign(r,t),r})}}async createInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=eE(e,["file"]);return null!=r&&e_(t,["file"],r),t}(e);return n=ev("upload/v1beta/files",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);return null!=r&&e_(t,["sdkHttpResponse"],r),t}(e),r=new eG;return Object.assign(r,t),r})}}async get(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=eE(e,["name"]);return null!=r&&e_(t,["_url","file"],tn(r)),t}(e);return n=ev("files/{file}",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}async delete(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e){let t={},r=eE(e,["name"]);return null!=r&&e_(t,["_url","file"],tn(r)),t}(e);return n=ev("files/{file}",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);return null!=r&&e_(t,["sdkHttpResponse"],r),t}(e),r=new eq;return Object.assign(r,t),r})}}}function tw(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["data"]);null!=r&&e_(t,["data"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}function tO(e){let t={},r=eE(e,["voiceConfig"]);if(null!=r&&e_(t,["voiceConfig"],r),void 0!==eE(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let n=eE(e,["languageCode"]);return null!=n&&e_(t,["languageCode"],n),t}function tI(e){let t={},r=eE(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["videoMetadata"]);null!=r&&e_(t,["videoMetadata"],r);let n=eE(e,["thought"]);null!=n&&e_(t,["thought"],n);let i=eE(e,["inlineData"]);null!=i&&e_(t,["inlineData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["data"]);null!=r&&e_(t,["data"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(i));let s=eE(e,["fileData"]);null!=s&&e_(t,["fileData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["fileUri"]);null!=r&&e_(t,["fileUri"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(s));let o=eE(e,["thoughtSignature"]);null!=o&&e_(t,["thoughtSignature"],o);let a=eE(e,["functionCall"]);null!=a&&e_(t,["functionCall"],a);let l=eE(e,["codeExecutionResult"]);null!=l&&e_(t,["codeExecutionResult"],l);let c=eE(e,["executableCode"]);null!=c&&e_(t,["executableCode"],c);let u=eE(e,["functionResponse"]);null!=u&&e_(t,["functionResponse"],u);let d=eE(e,["text"]);return null!=d&&e_(t,["text"],d),t})(e))),e_(t,["parts"],e)}let n=eE(e,["role"]);return null!=n&&e_(t,["role"],n),t}function tN(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["contents"]);if(null!=i){let e=e4(i);Array.isArray(e)&&(e=e.map(e=>tI(e))),e_(r,["contents"],e)}let s=eE(t,["config"]);return null!=s&&e_(r,["generationConfig"],function(e,t,r){let n={},i=eE(t,["systemInstruction"]);void 0!==r&&null!=i&&e_(r,["systemInstruction"],tI(e1(i)));let s=eE(t,["temperature"]);null!=s&&e_(n,["temperature"],s);let o=eE(t,["topP"]);null!=o&&e_(n,["topP"],o);let a=eE(t,["topK"]);null!=a&&e_(n,["topK"],a);let l=eE(t,["candidateCount"]);null!=l&&e_(n,["candidateCount"],l);let c=eE(t,["maxOutputTokens"]);null!=c&&e_(n,["maxOutputTokens"],c);let u=eE(t,["stopSequences"]);null!=u&&e_(n,["stopSequences"],u);let d=eE(t,["responseLogprobs"]);null!=d&&e_(n,["responseLogprobs"],d);let p=eE(t,["logprobs"]);null!=p&&e_(n,["logprobs"],p);let h=eE(t,["presencePenalty"]);null!=h&&e_(n,["presencePenalty"],h);let f=eE(t,["frequencyPenalty"]);null!=f&&e_(n,["frequencyPenalty"],f);let m=eE(t,["seed"]);null!=m&&e_(n,["seed"],m);let g=eE(t,["responseMimeType"]);null!=g&&e_(n,["responseMimeType"],g);let y=eE(t,["responseSchema"]);null!=y&&e_(n,["responseSchema"],e6(y));let v=eE(t,["responseJsonSchema"]);if(null!=v&&e_(n,["responseJsonSchema"],v),void 0!==eE(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==eE(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let _=eE(t,["safetySettings"]);if(void 0!==r&&null!=_){let e=_;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==eE(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let r=eE(e,["category"]);null!=r&&e_(t,["category"],r);let n=eE(e,["threshold"]);return null!=n&&e_(t,["threshold"],n),t})(e))),e_(r,["safetySettings"],e)}let E=eE(t,["tools"]);if(void 0!==r&&null!=E){let e=e9(E);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["functionDeclarations"],e)}if(void 0!==eE(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=eE(e,["googleSearch"]);null!=n&&e_(t,["googleSearch"],function(e){let t={},r=eE(e,["timeRangeFilter"]);if(null!=r&&e_(t,["timeRangeFilter"],r),void 0!==eE(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=eE(e,["googleSearchRetrieval"]);if(null!=i&&e_(t,["googleSearchRetrieval"],i),void 0!==eE(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=eE(e,["googleMaps"]);null!=s&&e_(t,["googleMaps"],function(e){let t={};if(void 0!==eE(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=eE(e,["enableWidget"]);return null!=r&&e_(t,["enableWidget"],r),t}(s));let o=eE(e,["urlContext"]);null!=o&&e_(t,["urlContext"],o);let a=eE(e,["computerUse"]);null!=a&&e_(t,["computerUse"],a);let l=eE(e,["codeExecution"]);return null!=l&&e_(t,["codeExecution"],l),t})(e8(e)))),e_(r,["tools"],e)}let b=eE(t,["toolConfig"]);if(void 0!==r&&null!=b&&e_(r,["toolConfig"],b),void 0!==eE(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let x=eE(t,["cachedContent"]);void 0!==r&&null!=x&&e_(r,["cachedContent"],e7(e,x));let A=eE(t,["responseModalities"]);null!=A&&e_(n,["responseModalities"],A);let T=eE(t,["mediaResolution"]);null!=T&&e_(n,["mediaResolution"],T);let S=eE(t,["speechConfig"]);if(null!=S&&e_(n,["speechConfig"],e3(S)),void 0!==eE(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let C=eE(t,["thinkingConfig"]);null!=C&&e_(n,["thinkingConfig"],C);let w=eE(t,["imageConfig"]);return null!=w&&e_(n,["imageConfig"],w),n}(e,s,r)),r}function tk(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["contents"]);if(null!=i){let e=e4(i);Array.isArray(e)&&(e=e.map(e=>e)),e_(r,["contents"],e)}let s=eE(t,["config"]);return null!=s&&e_(r,["generationConfig"],function(e,t,r){let n={},i=eE(t,["systemInstruction"]);void 0!==r&&null!=i&&e_(r,["systemInstruction"],e1(i));let s=eE(t,["temperature"]);null!=s&&e_(n,["temperature"],s);let o=eE(t,["topP"]);null!=o&&e_(n,["topP"],o);let a=eE(t,["topK"]);null!=a&&e_(n,["topK"],a);let l=eE(t,["candidateCount"]);null!=l&&e_(n,["candidateCount"],l);let c=eE(t,["maxOutputTokens"]);null!=c&&e_(n,["maxOutputTokens"],c);let u=eE(t,["stopSequences"]);null!=u&&e_(n,["stopSequences"],u);let d=eE(t,["responseLogprobs"]);null!=d&&e_(n,["responseLogprobs"],d);let p=eE(t,["logprobs"]);null!=p&&e_(n,["logprobs"],p);let h=eE(t,["presencePenalty"]);null!=h&&e_(n,["presencePenalty"],h);let f=eE(t,["frequencyPenalty"]);null!=f&&e_(n,["frequencyPenalty"],f);let m=eE(t,["seed"]);null!=m&&e_(n,["seed"],m);let g=eE(t,["responseMimeType"]);null!=g&&e_(n,["responseMimeType"],g);let y=eE(t,["responseSchema"]);null!=y&&e_(n,["responseSchema"],e6(y));let v=eE(t,["responseJsonSchema"]);null!=v&&e_(n,["responseJsonSchema"],v);let _=eE(t,["routingConfig"]);null!=_&&e_(n,["routingConfig"],_);let E=eE(t,["modelSelectionConfig"]);null!=E&&e_(n,["modelConfig"],E);let b=eE(t,["safetySettings"]);if(void 0!==r&&null!=b){let e=b;Array.isArray(e)&&(e=e.map(e=>e)),e_(r,["safetySettings"],e)}let x=eE(t,["tools"]);if(void 0!==r&&null!=x){let e=e9(x);Array.isArray(e)&&(e=e.map(e=>tH(e8(e)))),e_(r,["tools"],e)}let A=eE(t,["toolConfig"]);void 0!==r&&null!=A&&e_(r,["toolConfig"],A);let T=eE(t,["labels"]);void 0!==r&&null!=T&&e_(r,["labels"],T);let S=eE(t,["cachedContent"]);void 0!==r&&null!=S&&e_(r,["cachedContent"],e7(e,S));let C=eE(t,["responseModalities"]);null!=C&&e_(n,["responseModalities"],C);let w=eE(t,["mediaResolution"]);null!=w&&e_(n,["mediaResolution"],w);let O=eE(t,["speechConfig"]);null!=O&&e_(n,["speechConfig"],tB(e3(O)));let I=eE(t,["audioTimestamp"]);null!=I&&e_(n,["audioTimestamp"],I);let N=eE(t,["thinkingConfig"]);null!=N&&e_(n,["thinkingConfig"],N);let k=eE(t,["imageConfig"]);return null!=k&&e_(n,["imageConfig"],k),n}(e,s,r)),r}function tR(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["content"]);null!=r&&e_(t,["content"],r);let n=eE(e,["citationMetadata"]);null!=n&&e_(t,["citationMetadata"],function(e){let t={},r=eE(e,["citationSources"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["citations"],e)}return t}(n));let i=eE(e,["tokenCount"]);null!=i&&e_(t,["tokenCount"],i);let s=eE(e,["finishReason"]);null!=s&&e_(t,["finishReason"],s);let o=eE(e,["urlContextMetadata"]);null!=o&&e_(t,["urlContextMetadata"],o);let a=eE(e,["avgLogprobs"]);null!=a&&e_(t,["avgLogprobs"],a);let l=eE(e,["groundingMetadata"]);null!=l&&e_(t,["groundingMetadata"],l);let c=eE(e,["index"]);null!=c&&e_(t,["index"],c);let u=eE(e,["logprobsResult"]);null!=u&&e_(t,["logprobsResult"],u);let d=eE(e,["safetyRatings"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["safetyRatings"],e)}return t})(e))),e_(t,["candidates"],e)}let i=eE(e,["modelVersion"]);null!=i&&e_(t,["modelVersion"],i);let s=eE(e,["promptFeedback"]);null!=s&&e_(t,["promptFeedback"],s);let o=eE(e,["responseId"]);null!=o&&e_(t,["responseId"],o);let a=eE(e,["usageMetadata"]);return null!=a&&e_(t,["usageMetadata"],a),t}function tP(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["candidates"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["candidates"],e)}let i=eE(e,["createTime"]);null!=i&&e_(t,["createTime"],i);let s=eE(e,["modelVersion"]);null!=s&&e_(t,["modelVersion"],s);let o=eE(e,["promptFeedback"]);null!=o&&e_(t,["promptFeedback"],o);let a=eE(e,["responseId"]);null!=a&&e_(t,["responseId"],a);let l=eE(e,["usageMetadata"]);return null!=l&&e_(t,["usageMetadata"],l),t}function tj(e){let t={},r=eE(e,["_self"]);null!=r&&e_(t,["image"],tD(r));let n=eE(e,["raiFilteredReason"]);null!=n&&e_(t,["raiFilteredReason"],n);let i=eE(e,["_self"]);null!=i&&e_(t,["safetyAttributes"],tF(i));let s=eE(e,["prompt"]);return null!=s&&e_(t,["enhancedPrompt"],s),t}function tD(e){let t={},r=eE(e,["gcsUri"]);null!=r&&e_(t,["gcsUri"],r);let n=eE(e,["bytesBase64Encoded"]);null!=n&&e_(t,["imageBytes"],eb(n));let i=eE(e,["mimeType"]);return null!=i&&e_(t,["mimeType"],i),t}function tU(e){let t={};if(void 0!==eE(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let r=eE(e,["imageBytes"]);null!=r&&e_(t,["bytesBase64Encoded"],eb(r));let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}function tM(e){let t={},r=eE(e,["gcsUri"]);null!=r&&e_(t,["gcsUri"],r);let n=eE(e,["imageBytes"]);null!=n&&e_(t,["bytesBase64Encoded"],eb(n));let i=eE(e,["mimeType"]);return null!=i&&e_(t,["mimeType"],i),t}function tL(e){let t={},r=eE(e,["name"]);null!=r&&e_(t,["name"],r);let n=eE(e,["displayName"]);null!=n&&e_(t,["displayName"],n);let i=eE(e,["description"]);null!=i&&e_(t,["description"],i);let s=eE(e,["version"]);null!=s&&e_(t,["version"],s);let o=eE(e,["_self"]);null!=o&&e_(t,["tunedModelInfo"],function(e){let t={},r=eE(e,["baseModel"]);null!=r&&e_(t,["baseModel"],r);let n=eE(e,["createTime"]);null!=n&&e_(t,["createTime"],n);let i=eE(e,["updateTime"]);return null!=i&&e_(t,["updateTime"],i),t}(o));let a=eE(e,["inputTokenLimit"]);null!=a&&e_(t,["inputTokenLimit"],a);let l=eE(e,["outputTokenLimit"]);null!=l&&e_(t,["outputTokenLimit"],l);let c=eE(e,["supportedGenerationMethods"]);return null!=c&&e_(t,["supportedActions"],c),t}function tG(e){let t={},r=eE(e,["name"]);null!=r&&e_(t,["name"],r);let n=eE(e,["displayName"]);null!=n&&e_(t,["displayName"],n);let i=eE(e,["description"]);null!=i&&e_(t,["description"],i);let s=eE(e,["versionId"]);null!=s&&e_(t,["version"],s);let o=eE(e,["deployedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["endpoint"]);null!=r&&e_(t,["name"],r);let n=eE(e,["deployedModelId"]);return null!=n&&e_(t,["deployedModelId"],n),t})(e))),e_(t,["endpoints"],e)}let a=eE(e,["labels"]);null!=a&&e_(t,["labels"],a);let l=eE(e,["_self"]);null!=l&&e_(t,["tunedModelInfo"],function(e){let t={},r=eE(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=r&&e_(t,["baseModel"],r);let n=eE(e,["createTime"]);null!=n&&e_(t,["createTime"],n);let i=eE(e,["updateTime"]);return null!=i&&e_(t,["updateTime"],i),t}(l));let c=eE(e,["defaultCheckpointId"]);null!=c&&e_(t,["defaultCheckpointId"],c);let u=eE(e,["checkpoints"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["checkpoints"],e)}return t}function tq(e){let t={},r=eE(e,["safetyAttributes","categories"]);null!=r&&e_(t,["categories"],r);let n=eE(e,["safetyAttributes","scores"]);null!=n&&e_(t,["scores"],n);let i=eE(e,["contentType"]);return null!=i&&e_(t,["contentType"],i),t}function tF(e){let t={},r=eE(e,["safetyAttributes","categories"]);null!=r&&e_(t,["categories"],r);let n=eE(e,["safetyAttributes","scores"]);null!=n&&e_(t,["scores"],n);let i=eE(e,["contentType"]);return null!=i&&e_(t,["contentType"],i),t}function tB(e){let t={},r=eE(e,["voiceConfig"]);if(null!=r&&e_(t,["voiceConfig"],r),void 0!==eE(e,["multiSpeakerVoiceConfig"]))throw Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");let n=eE(e,["languageCode"]);return null!=n&&e_(t,["languageCode"],n),t}function tH(e){let t={},r=eE(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==eE(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=eE(e,["description"]);null!=r&&e_(t,["description"],r);let n=eE(e,["name"]);null!=n&&e_(t,["name"],n);let i=eE(e,["parameters"]);null!=i&&e_(t,["parameters"],i);let s=eE(e,["parametersJsonSchema"]);null!=s&&e_(t,["parametersJsonSchema"],s);let o=eE(e,["response"]);null!=o&&e_(t,["response"],o);let a=eE(e,["responseJsonSchema"]);return null!=a&&e_(t,["responseJsonSchema"],a),t})(e))),e_(t,["functionDeclarations"],e)}let n=eE(e,["retrieval"]);null!=n&&e_(t,["retrieval"],n);let i=eE(e,["googleSearch"]);null!=i&&e_(t,["googleSearch"],i);let s=eE(e,["googleSearchRetrieval"]);null!=s&&e_(t,["googleSearchRetrieval"],s);let o=eE(e,["enterpriseWebSearch"]);null!=o&&e_(t,["enterpriseWebSearch"],o);let a=eE(e,["googleMaps"]);null!=a&&e_(t,["googleMaps"],a);let l=eE(e,["urlContext"]);null!=l&&e_(t,["urlContext"],l);let c=eE(e,["computerUse"]);null!=c&&e_(t,["computerUse"],c);let u=eE(e,["codeExecution"]);return null!=u&&e_(t,["codeExecution"],u),t}function tV(e){let t={},r=eE(e,["uri"]);null!=r&&e_(t,["uri"],r);let n=eE(e,["videoBytes"]);null!=n&&e_(t,["encodedVideo"],eb(n));let i=eE(e,["mimeType"]);return null!=i&&e_(t,["encoding"],i),t}function t$(e){let t={},r=eE(e,["uri"]);null!=r&&e_(t,["gcsUri"],r);let n=eE(e,["videoBytes"]);null!=n&&e_(t,["bytesBase64Encoded"],eb(n));let i=eE(e,["mimeType"]);return null!=i&&e_(t,["mimeType"],i),t}let tJ="x-goog-api-client",tW=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class tK{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});let n={};this.clientOptions.vertexai?(n.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",n.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(n.apiVersion=null!==(r=this.clientOptions.apiVersion)&&void 0!==r?r:"v1beta",n.baseUrl="https://generativelanguage.googleapis.com/"),n.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=n,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(n,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let e=new URL(this.getBaseUrl());return e.protocol="http:"==e.protocol?"ws":"wss",e.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.")}constructUrl(e,t,r){let n=[this.getRequestUrlInternal(t)];return r&&n.push(this.getBaseResourcePath()),""!==e&&n.push(e),new URL(`${n.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let r=this.shouldPrependVertexProjectPath(e),n=this.constructUrl(e.path,t,r);if(e.queryParams)for(let[t,r]of Object.entries(e.queryParams))n.searchParams.append(t,String(r));let i={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,n.toString(),e.abortSignal),this.unaryApiCall(n,i,e.httpMethod)}patchHttpOptions(e,t){let r=JSON.parse(JSON.stringify(e));for(let[e,n]of Object.entries(t))"object"==typeof n?r[e]=Object.assign(Object.assign({},r[e]),n):void 0!==n&&(r[e]=n);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let r=this.shouldPrependVertexProjectPath(e),n=this.constructUrl(e.path,t,r);n.searchParams.has("alt")&&"sse"===n.searchParams.get("alt")||n.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,n.toString(),e.abortSignal),this.streamApiCall(n,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r,n){if(t&&t.timeout||n){let r=new AbortController,i=r.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){let e=setTimeout(()=>r.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref()}n&&n.addEventListener("abort",()=>{r.abort()}),e.signal=i}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let r={};if("string"==typeof e.body&&e.body.length>0)try{let t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t)){console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}r=t}catch(e){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}let n=function e(t,r){let n=Object.assign({},t);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)){let i=r[t],s=n[t];i&&"object"==typeof i&&!Array.isArray(i)&&s&&"object"==typeof s&&!Array.isArray(s)?n[t]=e(s,i):(s&&i&&typeof s!=typeof i&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${t}". Original type: ${typeof s}, New type: ${typeof i}. Overwriting.`),n[t]=i)}return n}(r,t);e.body=JSON.stringify(n)}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,r),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async e=>(await tY(e),new ex(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async e=>(await tY(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e))})}processStreamResponse(e){var t;return t_(this,arguments,function*(){let r=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),n=new TextDecoder("utf-8");if(!r)throw Error("Response body is empty");try{let t="";for(;;){let{done:i,value:s}=yield tv(r.read());if(i){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let o=n.decode(s,{stream:!0});try{let e=JSON.parse(o);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),r=t.status,n=t.code,i=`got status: ${r}. ${JSON.stringify(e)}`;if(n>=400&&n<600)throw new tS({message:i,status:n})}}catch(e){if("ApiError"===e.name)throw e}let a=(t+=o).match(tW);for(;a;){let r=a[1];try{let n=new Response(r,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield tv(new ex(n)),a=(t=t.slice(a[0].length)).match(tW)}catch(e){throw Error(`exception parsing stream chunk ${r}. ${e}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`)})}getDefaultHeaders(){let e={},t="google-genai-sdk/1.27.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[tJ]=t,e["Content-Type"]="application/json",e}async getHeadersInternal(e,t){let r=new Headers;if(e&&e.headers){for(let[t,n]of Object.entries(e.headers))r.append(t,n);e.timeout&&e.timeout>0&&r.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,t),r}async uploadFile(e,t){var r;let n={};null!=t&&(n.mimeType=t.mimeType,n.name=t.name,n.displayName=t.displayName),n.name&&!n.name.startsWith("files/")&&(n.name=`files/${n.name}`);let i=this.clientOptions.uploader,s=await i.stat(e);n.sizeBytes=String(s.size);let o=null!==(r=null==t?void 0:t.mimeType)&&void 0!==r?r:s.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");n.mimeType=o;let a=await this.fetchUploadUrl(n,t);return i.upload(e,a,this)}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this)}async fetchUploadUrl(e,t){var r;let n={};n=(null==t?void 0:t.httpOptions)?t.httpOptions:{apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};let i={file:e},s=await this.request({path:ev("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:n});if(!s||!(null==s?void 0:s.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let o=null===(r=null==s?void 0:s.headers)||void 0===r?void 0:r["x-goog-upload-url"];if(void 0===o)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return o}}async function tY(e){var t;if(void 0===e)throw Error("response is undefined");if(!e.ok){let r=e.status,n=JSON.stringify((null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}});if(r>=400&&r<600)throw new tS({message:n,status:r});throw Error(n)}}function tz(e){for(let t of e){if(null!==t&&"object"==typeof t&&t instanceof tZ||"object"==typeof t&&"inputSchema"in t)return!0}return!1}function tX(e){var t;let r=null!==(t=e[tJ])&&void 0!==t?t:"";e[tJ]=(r+" mcp_used/unknown").trimStart()}class tZ{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new tZ(e,t)}async initialize(){var e,t,r,n;if(this.mcpTools.length>0)return;let i={},s=[];for(let c of this.mcpClients)try{for(var o,a=!0,l=(t=void 0,tE(function(e,t=100){return t_(this,arguments,function*(){let r;let n=0;for(;n<t;){let t=yield tv(e.listTools({cursor:r}));for(let e of t.tools)yield yield tv(e),n++;if(!t.nextCursor)break;r=t.nextCursor}})}(c)));!(e=(o=await l.next()).done);a=!0){n=o.value,a=!1,s.push(n);let e=n.name;if(i[e])throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);i[e]=c}}catch(e){t={error:e}}finally{try{!a&&!e&&(r=l.return)&&await r.call(l)}finally{if(t)throw t.error}}this.mcpTools=s,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),function(e,t={}){let r=[],n=new Set;for(let i of e){let e=i.name;if(n.has(e))throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);n.add(e);let s=function(e,t={}){let r={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return e.outputSchema&&(r.responseJsonSchema=e.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}(i,t);s.functionDeclarations&&r.push(...s.functionDeclarations)}return{functionDeclarations:r}}(this.mcpTools,this.config)}async callTool(e){await this.initialize();let t=[];for(let r of e)if(r.name in this.functionNameToMcpClient){let e;let n=this.functionNameToMcpClient[r.name];this.config.timeout&&(e={timeout:this.config.timeout});let i=await n.callTool({name:r.name,arguments:r.args},void 0,e);t.push({functionResponse:{name:r.name,response:i.isError?{error:i}:i}})}return t}}async function tQ(e,t,r){let n;let i=new eH;r.data instanceof Blob?n=JSON.parse(await r.data.text()):n=JSON.parse(r.data),Object.assign(i,n),t(i)}class t0{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let n=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),s=function(e){let t=new Headers;for(let[r,n]of Object.entries(e))t.append(r,n);return t}(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),a=`${n}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${o}`,l=()=>{},c=new Promise(e=>{l=e}),u=e.callbacks,d=this.apiClient,p={onopen:function(){l({})},onmessage:e=>{tQ(d,u.onmessage,e)},onerror:null!==(t=null==u?void 0:u.onerror)&&void 0!==t?t:function(e){},onclose:null!==(r=null==u?void 0:u.onclose)&&void 0!==r?r:function(e){}},h=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,r)=>{t[r]=e}),t}(s),p);h.connect(),await c;let f=eV(this.apiClient,e.model);return h.send(JSON.stringify({setup:{model:f}})),new t1(h,this.apiClient)}}class t1{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=function(e){let t={},r=eE(e,["weightedPrompts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["weightedPrompts"],e)}return t}(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=function(e){let t={},r=eE(e,["musicGenerationConfig"]);return null!=r&&e_(t,["musicGenerationConfig"],r),t}(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){this.conn.send(JSON.stringify({playbackControl:e}))}play(){this.sendPlaybackControl(Q.PLAY)}pause(){this.sendPlaybackControl(Q.PAUSE)}stop(){this.sendPlaybackControl(Q.STOP)}resetContext(){this.sendPlaybackControl(Q.RESET_CONTEXT)}close(){this.conn.close()}}async function t2(e,t,r){let n;let i=new eB;r.data instanceof Blob?n=await r.data.text():n=r.data instanceof ArrayBuffer?new TextDecoder().decode(r.data):r.data;let s=JSON.parse(n);e.isVertexAI()?Object.assign(i,function(e){let t={},r=eE(e,["setupComplete"]);null!=r&&e_(t,["setupComplete"],r);let n=eE(e,["serverContent"]);null!=n&&e_(t,["serverContent"],n);let i=eE(e,["toolCall"]);null!=i&&e_(t,["toolCall"],i);let s=eE(e,["toolCallCancellation"]);null!=s&&e_(t,["toolCallCancellation"],s);let o=eE(e,["usageMetadata"]);null!=o&&e_(t,["usageMetadata"],function(e){let t={},r=eE(e,["promptTokenCount"]);null!=r&&e_(t,["promptTokenCount"],r);let n=eE(e,["cachedContentTokenCount"]);null!=n&&e_(t,["cachedContentTokenCount"],n);let i=eE(e,["candidatesTokenCount"]);null!=i&&e_(t,["responseTokenCount"],i);let s=eE(e,["toolUsePromptTokenCount"]);null!=s&&e_(t,["toolUsePromptTokenCount"],s);let o=eE(e,["thoughtsTokenCount"]);null!=o&&e_(t,["thoughtsTokenCount"],o);let a=eE(e,["totalTokenCount"]);null!=a&&e_(t,["totalTokenCount"],a);let l=eE(e,["promptTokensDetails"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["promptTokensDetails"],e)}let c=eE(e,["cacheTokensDetails"]);if(null!=c){let e=c;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["cacheTokensDetails"],e)}let u=eE(e,["candidatesTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["responseTokensDetails"],e)}let d=eE(e,["toolUsePromptTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["toolUsePromptTokensDetails"],e)}let p=eE(e,["trafficType"]);return null!=p&&e_(t,["trafficType"],p),t}(o));let a=eE(e,["goAway"]);null!=a&&e_(t,["goAway"],a);let l=eE(e,["sessionResumptionUpdate"]);return null!=l&&e_(t,["sessionResumptionUpdate"],l),t}(s)):Object.assign(i,s),t(i)}class t4{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new t0(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,n,i,s,o;let a;if(e.config&&e.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let l=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),u=this.apiClient.getHeaders();e.config&&e.config.tools&&tz(e.config.tools)&&tX(u);let d=function(e){let t=new Headers;for(let[r,n]of Object.entries(e))t.append(r,n);return t}(u);if(this.apiClient.isVertexAI())a=`${l}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d,a);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",r="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==c&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",r="access_token"),a=`${l}/ws/google.ai.generativelanguage.${c}.GenerativeService.${t}?${r}=${e}`}let p=()=>{},h=new Promise(e=>{p=e}),f=e.callbacks,m=this.apiClient,g={onopen:function(){var e;null===(e=null==f?void 0:f.onopen)||void 0===e||e.call(f),p({})},onmessage:e=>{t2(m,f.onmessage,e)},onerror:null!==(t=null==f?void 0:f.onerror)&&void 0!==t?t:function(e){},onclose:null!==(r=null==f?void 0:f.onclose)&&void 0!==r?r:function(e){}},y=this.webSocketFactory.create(a,function(e){let t={};return e.forEach((e,r)=>{t[r]=e}),t}(d),g);y.connect(),await h;let v=eV(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();v=`projects/${e}/locations/${t}/`+v}let _={};this.apiClient.isVertexAI()&&(null===(n=e.config)||void 0===n?void 0:n.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[b.AUDIO]}:e.config.responseModalities=[b.AUDIO]),(null===(i=e.config)||void 0===i?void 0:i.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let E=null!==(o=null===(s=e.config)||void 0===s?void 0:s.tools)&&void 0!==o?o:[],x=[];for(let e of E)this.isCallableTool(e)?x.push(await e.tool()):x.push(e);x.length>0&&(e.config.tools=x);let A={model:v,config:e.config,callbacks:e.callbacks};return _=this.apiClient.isVertexAI()?function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["setup","model"],eV(e,n));let i=eE(t,["config"]);return null!=i&&e_(r,["config"],function(e,t){let r=eE(e,["generationConfig"]);void 0!==t&&null!=r&&e_(t,["setup","generationConfig"],function(e){let t={},r=eE(e,["modelSelectionConfig"]);null!=r&&e_(t,["modelConfig"],r);let n=eE(e,["audioTimestamp"]);null!=n&&e_(t,["audioTimestamp"],n);let i=eE(e,["candidateCount"]);null!=i&&e_(t,["candidateCount"],i);let s=eE(e,["enableAffectiveDialog"]);null!=s&&e_(t,["enableAffectiveDialog"],s);let o=eE(e,["frequencyPenalty"]);null!=o&&e_(t,["frequencyPenalty"],o);let a=eE(e,["logprobs"]);null!=a&&e_(t,["logprobs"],a);let l=eE(e,["maxOutputTokens"]);null!=l&&e_(t,["maxOutputTokens"],l);let c=eE(e,["mediaResolution"]);null!=c&&e_(t,["mediaResolution"],c);let u=eE(e,["presencePenalty"]);null!=u&&e_(t,["presencePenalty"],u);let d=eE(e,["responseJsonSchema"]);null!=d&&e_(t,["responseJsonSchema"],d);let p=eE(e,["responseLogprobs"]);null!=p&&e_(t,["responseLogprobs"],p);let h=eE(e,["responseMimeType"]);null!=h&&e_(t,["responseMimeType"],h);let f=eE(e,["responseModalities"]);null!=f&&e_(t,["responseModalities"],f);let m=eE(e,["responseSchema"]);null!=m&&e_(t,["responseSchema"],m);let g=eE(e,["routingConfig"]);null!=g&&e_(t,["routingConfig"],g);let y=eE(e,["seed"]);null!=y&&e_(t,["seed"],y);let v=eE(e,["speechConfig"]);null!=v&&e_(t,["speechConfig"],tO(v));let _=eE(e,["stopSequences"]);null!=_&&e_(t,["stopSequences"],_);let E=eE(e,["temperature"]);null!=E&&e_(t,["temperature"],E);let b=eE(e,["thinkingConfig"]);null!=b&&e_(t,["thinkingConfig"],b);let x=eE(e,["topK"]);null!=x&&e_(t,["topK"],x);let A=eE(e,["topP"]);if(null!=A&&e_(t,["topP"],A),void 0!==eE(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(r));let n=eE(e,["responseModalities"]);void 0!==t&&null!=n&&e_(t,["setup","generationConfig","responseModalities"],n);let i=eE(e,["temperature"]);void 0!==t&&null!=i&&e_(t,["setup","generationConfig","temperature"],i);let s=eE(e,["topP"]);void 0!==t&&null!=s&&e_(t,["setup","generationConfig","topP"],s);let o=eE(e,["topK"]);void 0!==t&&null!=o&&e_(t,["setup","generationConfig","topK"],o);let a=eE(e,["maxOutputTokens"]);void 0!==t&&null!=a&&e_(t,["setup","generationConfig","maxOutputTokens"],a);let l=eE(e,["mediaResolution"]);void 0!==t&&null!=l&&e_(t,["setup","generationConfig","mediaResolution"],l);let c=eE(e,["seed"]);void 0!==t&&null!=c&&e_(t,["setup","generationConfig","seed"],c);let u=eE(e,["speechConfig"]);void 0!==t&&null!=u&&e_(t,["setup","generationConfig","speechConfig"],tO(e5(u)));let d=eE(e,["thinkingConfig"]);void 0!==t&&null!=d&&e_(t,["setup","generationConfig","thinkingConfig"],d);let p=eE(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&e_(t,["setup","generationConfig","enableAffectiveDialog"],p);let h=eE(e,["systemInstruction"]);void 0!==t&&null!=h&&e_(t,["setup","systemInstruction"],e1(h));let f=eE(e,["tools"]);if(void 0!==t&&null!=f){let e=e9(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==eE(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let r=eE(e,["description"]);null!=r&&e_(t,["description"],r);let n=eE(e,["name"]);null!=n&&e_(t,["name"],n);let i=eE(e,["parameters"]);null!=i&&e_(t,["parameters"],i);let s=eE(e,["parametersJsonSchema"]);null!=s&&e_(t,["parametersJsonSchema"],s);let o=eE(e,["response"]);null!=o&&e_(t,["response"],o);let a=eE(e,["responseJsonSchema"]);return null!=a&&e_(t,["responseJsonSchema"],a),t})(e))),e_(t,["functionDeclarations"],e)}let n=eE(e,["retrieval"]);null!=n&&e_(t,["retrieval"],n);let i=eE(e,["googleSearch"]);null!=i&&e_(t,["googleSearch"],i);let s=eE(e,["googleSearchRetrieval"]);null!=s&&e_(t,["googleSearchRetrieval"],s);let o=eE(e,["enterpriseWebSearch"]);null!=o&&e_(t,["enterpriseWebSearch"],o);let a=eE(e,["googleMaps"]);null!=a&&e_(t,["googleMaps"],a);let l=eE(e,["urlContext"]);null!=l&&e_(t,["urlContext"],l);let c=eE(e,["computerUse"]);null!=c&&e_(t,["computerUse"],c);let u=eE(e,["codeExecution"]);return null!=u&&e_(t,["codeExecution"],u),t})(e8(e)))),e_(t,["setup","tools"],e)}let m=eE(e,["sessionResumption"]);void 0!==t&&null!=m&&e_(t,["setup","sessionResumption"],m);let g=eE(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&e_(t,["setup","inputAudioTranscription"],g);let y=eE(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&e_(t,["setup","outputAudioTranscription"],y);let v=eE(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&e_(t,["setup","realtimeInputConfig"],v);let _=eE(e,["contextWindowCompression"]);void 0!==t&&null!=_&&e_(t,["setup","contextWindowCompression"],_);let E=eE(e,["proactivity"]);return void 0!==t&&null!=E&&e_(t,["setup","proactivity"],E),{}}(i,r)),r}(this.apiClient,A):function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["setup","model"],eV(e,n));let i=eE(t,["config"]);return null!=i&&e_(r,["config"],function(e,t){let r=eE(e,["generationConfig"]);void 0!==t&&null!=r&&e_(t,["setup","generationConfig"],r);let n=eE(e,["responseModalities"]);void 0!==t&&null!=n&&e_(t,["setup","generationConfig","responseModalities"],n);let i=eE(e,["temperature"]);void 0!==t&&null!=i&&e_(t,["setup","generationConfig","temperature"],i);let s=eE(e,["topP"]);void 0!==t&&null!=s&&e_(t,["setup","generationConfig","topP"],s);let o=eE(e,["topK"]);void 0!==t&&null!=o&&e_(t,["setup","generationConfig","topK"],o);let a=eE(e,["maxOutputTokens"]);void 0!==t&&null!=a&&e_(t,["setup","generationConfig","maxOutputTokens"],a);let l=eE(e,["mediaResolution"]);void 0!==t&&null!=l&&e_(t,["setup","generationConfig","mediaResolution"],l);let c=eE(e,["seed"]);void 0!==t&&null!=c&&e_(t,["setup","generationConfig","seed"],c);let u=eE(e,["speechConfig"]);void 0!==t&&null!=u&&e_(t,["setup","generationConfig","speechConfig"],e5(u));let d=eE(e,["thinkingConfig"]);void 0!==t&&null!=d&&e_(t,["setup","generationConfig","thinkingConfig"],d);let p=eE(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&e_(t,["setup","generationConfig","enableAffectiveDialog"],p);let h=eE(e,["systemInstruction"]);void 0!==t&&null!=h&&e_(t,["setup","systemInstruction"],function(e){let t={},r=eE(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["videoMetadata"]);null!=r&&e_(t,["videoMetadata"],r);let n=eE(e,["thought"]);null!=n&&e_(t,["thought"],n);let i=eE(e,["inlineData"]);null!=i&&e_(t,["inlineData"],tw(i));let s=eE(e,["fileData"]);null!=s&&e_(t,["fileData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["fileUri"]);null!=r&&e_(t,["fileUri"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(s));let o=eE(e,["thoughtSignature"]);null!=o&&e_(t,["thoughtSignature"],o);let a=eE(e,["functionCall"]);null!=a&&e_(t,["functionCall"],a);let l=eE(e,["codeExecutionResult"]);null!=l&&e_(t,["codeExecutionResult"],l);let c=eE(e,["executableCode"]);null!=c&&e_(t,["executableCode"],c);let u=eE(e,["functionResponse"]);null!=u&&e_(t,["functionResponse"],u);let d=eE(e,["text"]);return null!=d&&e_(t,["text"],d),t})(e))),e_(t,["parts"],e)}let n=eE(e,["role"]);return null!=n&&e_(t,["role"],n),t}(e1(h)));let f=eE(e,["tools"]);if(void 0!==t&&null!=f){let e=e9(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["functionDeclarations"],e)}if(void 0!==eE(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=eE(e,["googleSearch"]);null!=n&&e_(t,["googleSearch"],function(e){let t={},r=eE(e,["timeRangeFilter"]);if(null!=r&&e_(t,["timeRangeFilter"],r),void 0!==eE(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=eE(e,["googleSearchRetrieval"]);if(null!=i&&e_(t,["googleSearchRetrieval"],i),void 0!==eE(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=eE(e,["googleMaps"]);null!=s&&e_(t,["googleMaps"],function(e){let t={};if(void 0!==eE(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=eE(e,["enableWidget"]);return null!=r&&e_(t,["enableWidget"],r),t}(s));let o=eE(e,["urlContext"]);null!=o&&e_(t,["urlContext"],o);let a=eE(e,["computerUse"]);null!=a&&e_(t,["computerUse"],a);let l=eE(e,["codeExecution"]);return null!=l&&e_(t,["codeExecution"],l),t})(e8(e)))),e_(t,["setup","tools"],e)}let m=eE(e,["sessionResumption"]);void 0!==t&&null!=m&&e_(t,["setup","sessionResumption"],function(e){let t={},r=eE(e,["handle"]);if(null!=r&&e_(t,["handle"],r),void 0!==eE(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(m));let g=eE(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&e_(t,["setup","inputAudioTranscription"],g);let y=eE(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&e_(t,["setup","outputAudioTranscription"],y);let v=eE(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&e_(t,["setup","realtimeInputConfig"],v);let _=eE(e,["contextWindowCompression"]);void 0!==t&&null!=_&&e_(t,["setup","contextWindowCompression"],_);let E=eE(e,["proactivity"]);return void 0!==t&&null!=E&&e_(t,["setup","proactivity"],E),{}}(i,r)),r}(this.apiClient,A),delete _.config,y.send(JSON.stringify(_)),new t3(y,this.apiClient)}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool}}let t6={turnComplete:!0};class t3{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let r=[];try{r=e4(t.turns),e.isVertexAI()||(r=r.map(e=>tI(e)))}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(null==t.functionResponses||0===(r=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of r){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},t6),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e){let t={},r=eE(e,["media"]);if(null!=r){let e=eJ(r);Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["mediaChunks"],e)}let n=eE(e,["audio"]);null!=n&&e_(t,["audio"],eY(n));let i=eE(e,["audioStreamEnd"]);null!=i&&e_(t,["audioStreamEnd"],i);let s=eE(e,["video"]);null!=s&&e_(t,["video"],eK(s));let o=eE(e,["text"]);null!=o&&e_(t,["text"],o);let a=eE(e,["activityStart"]);null!=a&&e_(t,["activityStart"],a);let l=eE(e,["activityEnd"]);return null!=l&&e_(t,["activityEnd"],l),t}(e)}:{realtimeInput:function(e){let t={},r=eE(e,["media"]);if(null!=r){let e=eJ(r);Array.isArray(e)&&(e=e.map(e=>tw(e))),e_(t,["mediaChunks"],e)}let n=eE(e,["audio"]);null!=n&&e_(t,["audio"],tw(eY(n)));let i=eE(e,["audioStreamEnd"]);null!=i&&e_(t,["audioStreamEnd"],i);let s=eE(e,["video"]);null!=s&&e_(t,["video"],tw(eK(s)));let o=eE(e,["text"]);null!=o&&e_(t,["text"],o);let a=eE(e,["activityStart"]);null!=a&&e_(t,["activityStart"],a);let l=eE(e,["activityEnd"]);return null!=l&&e_(t,["activityEnd"],l),t}(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function t5(e){var t,r,n;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let i=!1;for(let t of null!==(r=null==e?void 0:e.tools)&&void 0!==r?r:[])if(t8(t)){i=!0;break}if(!i)return!0;let s=null===(n=null==e?void 0:e.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls;return(!!s&&(s<0||!Number.isInteger(s))||0==s)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0)}function t8(e){return"callTool"in e&&"function"==typeof e.callTool}function t9(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory)}class t7 extends ey{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,r,n,i,s;let o,a;let l=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!function(e){var t,r,n;return null!==(n=null===(r=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===r?void 0:r.some(e=>t8(e)))&&void 0!==n&&n}(e)||t5(e.config))return await this.generateContentInternal(l);if(function(e){var t,r,n;return null!==(n=null===(r=null===(t=e.config)||void 0===t?void 0:t.tools)||void 0===r?void 0:r.some(e=>!t8(e)))&&void 0!==n&&n}(e))throw Error("Automatic function calling with CallableTools and Tools is not yet supported.");let c=e4(l.contents),u=null!==(n=null===(r=null===(t=l.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===r?void 0:r.maximumRemoteCalls)&&void 0!==n?n:10,d=0;for(;d<u&&(o=await this.generateContentInternal(l)).functionCalls&&0!==o.functionCalls.length;){let t=o.candidates[0].content,r=[];for(let t of null!==(s=null===(i=e.config)||void 0===i?void 0:i.tools)&&void 0!==s?s:[])if(t8(t)){let e=await t.callTool(o.functionCalls);r.push(...e)}d++,a={role:"user",parts:r},l.contents=e4(l.contents),l.contents.push(t),l.contents.push(a),t9(l.config)&&(c.push(t),c.push(a))}return t9(l.config)&&(o.automaticFunctionCallingHistory=c),o},this.generateContentStream=async e=>{if(this.maybeMoveToResponseJsonSchem(e),!t5(e.config))return await this.processAfcStream(e);{let t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t)}},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let r;let n=[];if(null==e?void 0:e.generatedImages)for(let i of e.generatedImages)i&&(null==i?void 0:i.safetyAttributes)&&(null===(t=null==i?void 0:i.safetyAttributes)||void 0===t?void 0:t.contentType)==="Positive Prompt"?r=null==i?void 0:i.safetyAttributes:n.push(i);return r?{generatedImages:n,positivePromptSafetyAttributes:r,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:n,sdkHttpResponse:e.sdkHttpResponse}}),this.list=async e=>{var t;let r={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!r.config.queryBase){if(null===(t=r.config)||void 0===t?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");r.config.filter="labels.tune-type:*"}return new tf(ee.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(r),r)},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t)},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let r={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(r)},this.generateVideos=async e=>{var t,r,n,i,s,o;if((e.prompt||e.image||e.video)&&e.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null===(t=e.video)||void 0===t?void 0:t.uri)&&(null===(r=e.video)||void 0===r?void 0:r.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null===(i=null===(n=e.source)||void 0===n?void 0:n.video)||void 0===i?void 0:i.uri)&&(null===(o=null===(s=e.source)||void 0===s?void 0:s.video)||void 0===o?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&!e.config.responseJsonSchema&&Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema)}async processParamsMaybeAddMcpUsage(e){var t,r,n;let i=null===(t=e.config)||void 0===t?void 0:t.tools;if(!i)return e;let s=await Promise.all(i.map(async e=>t8(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(o.config.tools=s,e.config&&e.config.tools&&tz(e.config.tools)){let t=Object.assign({},null!==(n=null===(r=e.config.httpOptions)||void 0===r?void 0:r.headers)&&void 0!==n?n:{});0===Object.keys(t).length&&(t=this.apiClient.getDefaultHeaders()),tX(t),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:t})}return o}async initAfcToolsMap(e){var t,r,n;let i=new Map;for(let s of null!==(r=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==r?r:[])if(t8(s))for(let e of null!==(n=(await s.tool()).functionDeclarations)&&void 0!==n?n:[]){if(!e.name)throw Error("Function declaration name is required.");if(i.has(e.name))throw Error(`Duplicate tool declaration name: ${e.name}`);i.set(e.name,s)}return i}async processAfcStream(e){var t,r,n;let i=null!==(n=null===(r=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===r?void 0:r.maximumRemoteCalls)&&void 0!==n?n:10,s=!1,o=0;return function(e,t,r){var n,a;return t_(this,arguments,function*(){for(var l,c,u,d;o<i;){s&&(o++,s=!1);let m=yield tv(e.processParamsMaybeAddMcpUsage(r)),g=yield tv(e.generateContentStreamInternal(m)),y=[],v=[];try{for(var p,h=!0,f=(c=void 0,tE(g));!(l=(p=yield tv(f.next())).done);h=!0)if(d=p.value,h=!1,yield yield tv(d),d.candidates&&(null===(n=d.candidates[0])||void 0===n?void 0:n.content)){for(let e of(v.push(d.candidates[0].content),null!==(a=d.candidates[0].content.parts)&&void 0!==a?a:[]))if(o<i&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let r=yield tv(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...r)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`)}}}catch(e){c={error:e}}finally{try{!h&&!l&&(u=f.return)&&(yield tv(u.call(f)))}finally{if(c)throw c.error}}if(y.length>0){s=!0;let e=new eA;e.candidates=[{content:{role:"user",parts:y}}],yield yield tv(e);let t=[];t.push(...v),t.push({role:"user",parts:y});let n=e4(r.contents).concat(t);r.contents=n}else break}})}(this,await this.initAfcToolsMap(e),e)}async generateContentInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=tk(this.apiClient,e);return s=ev("{model}:generateContent",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=tP(e),r=new eA;return Object.assign(r,t),r})}{let t=tN(this.apiClient,e);return s=ev("{model}:generateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=tR(e),r=new eA;return Object.assign(r,t),r})}}async generateContentStreamInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=tk(this.apiClient,e);return s=ev("{model}:streamGenerateContent?alt=sse",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.requestStream({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(function(e){return t_(this,arguments,function*(){var t,r,n,i;try{for(var s,o=!0,a=tE(e);!(t=(s=yield tv(a.next())).done);o=!0){i=s.value,o=!1;let e=tP((yield tv(i.json())));e.sdkHttpResponse={headers:i.headers};let t=new eA;Object.assign(t,e),yield yield tv(t)}}catch(e){r={error:e}}finally{try{!o&&!t&&(n=a.return)&&(yield tv(n.call(a)))}finally{if(r)throw r.error}}})})}{let t=tN(this.apiClient,e);return s=ev("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.requestStream({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(function(e){return t_(this,arguments,function*(){var t,r,n,i;try{for(var s,o=!0,a=tE(e);!(t=(s=yield tv(a.next())).done);o=!0){i=s.value,o=!1;let e=tR((yield tv(i.json())));e.sdkHttpResponse={headers:i.headers};let t=new eA;Object.assign(t,e),yield yield tv(t)}}catch(e){r={error:e}}finally{try{!o&&!t&&(n=a.return)&&(yield tv(n.call(a)))}finally{if(r)throw r.error}}})})}}async embedContent(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["contents"]);if(null!=i){let t=e2(e,i);Array.isArray(t)&&(t=t.map(e=>e)),e_(r,["instances[]","content"],t)}let s=eE(t,["config"]);return null!=s&&function(e,t){let r=eE(e,["taskType"]);void 0!==t&&null!=r&&e_(t,["instances[]","task_type"],r);let n=eE(e,["title"]);void 0!==t&&null!=n&&e_(t,["instances[]","title"],n);let i=eE(e,["outputDimensionality"]);void 0!==t&&null!=i&&e_(t,["parameters","outputDimensionality"],i);let s=eE(e,["mimeType"]);void 0!==t&&null!=s&&e_(t,["instances[]","mimeType"],s);let o=eE(e,["autoTruncate"]);void 0!==t&&null!=o&&e_(t,["parameters","autoTruncate"],o)}(s,r),r}(this.apiClient,e);return s=ev("{model}:predict",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["predictions[]","embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["values"]);null!=r&&e_(t,["values"],r);let n=eE(e,["statistics"]);return null!=n&&e_(t,["statistics"],function(e){let t={},r=eE(e,["truncated"]);null!=r&&e_(t,["truncated"],r);let n=eE(e,["token_count"]);return null!=n&&e_(t,["tokenCount"],n),t}(n)),t})(e))),e_(t,["embeddings"],e)}let i=eE(e,["metadata"]);return null!=i&&e_(t,["metadata"],i),t}(e),r=new eT;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["contents"]);if(null!=i){let t=e2(e,i);Array.isArray(t)&&(t=t.map(e=>e)),e_(r,["requests[]","content"],t)}let s=eE(t,["config"]);null!=s&&function(e,t){let r=eE(e,["taskType"]);void 0!==t&&null!=r&&e_(t,["requests[]","taskType"],r);let n=eE(e,["title"]);void 0!==t&&null!=n&&e_(t,["requests[]","title"],n);let i=eE(e,["outputDimensionality"]);if(void 0!==t&&null!=i&&e_(t,["requests[]","outputDimensionality"],i),void 0!==eE(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==eE(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(s,r);let o=eE(t,["model"]);return void 0!==o&&e_(r,["requests[]","model"],eV(e,o)),r}(this.apiClient,e);return s=ev("{model}:batchEmbedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["embeddings"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["embeddings"],e)}let i=eE(e,["metadata"]);return null!=i&&e_(t,["metadata"],i),t}(e),r=new eT;return Object.assign(r,t),r})}}async generateImagesInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["prompt"]);null!=i&&e_(r,["instances[0]","prompt"],i);let s=eE(t,["config"]);return null!=s&&function(e,t){let r=eE(e,["outputGcsUri"]);void 0!==t&&null!=r&&e_(t,["parameters","storageUri"],r);let n=eE(e,["negativePrompt"]);void 0!==t&&null!=n&&e_(t,["parameters","negativePrompt"],n);let i=eE(e,["numberOfImages"]);void 0!==t&&null!=i&&e_(t,["parameters","sampleCount"],i);let s=eE(e,["aspectRatio"]);void 0!==t&&null!=s&&e_(t,["parameters","aspectRatio"],s);let o=eE(e,["guidanceScale"]);void 0!==t&&null!=o&&e_(t,["parameters","guidanceScale"],o);let a=eE(e,["seed"]);void 0!==t&&null!=a&&e_(t,["parameters","seed"],a);let l=eE(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&e_(t,["parameters","safetySetting"],l);let c=eE(e,["personGeneration"]);void 0!==t&&null!=c&&e_(t,["parameters","personGeneration"],c);let u=eE(e,["includeSafetyAttributes"]);void 0!==t&&null!=u&&e_(t,["parameters","includeSafetyAttributes"],u);let d=eE(e,["includeRaiReason"]);void 0!==t&&null!=d&&e_(t,["parameters","includeRaiReason"],d);let p=eE(e,["language"]);void 0!==t&&null!=p&&e_(t,["parameters","language"],p);let h=eE(e,["outputMimeType"]);void 0!==t&&null!=h&&e_(t,["parameters","outputOptions","mimeType"],h);let f=eE(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&e_(t,["parameters","outputOptions","compressionQuality"],f);let m=eE(e,["addWatermark"]);void 0!==t&&null!=m&&e_(t,["parameters","addWatermark"],m);let g=eE(e,["labels"]);void 0!==t&&null!=g&&e_(t,["labels"],g);let y=eE(e,["imageSize"]);void 0!==t&&null!=y&&e_(t,["parameters","sampleImageSize"],y);let v=eE(e,["enhancePrompt"]);void 0!==t&&null!=v&&e_(t,["parameters","enhancePrompt"],v)}(s,r),r}(this.apiClient,e);return s=ev("{model}:predict",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>tj(e))),e_(t,["generatedImages"],e)}let i=eE(e,["positivePromptSafetyAttributes"]);return null!=i&&e_(t,["positivePromptSafetyAttributes"],tF(i)),t}(e),r=new eS;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["prompt"]);null!=i&&e_(r,["instances[0]","prompt"],i);let s=eE(t,["config"]);return null!=s&&function(e,t){if(void 0!==eE(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==eE(e,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let r=eE(e,["numberOfImages"]);void 0!==t&&null!=r&&e_(t,["parameters","sampleCount"],r);let n=eE(e,["aspectRatio"]);void 0!==t&&null!=n&&e_(t,["parameters","aspectRatio"],n);let i=eE(e,["guidanceScale"]);if(void 0!==t&&null!=i&&e_(t,["parameters","guidanceScale"],i),void 0!==eE(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let s=eE(e,["safetyFilterLevel"]);void 0!==t&&null!=s&&e_(t,["parameters","safetySetting"],s);let o=eE(e,["personGeneration"]);void 0!==t&&null!=o&&e_(t,["parameters","personGeneration"],o);let a=eE(e,["includeSafetyAttributes"]);void 0!==t&&null!=a&&e_(t,["parameters","includeSafetyAttributes"],a);let l=eE(e,["includeRaiReason"]);void 0!==t&&null!=l&&e_(t,["parameters","includeRaiReason"],l);let c=eE(e,["language"]);void 0!==t&&null!=c&&e_(t,["parameters","language"],c);let u=eE(e,["outputMimeType"]);void 0!==t&&null!=u&&e_(t,["parameters","outputOptions","mimeType"],u);let d=eE(e,["outputCompressionQuality"]);if(void 0!==t&&null!=d&&e_(t,["parameters","outputOptions","compressionQuality"],d),void 0!==eE(e,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==eE(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let p=eE(e,["imageSize"]);if(void 0!==t&&null!=p&&e_(t,["parameters","sampleImageSize"],p),void 0!==eE(e,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(s,r),r}(this.apiClient,e);return s=ev("{model}:predict",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["_self"]);null!=r&&e_(t,["image"],function(e){let t={},r=eE(e,["bytesBase64Encoded"]);null!=r&&e_(t,["imageBytes"],eb(r));let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(r));let n=eE(e,["raiFilteredReason"]);null!=n&&e_(t,["raiFilteredReason"],n);let i=eE(e,["_self"]);return null!=i&&e_(t,["safetyAttributes"],tq(i)),t})(e))),e_(t,["generatedImages"],e)}let i=eE(e,["positivePromptSafetyAttributes"]);return null!=i&&e_(t,["positivePromptSafetyAttributes"],tq(i)),t}(e),r=new eS;return Object.assign(r,t),r})}}async editImageInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["prompt"]);null!=i&&e_(r,["instances[0]","prompt"],i);let s=eE(t,["referenceImages"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["referenceImage"]);null!=r&&e_(t,["referenceImage"],tM(r));let n=eE(e,["referenceId"]);null!=n&&e_(t,["referenceId"],n);let i=eE(e,["referenceType"]);null!=i&&e_(t,["referenceType"],i);let s=eE(e,["maskImageConfig"]);null!=s&&e_(t,["maskImageConfig"],function(e){let t={},r=eE(e,["maskMode"]);null!=r&&e_(t,["maskMode"],r);let n=eE(e,["segmentationClasses"]);null!=n&&e_(t,["maskClasses"],n);let i=eE(e,["maskDilation"]);return null!=i&&e_(t,["dilation"],i),t}(s));let o=eE(e,["controlImageConfig"]);null!=o&&e_(t,["controlImageConfig"],function(e){let t={},r=eE(e,["controlType"]);null!=r&&e_(t,["controlType"],r);let n=eE(e,["enableControlImageComputation"]);return null!=n&&e_(t,["computeControl"],n),t}(o));let a=eE(e,["styleImageConfig"]);null!=a&&e_(t,["styleImageConfig"],a);let l=eE(e,["subjectImageConfig"]);return null!=l&&e_(t,["subjectImageConfig"],l),t})(e))),e_(r,["instances[0]","referenceImages"],e)}let o=eE(t,["config"]);return null!=o&&function(e,t){let r=eE(e,["outputGcsUri"]);void 0!==t&&null!=r&&e_(t,["parameters","storageUri"],r);let n=eE(e,["negativePrompt"]);void 0!==t&&null!=n&&e_(t,["parameters","negativePrompt"],n);let i=eE(e,["numberOfImages"]);void 0!==t&&null!=i&&e_(t,["parameters","sampleCount"],i);let s=eE(e,["aspectRatio"]);void 0!==t&&null!=s&&e_(t,["parameters","aspectRatio"],s);let o=eE(e,["guidanceScale"]);void 0!==t&&null!=o&&e_(t,["parameters","guidanceScale"],o);let a=eE(e,["seed"]);void 0!==t&&null!=a&&e_(t,["parameters","seed"],a);let l=eE(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&e_(t,["parameters","safetySetting"],l);let c=eE(e,["personGeneration"]);void 0!==t&&null!=c&&e_(t,["parameters","personGeneration"],c);let u=eE(e,["includeSafetyAttributes"]);void 0!==t&&null!=u&&e_(t,["parameters","includeSafetyAttributes"],u);let d=eE(e,["includeRaiReason"]);void 0!==t&&null!=d&&e_(t,["parameters","includeRaiReason"],d);let p=eE(e,["language"]);void 0!==t&&null!=p&&e_(t,["parameters","language"],p);let h=eE(e,["outputMimeType"]);void 0!==t&&null!=h&&e_(t,["parameters","outputOptions","mimeType"],h);let f=eE(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&e_(t,["parameters","outputOptions","compressionQuality"],f);let m=eE(e,["addWatermark"]);void 0!==t&&null!=m&&e_(t,["parameters","addWatermark"],m);let g=eE(e,["labels"]);void 0!==t&&null!=g&&e_(t,["labels"],g);let y=eE(e,["editMode"]);void 0!==t&&null!=y&&e_(t,["parameters","editMode"],y);let v=eE(e,["baseSteps"]);void 0!==t&&null!=v&&e_(t,["parameters","editConfig","baseSteps"],v)}(o,r),r}(this.apiClient,e);return n=ev("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>tj(e))),e_(t,["generatedImages"],e)}return t}(e),r=new eC;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["image"]);null!=i&&e_(r,["instances[0]","image"],tM(i));let s=eE(t,["upscaleFactor"]);null!=s&&e_(r,["parameters","upscaleConfig","upscaleFactor"],s);let o=eE(t,["config"]);return null!=o&&function(e,t){let r=eE(e,["outputGcsUri"]);void 0!==t&&null!=r&&e_(t,["parameters","storageUri"],r);let n=eE(e,["includeRaiReason"]);void 0!==t&&null!=n&&e_(t,["parameters","includeRaiReason"],n);let i=eE(e,["outputMimeType"]);void 0!==t&&null!=i&&e_(t,["parameters","outputOptions","mimeType"],i);let s=eE(e,["outputCompressionQuality"]);void 0!==t&&null!=s&&e_(t,["parameters","outputOptions","compressionQuality"],s);let o=eE(e,["enhanceInputImage"]);void 0!==t&&null!=o&&e_(t,["parameters","upscaleConfig","enhanceInputImage"],o);let a=eE(e,["imagePreservationFactor"]);void 0!==t&&null!=a&&e_(t,["parameters","upscaleConfig","imagePreservationFactor"],a);let l=eE(e,["labels"]);void 0!==t&&null!=l&&e_(t,["labels"],l);let c=eE(e,["numberOfImages"]);void 0!==t&&null!=c&&e_(t,["parameters","sampleCount"],c);let u=eE(e,["mode"]);void 0!==t&&null!=u&&e_(t,["parameters","mode"],u)}(o,r),r}(this.apiClient,e);return n=ev("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>tj(e))),e_(t,["generatedImages"],e)}return t}(e),r=new ew;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["source"]);null!=i&&function(e,t){let r=eE(e,["prompt"]);void 0!==t&&null!=r&&e_(t,["instances[0]","prompt"],r);let n=eE(e,["personImage"]);void 0!==t&&null!=n&&e_(t,["instances[0]","personImage","image"],tM(n));let i=eE(e,["productImages"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["productImage"]);return null!=r&&e_(t,["image"],tM(r)),t})(e))),e_(t,["instances[0]","productImages"],e)}}(i,r);let s=eE(t,["config"]);return null!=s&&function(e,t){let r=eE(e,["numberOfImages"]);void 0!==t&&null!=r&&e_(t,["parameters","sampleCount"],r);let n=eE(e,["baseSteps"]);void 0!==t&&null!=n&&e_(t,["parameters","editConfig","baseSteps"],n);let i=eE(e,["outputGcsUri"]);void 0!==t&&null!=i&&e_(t,["parameters","storageUri"],i);let s=eE(e,["seed"]);void 0!==t&&null!=s&&e_(t,["parameters","seed"],s);let o=eE(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&e_(t,["parameters","safetySetting"],o);let a=eE(e,["personGeneration"]);void 0!==t&&null!=a&&e_(t,["parameters","personGeneration"],a);let l=eE(e,["addWatermark"]);void 0!==t&&null!=l&&e_(t,["parameters","addWatermark"],l);let c=eE(e,["outputMimeType"]);void 0!==t&&null!=c&&e_(t,["parameters","outputOptions","mimeType"],c);let u=eE(e,["outputCompressionQuality"]);void 0!==t&&null!=u&&e_(t,["parameters","outputOptions","compressionQuality"],u);let d=eE(e,["enhancePrompt"]);void 0!==t&&null!=d&&e_(t,["parameters","enhancePrompt"],d);let p=eE(e,["labels"]);void 0!==t&&null!=p&&e_(t,["labels"],p)}(s,r),r}(this.apiClient,e);return n=ev("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=eE(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>tj(e))),e_(t,["generatedImages"],e)}return t}(e),r=new eO;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["source"]);null!=i&&function(e,t){let r=eE(e,["prompt"]);void 0!==t&&null!=r&&e_(t,["instances[0]","prompt"],r);let n=eE(e,["image"]);void 0!==t&&null!=n&&e_(t,["instances[0]","image"],tM(n));let i=eE(e,["scribbleImage"]);void 0!==t&&null!=i&&e_(t,["instances[0]","scribble"],function(e){let t={},r=eE(e,["image"]);return null!=r&&e_(t,["image"],tM(r)),t}(i))}(i,r);let s=eE(t,["config"]);return null!=s&&function(e,t){let r=eE(e,["mode"]);void 0!==t&&null!=r&&e_(t,["parameters","mode"],r);let n=eE(e,["maxPredictions"]);void 0!==t&&null!=n&&e_(t,["parameters","maxPredictions"],n);let i=eE(e,["confidenceThreshold"]);void 0!==t&&null!=i&&e_(t,["parameters","confidenceThreshold"],i);let s=eE(e,["maskDilation"]);void 0!==t&&null!=s&&e_(t,["parameters","maskDilation"],s);let o=eE(e,["binaryColorThreshold"]);void 0!==t&&null!=o&&e_(t,["parameters","binaryColorThreshold"],o);let a=eE(e,["labels"]);void 0!==t&&null!=a&&e_(t,["labels"],a)}(s,r),r}(this.apiClient,e);return n=ev("{model}:predict",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=eE(e,["predictions"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["_self"]);null!=r&&e_(t,["mask"],tD(r));let n=eE(e,["labels"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["labels"],e)}return t})(e))),e_(t,["generatedMasks"],e)}return t}(e),r=new eI;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);return null!=n&&e_(r,["_url","name"],eV(e,n)),r}(this.apiClient,e);return s=ev("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>tG(e))}{let t=function(e,t){let r={},n=eE(t,["model"]);return null!=n&&e_(r,["_url","name"],eV(e,n)),r}(this.apiClient,e);return s=ev("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tL(e))}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["config"]);return null!=n&&function(e,t,r){let n=eE(t,["pageSize"]);void 0!==r&&null!=n&&e_(r,["_query","pageSize"],n);let i=eE(t,["pageToken"]);void 0!==r&&null!=i&&e_(r,["_query","pageToken"],i);let s=eE(t,["filter"]);void 0!==r&&null!=s&&e_(r,["_query","filter"],s);let o=eE(t,["queryBase"]);void 0!==r&&null!=o&&e_(r,["_url","models_url"],ti(e,o))}(e,n,r),r}(this.apiClient,e);return s=ev("{models_url}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["nextPageToken"]);null!=n&&e_(t,["nextPageToken"],n);let i=eE(e,["_self"]);if(null!=i){let e=ts(i);Array.isArray(e)&&(e=e.map(e=>tG(e))),e_(t,["models"],e)}return t}(e),r=new eN;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=eE(t,["config"]);return null!=n&&function(e,t,r){let n=eE(t,["pageSize"]);void 0!==r&&null!=n&&e_(r,["_query","pageSize"],n);let i=eE(t,["pageToken"]);void 0!==r&&null!=i&&e_(r,["_query","pageToken"],i);let s=eE(t,["filter"]);void 0!==r&&null!=s&&e_(r,["_query","filter"],s);let o=eE(t,["queryBase"]);void 0!==r&&null!=o&&e_(r,["_url","models_url"],ti(e,o))}(e,n,r),r}(this.apiClient,e);return s=ev("{models_url}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["nextPageToken"]);null!=n&&e_(t,["nextPageToken"],n);let i=eE(e,["_self"]);if(null!=i){let e=ts(i);Array.isArray(e)&&(e=e.map(e=>tL(e))),e_(t,["models"],e)}return t}(e),r=new eN;return Object.assign(r,t),r})}}async update(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["config"]);return null!=i&&function(e,t){let r=eE(e,["displayName"]);void 0!==t&&null!=r&&e_(t,["displayName"],r);let n=eE(e,["description"]);void 0!==t&&null!=n&&e_(t,["description"],n);let i=eE(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&e_(t,["defaultCheckpointId"],i)}(i,r),r}(this.apiClient,e);return s=ev("{model}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>tG(e))}{let t=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","name"],eV(e,n));let i=eE(t,["config"]);return null!=i&&function(e,t){let r=eE(e,["displayName"]);void 0!==t&&null!=r&&e_(t,["displayName"],r);let n=eE(e,["description"]);void 0!==t&&null!=n&&e_(t,["description"],n);let i=eE(e,["defaultCheckpointId"]);void 0!==t&&null!=i&&e_(t,["defaultCheckpointId"],i)}(i,r),r}(this.apiClient,e);return s=ev("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>tL(e))}}async delete(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);return null!=n&&e_(r,["_url","name"],eV(e,n)),r}(this.apiClient,e);return s=ev("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);return null!=r&&e_(t,["sdkHttpResponse"],r),t}(e),r=new ek;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=eE(t,["model"]);return null!=n&&e_(r,["_url","name"],eV(e,n)),r}(this.apiClient,e);return s=ev("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);return null!=r&&e_(t,["sdkHttpResponse"],r),t}(e),r=new ek;return Object.assign(r,t),r})}}async countTokens(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["contents"]);if(null!=i){let e=e4(i);Array.isArray(e)&&(e=e.map(e=>e)),e_(r,["contents"],e)}let s=eE(t,["config"]);return null!=s&&function(e,t){let r=eE(e,["systemInstruction"]);void 0!==t&&null!=r&&e_(t,["systemInstruction"],e1(r));let n=eE(e,["tools"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>tH(e))),e_(t,["tools"],e)}let i=eE(e,["generationConfig"]);void 0!==t&&null!=i&&e_(t,["generationConfig"],function(e){let t={},r=eE(e,["modelSelectionConfig"]);null!=r&&e_(t,["modelConfig"],r);let n=eE(e,["audioTimestamp"]);null!=n&&e_(t,["audioTimestamp"],n);let i=eE(e,["candidateCount"]);null!=i&&e_(t,["candidateCount"],i);let s=eE(e,["enableAffectiveDialog"]);null!=s&&e_(t,["enableAffectiveDialog"],s);let o=eE(e,["frequencyPenalty"]);null!=o&&e_(t,["frequencyPenalty"],o);let a=eE(e,["logprobs"]);null!=a&&e_(t,["logprobs"],a);let l=eE(e,["maxOutputTokens"]);null!=l&&e_(t,["maxOutputTokens"],l);let c=eE(e,["mediaResolution"]);null!=c&&e_(t,["mediaResolution"],c);let u=eE(e,["presencePenalty"]);null!=u&&e_(t,["presencePenalty"],u);let d=eE(e,["responseJsonSchema"]);null!=d&&e_(t,["responseJsonSchema"],d);let p=eE(e,["responseLogprobs"]);null!=p&&e_(t,["responseLogprobs"],p);let h=eE(e,["responseMimeType"]);null!=h&&e_(t,["responseMimeType"],h);let f=eE(e,["responseModalities"]);null!=f&&e_(t,["responseModalities"],f);let m=eE(e,["responseSchema"]);null!=m&&e_(t,["responseSchema"],m);let g=eE(e,["routingConfig"]);null!=g&&e_(t,["routingConfig"],g);let y=eE(e,["seed"]);null!=y&&e_(t,["seed"],y);let v=eE(e,["speechConfig"]);null!=v&&e_(t,["speechConfig"],tB(v));let _=eE(e,["stopSequences"]);null!=_&&e_(t,["stopSequences"],_);let E=eE(e,["temperature"]);null!=E&&e_(t,["temperature"],E);let b=eE(e,["thinkingConfig"]);null!=b&&e_(t,["thinkingConfig"],b);let x=eE(e,["topK"]);null!=x&&e_(t,["topK"],x);let A=eE(e,["topP"]);if(null!=A&&e_(t,["topP"],A),void 0!==eE(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}(i))}(s,r),r}(this.apiClient,e);return s=ev("{model}:countTokens",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["totalTokens"]);return null!=n&&e_(t,["totalTokens"],n),t}(e),r=new eR;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["contents"]);if(null!=i){let e=e4(i);Array.isArray(e)&&(e=e.map(e=>tI(e))),e_(r,["contents"],e)}let s=eE(t,["config"]);return null!=s&&function(e){if(void 0!==eE(e,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==eE(e,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==eE(e,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(s),r}(this.apiClient,e);return s=ev("{model}:countTokens",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["totalTokens"]);null!=n&&e_(t,["totalTokens"],n);let i=eE(e,["cachedContentTokenCount"]);return null!=i&&e_(t,["cachedContentTokenCount"],i),t}(e),r=new eR;return Object.assign(r,t),r})}}async computeTokens(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["contents"]);if(null!=i){let e=e4(i);Array.isArray(e)&&(e=e.map(e=>e)),e_(r,["contents"],e)}return r}(this.apiClient,e);return n=ev("{model}:computeTokens",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},r=eE(e,["sdkHttpResponse"]);null!=r&&e_(t,["sdkHttpResponse"],r);let n=eE(e,["tokensInfo"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["tokensInfo"],e)}return t}(e),r=new eP;return Object.assign(r,t),r})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["prompt"]);null!=i&&e_(r,["instances[0]","prompt"],i);let s=eE(t,["image"]);null!=s&&e_(r,["instances[0]","image"],tM(s));let o=eE(t,["video"]);null!=o&&e_(r,["instances[0]","video"],t$(o));let a=eE(t,["source"]);null!=a&&function(e,t){let r=eE(e,["prompt"]);void 0!==t&&null!=r&&e_(t,["instances[0]","prompt"],r);let n=eE(e,["image"]);void 0!==t&&null!=n&&e_(t,["instances[0]","image"],tM(n));let i=eE(e,["video"]);void 0!==t&&null!=i&&e_(t,["instances[0]","video"],t$(i))}(a,r);let l=eE(t,["config"]);return null!=l&&function(e,t){let r=eE(e,["numberOfVideos"]);void 0!==t&&null!=r&&e_(t,["parameters","sampleCount"],r);let n=eE(e,["outputGcsUri"]);void 0!==t&&null!=n&&e_(t,["parameters","storageUri"],n);let i=eE(e,["fps"]);void 0!==t&&null!=i&&e_(t,["parameters","fps"],i);let s=eE(e,["durationSeconds"]);void 0!==t&&null!=s&&e_(t,["parameters","durationSeconds"],s);let o=eE(e,["seed"]);void 0!==t&&null!=o&&e_(t,["parameters","seed"],o);let a=eE(e,["aspectRatio"]);void 0!==t&&null!=a&&e_(t,["parameters","aspectRatio"],a);let l=eE(e,["resolution"]);void 0!==t&&null!=l&&e_(t,["parameters","resolution"],l);let c=eE(e,["personGeneration"]);void 0!==t&&null!=c&&e_(t,["parameters","personGeneration"],c);let u=eE(e,["pubsubTopic"]);void 0!==t&&null!=u&&e_(t,["parameters","pubsubTopic"],u);let d=eE(e,["negativePrompt"]);void 0!==t&&null!=d&&e_(t,["parameters","negativePrompt"],d);let p=eE(e,["enhancePrompt"]);void 0!==t&&null!=p&&e_(t,["parameters","enhancePrompt"],p);let h=eE(e,["generateAudio"]);void 0!==t&&null!=h&&e_(t,["parameters","generateAudio"],h);let f=eE(e,["lastFrame"]);void 0!==t&&null!=f&&e_(t,["instances[0]","lastFrame"],tM(f));let m=eE(e,["referenceImages"]);if(void 0!==t&&null!=m){let e=m;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["image"]);null!=r&&e_(t,["image"],tM(r));let n=eE(e,["referenceType"]);return null!=n&&e_(t,["referenceType"],n),t})(e))),e_(t,["instances[0]","referenceImages"],e)}let g=eE(e,["mask"]);void 0!==t&&null!=g&&e_(t,["instances[0]","mask"],function(e){let t={},r=eE(e,["image"]);null!=r&&e_(t,["_self"],tM(r));let n=eE(e,["maskMode"]);return null!=n&&e_(t,["maskMode"],n),t}(g));let y=eE(e,["compressionQuality"]);void 0!==t&&null!=y&&e_(t,["parameters","compressionQuality"],y)}(l,r),r}(this.apiClient,e);return s=ev("{model}:predictLongRunning",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=eE(e,["name"]);null!=r&&e_(t,["name"],r);let n=eE(e,["metadata"]);null!=n&&e_(t,["metadata"],n);let i=eE(e,["done"]);null!=i&&e_(t,["done"],i);let s=eE(e,["error"]);null!=s&&e_(t,["error"],s);let o=eE(e,["response"]);return null!=o&&e_(t,["response"],function(e){let t={},r=eE(e,["videos"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["_self"]);return null!=r&&e_(t,["video"],function(e){let t={},r=eE(e,["gcsUri"]);null!=r&&e_(t,["uri"],r);let n=eE(e,["bytesBase64Encoded"]);null!=n&&e_(t,["videoBytes"],eb(n));let i=eE(e,["mimeType"]);return null!=i&&e_(t,["mimeType"],i),t}(r)),t})(e))),e_(t,["generatedVideos"],e)}let n=eE(e,["raiMediaFilteredCount"]);null!=n&&e_(t,["raiMediaFilteredCount"],n);let i=eE(e,["raiMediaFilteredReasons"]);return null!=i&&e_(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e),r=new ej;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["_url","model"],eV(e,n));let i=eE(t,["prompt"]);null!=i&&e_(r,["instances[0]","prompt"],i);let s=eE(t,["image"]);null!=s&&e_(r,["instances[0]","image"],tU(s));let o=eE(t,["video"]);null!=o&&e_(r,["instances[0]","video"],tV(o));let a=eE(t,["source"]);null!=a&&function(e,t){let r=eE(e,["prompt"]);void 0!==t&&null!=r&&e_(t,["instances[0]","prompt"],r);let n=eE(e,["image"]);void 0!==t&&null!=n&&e_(t,["instances[0]","image"],tU(n));let i=eE(e,["video"]);void 0!==t&&null!=i&&e_(t,["instances[0]","video"],tV(i))}(a,r);let l=eE(t,["config"]);return null!=l&&function(e,t){let r=eE(e,["numberOfVideos"]);if(void 0!==t&&null!=r&&e_(t,["parameters","sampleCount"],r),void 0!==eE(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==eE(e,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let n=eE(e,["durationSeconds"]);if(void 0!==t&&null!=n&&e_(t,["parameters","durationSeconds"],n),void 0!==eE(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let i=eE(e,["aspectRatio"]);void 0!==t&&null!=i&&e_(t,["parameters","aspectRatio"],i);let s=eE(e,["resolution"]);void 0!==t&&null!=s&&e_(t,["parameters","resolution"],s);let o=eE(e,["personGeneration"]);if(void 0!==t&&null!=o&&e_(t,["parameters","personGeneration"],o),void 0!==eE(e,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let a=eE(e,["negativePrompt"]);void 0!==t&&null!=a&&e_(t,["parameters","negativePrompt"],a);let l=eE(e,["enhancePrompt"]);if(void 0!==t&&null!=l&&e_(t,["parameters","enhancePrompt"],l),void 0!==eE(e,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let c=eE(e,["lastFrame"]);void 0!==t&&null!=c&&e_(t,["instances[0]","lastFrame"],tU(c));let u=eE(e,["referenceImages"]);if(void 0!==t&&null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["image"]);null!=r&&e_(t,["image"],tU(r));let n=eE(e,["referenceType"]);return null!=n&&e_(t,["referenceType"],n),t})(e))),e_(t,["instances[0]","referenceImages"],e)}if(void 0!==eE(e,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==eE(e,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(l,r),r}(this.apiClient,e);return s=ev("{model}:predictLongRunning",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},r=eE(e,["name"]);null!=r&&e_(t,["name"],r);let n=eE(e,["metadata"]);null!=n&&e_(t,["metadata"],n);let i=eE(e,["done"]);null!=i&&e_(t,["done"],i);let s=eE(e,["error"]);null!=s&&e_(t,["error"],s);let o=eE(e,["response","generateVideoResponse"]);return null!=o&&e_(t,["response"],function(e){let t={},r=eE(e,["generatedSamples"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["video"]);return null!=r&&e_(t,["video"],function(e){let t={},r=eE(e,["uri"]);null!=r&&e_(t,["uri"],r);let n=eE(e,["encodedVideo"]);null!=n&&e_(t,["videoBytes"],eb(n));let i=eE(e,["encoding"]);return null!=i&&e_(t,["mimeType"],i),t}(r)),t})(e))),e_(t,["generatedVideos"],e)}let n=eE(e,["raiMediaFilteredCount"]);null!=n&&e_(t,["raiMediaFilteredCount"],n);let i=eE(e,["raiMediaFilteredReasons"]);return null!=i&&e_(t,["raiMediaFilteredReasons"],i),t}(o)),t}(e),r=new ej;return Object.assign(r,t),r})}}}class re extends ey{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){let t=e.operation,r=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e;let n=t.name.split("/operations/")[0];r&&"httpOptions"in r&&(e=r.httpOptions);let i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:n,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:i,isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:e,isVertexAI:!1})}}async get(e){let t=e.operation,r=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e;let n=t.name.split("/operations/")[0];r&&"httpOptions"in r&&(e=r.httpOptions);let i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:n,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:i,isVertexAI:!0})}{let e=await this.getVideosOperationInternal({operationName:t.name,config:r});return t._fromAPIResponse({apiResponse:e,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e){let t={},r=eE(e,["operationName"]);return null!=r&&e_(t,["_url","operationName"],r),t}(e);return s=ev("{operationName}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json())}{let t=function(e){let t={},r=eE(e,["operationName"]);return null!=r&&e_(t,["_url","operationName"],r),t}(e);return s=ev("{operationName}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json())}}async fetchPredictVideosOperationInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e){let t={},r=eE(e,["operationName"]);null!=r&&e_(t,["operationName"],r);let n=eE(e,["resourceName"]);return null!=n&&e_(t,["_url","resourceName"],n),t}(e);return n=ev("{resourceName}:fetchPredictOperation",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json())}throw Error("This method is only supported by the Vertex AI.")}}class rt extends ey{constructor(e){super(),this.apiClient=e}async create(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let s=function(e,t){let r={},n=eE(t,["config"]);return null!=n&&e_(r,["config"],function(e,t,r){let n=eE(t,["expireTime"]);void 0!==r&&null!=n&&e_(r,["expireTime"],n);let i=eE(t,["newSessionExpireTime"]);void 0!==r&&null!=i&&e_(r,["newSessionExpireTime"],i);let s=eE(t,["uses"]);void 0!==r&&null!=s&&e_(r,["uses"],s);let o=eE(t,["liveConnectConstraints"]);void 0!==r&&null!=o&&e_(r,["bidiGenerateContentSetup"],function(e,t){let r={},n=eE(t,["model"]);null!=n&&e_(r,["setup","model"],eV(e,n));let i=eE(t,["config"]);return null!=i&&e_(r,["config"],function(e,t){let r=eE(e,["generationConfig"]);void 0!==t&&null!=r&&e_(t,["setup","generationConfig"],r);let n=eE(e,["responseModalities"]);void 0!==t&&null!=n&&e_(t,["setup","generationConfig","responseModalities"],n);let i=eE(e,["temperature"]);void 0!==t&&null!=i&&e_(t,["setup","generationConfig","temperature"],i);let s=eE(e,["topP"]);void 0!==t&&null!=s&&e_(t,["setup","generationConfig","topP"],s);let o=eE(e,["topK"]);void 0!==t&&null!=o&&e_(t,["setup","generationConfig","topK"],o);let a=eE(e,["maxOutputTokens"]);void 0!==t&&null!=a&&e_(t,["setup","generationConfig","maxOutputTokens"],a);let l=eE(e,["mediaResolution"]);void 0!==t&&null!=l&&e_(t,["setup","generationConfig","mediaResolution"],l);let c=eE(e,["seed"]);void 0!==t&&null!=c&&e_(t,["setup","generationConfig","seed"],c);let u=eE(e,["speechConfig"]);void 0!==t&&null!=u&&e_(t,["setup","generationConfig","speechConfig"],e5(u));let d=eE(e,["thinkingConfig"]);void 0!==t&&null!=d&&e_(t,["setup","generationConfig","thinkingConfig"],d);let p=eE(e,["enableAffectiveDialog"]);void 0!==t&&null!=p&&e_(t,["setup","generationConfig","enableAffectiveDialog"],p);let h=eE(e,["systemInstruction"]);void 0!==t&&null!=h&&e_(t,["setup","systemInstruction"],function(e){let t={},r=eE(e,["parts"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["videoMetadata"]);null!=r&&e_(t,["videoMetadata"],r);let n=eE(e,["thought"]);null!=n&&e_(t,["thought"],n);let i=eE(e,["inlineData"]);null!=i&&e_(t,["inlineData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["data"]);null!=r&&e_(t,["data"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(i));let s=eE(e,["fileData"]);null!=s&&e_(t,["fileData"],function(e){let t={};if(void 0!==eE(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let r=eE(e,["fileUri"]);null!=r&&e_(t,["fileUri"],r);let n=eE(e,["mimeType"]);return null!=n&&e_(t,["mimeType"],n),t}(s));let o=eE(e,["thoughtSignature"]);null!=o&&e_(t,["thoughtSignature"],o);let a=eE(e,["functionCall"]);null!=a&&e_(t,["functionCall"],a);let l=eE(e,["codeExecutionResult"]);null!=l&&e_(t,["codeExecutionResult"],l);let c=eE(e,["executableCode"]);null!=c&&e_(t,["executableCode"],c);let u=eE(e,["functionResponse"]);null!=u&&e_(t,["functionResponse"],u);let d=eE(e,["text"]);return null!=d&&e_(t,["text"],d),t})(e))),e_(t,["parts"],e)}let n=eE(e,["role"]);return null!=n&&e_(t,["role"],n),t}(e1(h)));let f=eE(e,["tools"]);if(void 0!==t&&null!=f){let e=e9(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},r=eE(e,["functionDeclarations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),e_(t,["functionDeclarations"],e)}if(void 0!==eE(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let n=eE(e,["googleSearch"]);null!=n&&e_(t,["googleSearch"],function(e){let t={},r=eE(e,["timeRangeFilter"]);if(null!=r&&e_(t,["timeRangeFilter"],r),void 0!==eE(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");return t}(n));let i=eE(e,["googleSearchRetrieval"]);if(null!=i&&e_(t,["googleSearchRetrieval"],i),void 0!==eE(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=eE(e,["googleMaps"]);null!=s&&e_(t,["googleMaps"],function(e){let t={};if(void 0!==eE(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let r=eE(e,["enableWidget"]);return null!=r&&e_(t,["enableWidget"],r),t}(s));let o=eE(e,["urlContext"]);null!=o&&e_(t,["urlContext"],o);let a=eE(e,["computerUse"]);null!=a&&e_(t,["computerUse"],a);let l=eE(e,["codeExecution"]);return null!=l&&e_(t,["codeExecution"],l),t})(e8(e)))),e_(t,["setup","tools"],e)}let m=eE(e,["sessionResumption"]);void 0!==t&&null!=m&&e_(t,["setup","sessionResumption"],function(e){let t={},r=eE(e,["handle"]);if(null!=r&&e_(t,["handle"],r),void 0!==eE(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t}(m));let g=eE(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&e_(t,["setup","inputAudioTranscription"],g);let y=eE(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&e_(t,["setup","outputAudioTranscription"],y);let v=eE(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&e_(t,["setup","realtimeInputConfig"],v);let _=eE(e,["contextWindowCompression"]);void 0!==t&&null!=_&&e_(t,["setup","contextWindowCompression"],_);let E=eE(e,["proactivity"]);return void 0!==t&&null!=E&&e_(t,["setup","proactivity"],E),{}}(i,r)),r}(e,o));let a=eE(t,["lockAdditionalFields"]);return void 0!==r&&null!=a&&e_(r,["fieldMask"],a),{}}(e,n,r)),r}(this.apiClient,e);n=ev("auth_tokens",s._url),i=s._query,delete s.config,delete s._url,delete s._query;let o=function(e,t){let r=null,n=e.bidiGenerateContentSetup;if("object"==typeof n&&null!==n&&"setup"in n){let t=n.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,r=t):delete e.bidiGenerateContentSetup}else void 0!==n&&delete e.bidiGenerateContentSetup;let i=e.fieldMask;if(r){let n=function(e){let t=[];for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let n=e[r];if("object"==typeof n&&null!=n&&Object.keys(n).length>0){let e=Object.keys(n).map(e=>`${r}.${e}`);t.push(...e)}else t.push(r)}return t.join(",")}(r);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)n?e.fieldMask=n:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==i&&Array.isArray(i)&&i.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],r=[];i.length>0&&(r=i.map(e=>t.includes(e)?`generationConfig.${e}`:e));let s=[];n&&s.push(n),r.length>0&&s.push(...r),s.length>0?e.fieldMask=s.join(","):delete e.fieldMask}else delete e.fieldMask}else null!==i&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}(s,e.config);return this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e)}}}let rr="x-goog-api-key",rn="https://www.googleapis.com/auth/cloud-platform";class ri{constructor(e){if(void 0!==e.apiKey){this.apiKey=e.apiKey;return}let t=function(e){if(!e)return{scopes:[rn]};if(e.scopes){if("string"==typeof e.scopes&&e.scopes!==rn||Array.isArray(e.scopes)&&0>e.scopes.indexOf(rn))throw Error(`Invalid auth scopes. Scopes must include: ${rn}`)}else e.scopes=[rn];return e}(e.googleAuthOptions);this.googleAuth=new ep.eE(t)}async addAuthHeaders(e,t){if(void 0!==this.apiKey){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");this.addKeyHeader(e);return}return this.addGoogleAuthHeaders(e,t)}addKeyHeader(e){if(null===e.get(rr)){if(void 0===this.apiKey)throw Error("Trying to set API key header but apiKey is not set");e.append(rr,this.apiKey)}}async addGoogleAuthHeaders(e,t){if(void 0===this.googleAuth)throw Error("Trying to set google-auth headers but googleAuth is unset");for(let[r,n]of(await this.googleAuth.getRequestHeaders(t)))null===e.get(r)&&e.append(r,n)}}class rs{async download(e,t){if(e.downloadPath){let r=await ro(e,t);if(r instanceof ex){let t=(0,eh.createWriteStream)(e.downloadPath);ef.Readable.fromWeb(r.responseInternal.body).pipe(t)}else(0,eh.writeFile)(e.downloadPath,r,{encoding:"base64"},t=>{if(t)throw Error(`Failed to write file to ${e.downloadPath}: ${t}`)})}}}async function ro(e,t){var r,n,i;let s=tn(e.file);if(void 0!==s)return await t.request({path:`files/${s}:download`,httpMethod:"GET",queryParams:{alt:"media"},httpOptions:null===(r=e.config)||void 0===r?void 0:r.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal});if(tt(e.file)){let t=null===(i=e.file.video)||void 0===i?void 0:i.videoBytes;if("string"==typeof t)return t;throw Error("Failed to download generated video, Uri or videoBytes not found.")}if(tr(e.file)){let t=e.file.videoBytes;if("string"==typeof t)return t;throw Error("Failed to download video, Uri or videoBytes not found.")}throw Error("Unsupported file type")}class ra{create(e,t,r){return new rl(e,t,r)}}class rl{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new em(this.url,{headers:this.headers}),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}function rc(e,t){let r={},n=eE(e,["sdkHttpResponse"]);null!=n&&e_(r,["sdkHttpResponse"],n);let i=eE(e,["name"]);null!=i&&e_(r,["name"],i);let s=eE(e,["state"]);null!=s&&e_(r,["state"],te(s));let o=eE(e,["createTime"]);null!=o&&e_(r,["createTime"],o);let a=eE(e,["tuningTask","startTime"]);null!=a&&e_(r,["startTime"],a);let l=eE(e,["tuningTask","completeTime"]);null!=l&&e_(r,["endTime"],l);let c=eE(e,["updateTime"]);null!=c&&e_(r,["updateTime"],c);let u=eE(e,["description"]);null!=u&&e_(r,["description"],u);let d=eE(e,["baseModel"]);null!=d&&e_(r,["baseModel"],d);let p=eE(e,["_self"]);return null!=p&&e_(r,["tunedModel"],function(e,t){let r={},n=eE(e,["name"]);null!=n&&e_(r,["model"],n);let i=eE(e,["name"]);return null!=i&&e_(r,["endpoint"],i),r}(p)),r}function ru(e,t){let r={},n=eE(e,["sdkHttpResponse"]);null!=n&&e_(r,["sdkHttpResponse"],n);let i=eE(e,["name"]);null!=i&&e_(r,["name"],i);let s=eE(e,["state"]);null!=s&&e_(r,["state"],te(s));let o=eE(e,["createTime"]);null!=o&&e_(r,["createTime"],o);let a=eE(e,["startTime"]);null!=a&&e_(r,["startTime"],a);let l=eE(e,["endTime"]);null!=l&&e_(r,["endTime"],l);let c=eE(e,["updateTime"]);null!=c&&e_(r,["updateTime"],c);let u=eE(e,["error"]);null!=u&&e_(r,["error"],u);let d=eE(e,["description"]);null!=d&&e_(r,["description"],d);let p=eE(e,["baseModel"]);null!=p&&e_(r,["baseModel"],p);let h=eE(e,["tunedModel"]);null!=h&&e_(r,["tunedModel"],h);let f=eE(e,["preTunedModel"]);null!=f&&e_(r,["preTunedModel"],f);let m=eE(e,["supervisedTuningSpec"]);null!=m&&e_(r,["supervisedTuningSpec"],m);let g=eE(e,["tuningDataStats"]);null!=g&&e_(r,["tuningDataStats"],g);let y=eE(e,["encryptionSpec"]);null!=y&&e_(r,["encryptionSpec"],y);let v=eE(e,["partnerModelTuningSpec"]);null!=v&&e_(r,["partnerModelTuningSpec"],v);let _=eE(e,["customBaseModel"]);null!=_&&e_(r,["customBaseModel"],_);let E=eE(e,["experiment"]);null!=E&&e_(r,["experiment"],E);let b=eE(e,["labels"]);null!=b&&e_(r,["labels"],b);let x=eE(e,["outputUri"]);null!=x&&e_(r,["outputUri"],x);let A=eE(e,["pipelineJob"]);null!=A&&e_(r,["pipelineJob"],A);let T=eE(e,["serviceAccount"]);null!=T&&e_(r,["serviceAccount"],T);let S=eE(e,["tunedModelDisplayName"]);null!=S&&e_(r,["tunedModelDisplayName"],S);let C=eE(e,["veoTuningSpec"]);return null!=C&&e_(r,["veoTuningSpec"],C),r}class rd extends ey{constructor(e){super(),this.apiClient=e,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new tf(ee.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI()){if(e.baseModel.startsWith("projects/")){let r={tunedModelName:e.baseModel};(null===(t=e.config)||void 0===t?void 0:t.preTunedModelCheckpointId)&&(r.checkpointId=e.config.preTunedModelCheckpointId);let n=Object.assign(Object.assign({},e),{preTunedModel:r});return n.baseModel=void 0,await this.tuneInternal(n)}{let t=Object.assign({},e);return await this.tuneInternal(t)}}{let t=Object.assign({},e),r=await this.tuneMldevInternal(t),n="";return void 0!==r.metadata&&void 0!==r.metadata.tunedModel?n=r.metadata.tunedModel:void 0!==r.name&&r.name.includes("/operations/")&&(n=r.name.split("/operations/")[0]),{name:n,state:A.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(e,["name"]);return null!=n&&e_(r,["_url","name"],n),r}(e);return s=ev("{name}",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>ru(e))}{let t=function(e,t){let r={},n=eE(e,["name"]);return null!=n&&e_(r,["_url","name"],n),r}(e);return s=ev("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>rc(e))}}async listInternal(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(e,["config"]);return null!=n&&function(e,t,r){let n=eE(e,["pageSize"]);void 0!==t&&null!=n&&e_(t,["_query","pageSize"],n);let i=eE(e,["pageToken"]);void 0!==t&&null!=i&&e_(t,["_query","pageToken"],i);let s=eE(e,["filter"]);void 0!==t&&null!=s&&e_(t,["_query","filter"],s)}(n,r),r}(e);return s=ev("tuningJobs",n._url),o=n._query,delete n._url,delete n._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let r={},n=eE(e,["sdkHttpResponse"]);null!=n&&e_(r,["sdkHttpResponse"],n);let i=eE(e,["nextPageToken"]);null!=i&&e_(r,["nextPageToken"],i);let s=eE(e,["tuningJobs"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>ru(e))),e_(r,["tuningJobs"],e)}return r}(e),r=new eD;return Object.assign(r,t),r})}{let t=function(e,t){let r={},n=eE(e,["config"]);return null!=n&&function(e,t,r){let n=eE(e,["pageSize"]);void 0!==t&&null!=n&&e_(t,["_query","pageSize"],n);let i=eE(e,["pageToken"]);void 0!==t&&null!=i&&e_(t,["_query","pageToken"],i);let s=eE(e,["filter"]);void 0!==t&&null!=s&&e_(t,["_query","filter"],s)}(n,r),r}(e);return s=ev("tunedModels",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let r={},n=eE(e,["sdkHttpResponse"]);null!=n&&e_(r,["sdkHttpResponse"],n);let i=eE(e,["nextPageToken"]);null!=i&&e_(r,["nextPageToken"],i);let s=eE(e,["tunedModels"]);if(null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>rc(e))),e_(r,["tuningJobs"],e)}return r}(e),r=new eD;return Object.assign(r,t),r})}}async cancel(e){var t,r,n,i;let s="",o={};if(this.apiClient.isVertexAI()){let n=function(e,t){let r={},n=eE(e,["name"]);return null!=n&&e_(r,["_url","name"],n),r}(e);s=ev("{name}:cancel",n._url),o=n._query,delete n._url,delete n._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(n),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal})}else{let t=function(e,t){let r={},n=eE(e,["name"]);return null!=n&&e_(r,["_url","name"],n),r}(e);s=ev("{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(n=e.config)||void 0===n?void 0:n.httpOptions,abortSignal:null===(i=e.config)||void 0===i?void 0:i.abortSignal})}}async tuneInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI()){let s=function(e,t){let r={},n=eE(e,["baseModel"]);null!=n&&e_(r,["baseModel"],n);let i=eE(e,["preTunedModel"]);null!=i&&e_(r,["preTunedModel"],i);let s=eE(e,["trainingDataset"]);null!=s&&function(e,t,r){let n=eE(e,["gcsUri"]);void 0!==t&&null!=n&&e_(t,["supervisedTuningSpec","trainingDatasetUri"],n);let i=eE(e,["vertexDatasetResource"]);if(void 0!==t&&null!=i&&e_(t,["supervisedTuningSpec","trainingDatasetUri"],i),void 0!==eE(e,["examples"]))throw Error("examples parameter is not supported in Vertex AI.")}(s,r);let o=eE(e,["config"]);return null!=o&&function(e,t,r){let n=eE(e,["validationDataset"]);void 0!==t&&null!=n&&e_(t,["supervisedTuningSpec"],function(e,t){let r={},n=eE(e,["gcsUri"]);null!=n&&e_(r,["validationDatasetUri"],n);let i=eE(e,["vertexDatasetResource"]);return null!=i&&e_(r,["validationDatasetUri"],i),r}(n));let i=eE(e,["tunedModelDisplayName"]);void 0!==t&&null!=i&&e_(t,["tunedModelDisplayName"],i);let s=eE(e,["description"]);void 0!==t&&null!=s&&e_(t,["description"],s);let o=eE(e,["epochCount"]);void 0!==t&&null!=o&&e_(t,["supervisedTuningSpec","hyperParameters","epochCount"],o);let a=eE(e,["learningRateMultiplier"]);void 0!==t&&null!=a&&e_(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);let l=eE(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=l&&e_(t,["supervisedTuningSpec","exportLastCheckpointOnly"],l);let c=eE(e,["adapterSize"]);if(void 0!==t&&null!=c&&e_(t,["supervisedTuningSpec","hyperParameters","adapterSize"],c),void 0!==eE(e,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==eE(e,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let u=eE(e,["labels"]);void 0!==t&&null!=u&&e_(t,["labels"],u)}(o,r),r}(e);return n=ev("tuningJobs",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>ru(e))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let n="",i={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let s=function(e,t){let r={},n=eE(e,["baseModel"]);null!=n&&e_(r,["baseModel"],n);let i=eE(e,["preTunedModel"]);null!=i&&e_(r,["preTunedModel"],i);let s=eE(e,["trainingDataset"]);null!=s&&e_(r,["tuningTask","trainingData"],function(e,t){let r={};if(void 0!==eE(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==eE(e,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let n=eE(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),e_(r,["examples","examples"],e)}return r}(s));let o=eE(e,["config"]);return null!=o&&function(e,t,r){if(void 0!==eE(e,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let n=eE(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=n&&e_(t,["displayName"],n),void 0!==eE(e,["description"]))throw Error("description parameter is not supported in Gemini API.");let i=eE(e,["epochCount"]);void 0!==t&&null!=i&&e_(t,["tuningTask","hyperparameters","epochCount"],i);let s=eE(e,["learningRateMultiplier"]);if(null!=s&&e_({},["tuningTask","hyperparameters","learningRateMultiplier"],s),void 0!==eE(e,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==eE(e,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==eE(e,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let o=eE(e,["batchSize"]);void 0!==t&&null!=o&&e_(t,["tuningTask","hyperparameters","batchSize"],o);let a=eE(e,["learningRate"]);if(void 0!==t&&null!=a&&e_(t,["tuningTask","hyperparameters","learningRate"],a),void 0!==eE(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.")}(o,r),r}(e);return n=ev("tunedModels",s._url),i=s._query,delete s._url,delete s._query,this.apiClient.request({path:n,queryParams:i,body:JSON.stringify(s),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e,t){let r={},n=eE(e,["sdkHttpResponse"]);null!=n&&e_(r,["sdkHttpResponse"],n);let i=eE(e,["name"]);null!=i&&e_(r,["name"],i);let s=eE(e,["metadata"]);null!=s&&e_(r,["metadata"],s);let o=eE(e,["done"]);null!=o&&e_(r,["done"],o);let a=eE(e,["error"]);return null!=a&&e_(r,["error"],a),r})(e))}}}let rp="x-goog-upload-status";async function rh(e,t,r){var n,i,s;let o=0,a=0,l=new ex(new Response),c="upload";for(o=e.size;a<o;){let s=Math.min(8388608,o-a),u=e.slice(a,a+s);a+s>=o&&(c+=", finalize");let d=0,p=1e3;for(;d<3&&(null===(n=null==(l=await r.request({path:"",body:u,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(s)}}}))?void 0:l.headers)||void 0===n||!n[rp]);)d++,await rm(p),p*=2;if(a+=s,(null===(i=null==l?void 0:l.headers)||void 0===i?void 0:i[rp])!=="active")break;if(o<=a)throw Error("All content has been uploaded, but the upload status is not finalized.")}let u=await (null==l?void 0:l.json());if((null===(s=null==l?void 0:l.headers)||void 0===s?void 0:s[rp])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return u.file}async function rf(e){return{size:e.size,type:e.type}}function rm(e){return new Promise(t=>setTimeout(t,e))}class rg{async stat(e){let t={size:0,type:void 0};if("string"!=typeof e)return await rf(e);{let r=await eg.stat(e);return t.size=r.size,t.type=this.inferMimeType(e),t}}async upload(e,t,r){return"string"==typeof e?await this.uploadFileFromPath(e,t,r):rh(e,t,r)}inferMimeType(e){return({aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz+xml",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"})[e.slice(e.lastIndexOf(".")+1).toLowerCase()]}async uploadFileFromPath(e,t,r){var n,i,s;let o;let a=0,l=0,c=new ex(new Response),u="upload";try{if(!(o=await eg.open(e,"r")))throw Error("Failed to open file");for(a=(await o.stat()).size;l<a;){let e=Math.min(8388608,a-l);l+e>=a&&(u+=", finalize");let s=new Uint8Array(e),{bytesRead:d}=await o.read(s,0,e,l);if(d!==e)throw Error(`Failed to read ${e} bytes from file at offset ${l}. bytes actually read: ${d}`);let p=new Blob([s]),h=0,f=1e3;for(;h<3&&(c=await r.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(d)}}}),null===(n=null==c?void 0:c.headers)||void 0===n||!n[rp]);)h++,await rm(f),f*=2;if(l+=d,(null===(i=null==c?void 0:c.headers)||void 0===i?void 0:i[rp])!=="active")break;if(a<=l)throw Error("All content has been uploaded, but the upload status is not finalized.")}let d=await (null==c?void 0:c.json());if((null===(s=null==c?void 0:c.headers)||void 0===s?void 0:s[rp])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return d.file}finally{o&&await o.close()}}}class ry{constructor(e){var t,r,s,o,a,l;if((e.project||e.location)&&e.apiKey)throw Error("Project/location and API key are mutually exclusive in the client initializer.");this.vertexai=null!==(r=null!==(t=e.vertexai)&&void 0!==t?t:function(e){var t;return void 0!==(t=rv(e))&&"true"===t.toLowerCase()}("GOOGLE_GENAI_USE_VERTEXAI"))&&void 0!==r&&r;let c=function(){let e=rv("GOOGLE_API_KEY"),t=rv("GEMINI_API_KEY");return e&&t&&console.warn("Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY."),e||t||void 0}(),u=rv("GOOGLE_CLOUD_PROJECT"),d=rv("GOOGLE_CLOUD_LOCATION");this.apiKey=null!==(s=e.apiKey)&&void 0!==s?s:c,this.project=null!==(o=e.project)&&void 0!==o?o:u,this.location=null!==(a=e.location)&&void 0!==a?a:d,e.vertexai&&((null===(l=e.googleAuthOptions)||void 0===l?void 0:l.credentials)&&(console.debug("The user provided Google Cloud credentials will take precedence over the API key from the environment variable."),this.apiKey=void 0),(u||d)&&e.apiKey?(console.debug("The user provided Vertex AI API key will take precedence over the project/location from the environment variables."),this.project=void 0,this.location=void 0):(e.project||e.location)&&c?(console.debug("The user provided project/location will take precedence over the API key from the environment variables."),this.apiKey=void 0):(u||d)&&c&&(console.debug("The project/location from the environment variables will take precedence over the API key from the environment variables."),this.apiKey=void 0));let p=function(e,t,r,s){var o,a;if(!(null==e?void 0:e.baseUrl)){let e={geminiUrl:n,vertexUrl:i};return t?null!==(o=e.vertexUrl)&&void 0!==o?o:r:null!==(a=e.geminiUrl)&&void 0!==a?a:s}return e.baseUrl}(e.httpOptions,e.vertexai,rv("GOOGLE_VERTEX_BASE_URL"),rv("GOOGLE_GEMINI_BASE_URL"));p&&(e.httpOptions?e.httpOptions.baseUrl=p:e.httpOptions={baseUrl:p}),this.apiVersion=e.apiVersion;let h=new ri({apiKey:this.apiKey,googleAuthOptions:e.googleAuthOptions});this.apiClient=new tK({auth:h,project:this.project,location:this.location,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:"gl-node/"+process.version,uploader:new rg,downloader:new rs}),this.models=new t7(this.apiClient),this.live=new t4(this.apiClient,h,new ra),this.batches=new tm(this.apiClient),this.chats=new tA(this.models,this.apiClient),this.caches=new ty(this.apiClient),this.files=new tC(this.apiClient),this.operations=new re(this.apiClient),this.authTokens=new rt(this.apiClient),this.tunings=new rd(this.apiClient)}}function rv(e){var t,r,n;return null!==(n=null===(r=null===(t=null==process?void 0:process.env)||void 0===t?void 0:t[e])||void 0===r?void 0:r.trim())&&void 0!==n?n:void 0}let r_="AIzaSyDefnzV2zmVTS-mGUjliQI7grypJhfsdDk";if(!r_)throw Error("GEMINI_API_KEY environment variable not set.");let rE=new ry({apiKey:r_}),rb={type:l.OBJECT,properties:{estimatedValueRange:{type:l.OBJECT,properties:{min:{type:l.NUMBER,description:"The minimum estimated value based on conservative market analysis."},max:{type:l.NUMBER,description:"The maximum estimated value based on optimistic market conditions."}},required:["min","max"]},confidenceScore:{type:l.NUMBER,description:"A score from 0 to 100 representing the confidence in the valuation based on image quality, property visibility, and market data availability."},currency:{type:l.STRING,description:"The currency of the valuation (e.g., USD, EUR, NGN). Default to USD if not obvious."},reasoning:{type:l.STRING,description:"A comprehensive, detailed explanation for the valuation including market analysis, property condition assessment, comparable properties, and key value drivers."},detectedFeatures:{type:l.ARRAY,items:{type:l.STRING},description:"A comprehensive list of key visual features detected including architectural style, interior finishes, outdoor amenities, and unique characteristics."},propertyType:{type:l.STRING,description:"The specific type of property (e.g., 'Single-Family Home', 'Townhouse', 'Condo', 'Duplex', 'Multi-Family', 'Commercial Building')."},propertyCondition:{type:l.STRING,description:"The overall condition of the property (e.g., 'Excellent', 'Very Good', 'Good', 'Fair', 'Poor', 'Needs Major Renovation')."},architecturalStyle:{type:l.STRING,description:"The architectural style of the property (e.g., 'Modern', 'Traditional', 'Colonial', 'Craftsman', 'Contemporary', 'Victorian')."},yearBuilt:{type:l.STRING,description:"Estimated year built based on architectural features and construction materials visible in images."},squareFootage:{type:l.STRING,description:"Estimated square footage based on visible rooms and proportions (e.g., '2,500-3,000 sqft', '1,200-1,500 sqft')."},lotSize:{type:l.STRING,description:"Estimated lot size based on visible outdoor space and property boundaries (e.g., '0.25-0.5 acres', 'Small urban lot')."},keyValueDrivers:{type:l.ARRAY,items:{type:l.STRING},description:"Key factors that positively impact the property's value (e.g., 'Updated kitchen', 'Prime location', 'Large lot', 'Modern finishes')."},potentialConcerns:{type:l.ARRAY,items:{type:l.STRING},description:"Potential issues or concerns that might negatively impact value (e.g., 'Outdated bathrooms', 'Small bedrooms', 'Limited parking')."},marketPositioning:{type:l.STRING,description:"How this property compares to the local market (e.g., 'Above market average', 'Market rate', 'Below market average', 'Premium property')."},suggestedUpgrades:{type:l.ARRAY,description:"A prioritized list of suggested upgrades or repairs to maximize the property's value, including detailed reasoning and ROI analysis.",items:{type:l.OBJECT,properties:{upgrade:{type:l.STRING,description:"The specific upgrade or repair suggested (e.g., 'Modernize Kitchen Appliances')."},reasoning:{type:l.STRING,description:"Detailed reasoning for why this upgrade is recommended based on current market trends and property analysis."},estimatedCost:{type:l.STRING,description:"A detailed cost estimate ('$5,000-8,000', 'Low: $1,000-3,000', 'High: $15,000-25,000')."},impactOnValue:{type:l.STRING,description:"The potential impact on the property's value ('Low: +2-5%', 'Medium: +5-10%', 'High: +10-20%')."},priority:{type:l.STRING,description:"Priority level ('High', 'Medium', 'Low') based on cost-benefit analysis."},timeline:{type:l.STRING,description:"Recommended timeline for implementation ('Immediate', 'Within 6 months', 'Long-term')."}},required:["upgrade","reasoning","estimatedCost","impactOnValue","priority","timeline"]}}},required:["estimatedValueRange","confidenceScore","currency","reasoning","detectedFeatures","propertyType","propertyCondition","architecturalStyle","yearBuilt","squareFootage","lotSize","keyValueDrivers","potentialConcerns","marketPositioning","suggestedUpgrades"]},rx=async(e,t)=>{let r=e.map(e=>({inlineData:{mimeType:"image/jpeg",data:e}})),n=`
    Analyze the following property images and details as an expert real estate appraiser with 20+ years of experience. Conduct a comprehensive property valuation using advanced market analysis techniques.

    Property Details Provided:
    - Address/Location: ${t.address||"Not provided"}
    - Property Size: ${t.propertySize?`${t.propertySize} sqft`:"Not provided"}
    - Bedrooms: ${t.bedrooms||"Not provided"}
    - Bathrooms: ${t.bathrooms||"Not provided"}
    - Additional Notes: ${t.additionalNotes||"None"}

    **Comprehensive Analysis Requirements:**

    1. **Market Research & Comparables:**
       - If address provided: Use Google Search to find recent sales (last 6-12 months) within 1-2 miles
       - Analyze 3-5 comparable properties with similar size, age, and condition
       - Consider market trends, seasonal variations, and local economic factors
       - Factor in neighborhood desirability, school districts, and amenities

    2. **Property Assessment:**
       - Analyze architectural style, construction quality, and materials
       - Assess interior condition, finishes, and modern amenities
       - Evaluate outdoor spaces, landscaping, and curb appeal
       - Identify unique features that add or detract from value
       - Estimate year built, square footage, and lot size from visual cues

    3. **Value Analysis:**
       - Determine market positioning (above/below/at market rate)
       - Identify key value drivers and potential concerns
       - Consider location factors: walkability, safety, transportation
       - Assess energy efficiency and modern systems
       - Evaluate parking, storage, and functional layout

    4. **Investment Analysis:**
       - Provide detailed upgrade recommendations with ROI analysis
       - Prioritize improvements by cost-benefit ratio
       - Include timeline recommendations for implementation
       - Consider market timing and buyer preferences

    **Confidence Scoring Guidelines:**
    - 90-100%: Excellent image quality, clear comps, detailed property info
    - 80-89%: Good images, some comps, basic property details
    - 70-79%: Fair images, limited comps, minimal details
    - 60-69%: Poor images, no comps, very limited info
    - Below 60%: Insufficient data for reliable valuation

    **Output Format:**
    Provide your complete response as a single, valid JSON object. Do not add any text, comments, or markdown formatting (like \`\`\`json) before or after the JSON object. The JSON object must strictly adhere to the following structure:

    {
      "estimatedValueRange": { "min": number, "max": number },
      "confidenceScore": number (0-100),
      "currency": string (e.g., "USD"),
      "reasoning": string (comprehensive market analysis and valuation rationale),
      "detectedFeatures": string[] (detailed visual features and amenities),
      "propertyType": string (specific property classification),
      "propertyCondition": string (detailed condition assessment),
      "architecturalStyle": string (architectural classification),
      "yearBuilt": string (estimated construction year),
      "squareFootage": string (estimated size range),
      "lotSize": string (estimated lot dimensions),
      "keyValueDrivers": string[] (positive value factors),
      "potentialConcerns": string[] (negative value factors),
      "marketPositioning": string (market comparison assessment),
      "suggestedUpgrades": [
        {
          "upgrade": string,
          "reasoning": string,
          "estimatedCost": string (detailed cost range),
          "impactOnValue": string (percentage impact),
          "priority": string ("High", "Medium", "Low"),
          "timeline": string ("Immediate", "Within 6 months", "Long-term")
        }
      ]
    }
  `,i=t.address&&""!==t.address.trim();try{let e=await rE.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[...r,{text:n}]},config:i?{tools:[{googleSearch:{}}]}:{responseMimeType:"application/json",responseSchema:rb}});if(!e.text)throw Error("No response text received from AI service.");let t=e.text.trim().replace(/^```json\s*|```$/g,""),s=JSON.parse(t);if(!s.estimatedValueRange||!s.reasoning)throw Error("Incomplete valuation data received from AI.");if(i){let t=e.candidates?.[0]?.groundingMetadata?.groundingChunks,r=t?.map(e=>e.web).filter(e=>!!e&&!!e.uri&&!!e.title)||[];return{...s,sources:r}}return s}catch(e){if(console.error("Error calling Gemini API:",e),e instanceof Error)throw Error(`Failed to get property valuation: ${e.message}`);throw Error("An unknown error occurred during property valuation.")}},rA=async e=>{let t=`
    As a senior real estate analyst with 20+ years of experience, create a comprehensive, professional property valuation report. This report will be used by potential buyers, sellers, and investors for critical decision-making. The tone should be authoritative, data-driven, and actionable.

    **Comprehensive Property Data:**
    - Property Type: ${e.propertyType}
    - Address: ${e.propertyDetails?.address||"Not specified"}
    - Property Size: ${e.propertyDetails?.propertySize?`${e.propertyDetails.propertySize} sqft`:e.squareFootage||"Not specified"}
    - Bedrooms: ${e.propertyDetails?.bedrooms||"Not specified"}
    - Bathrooms: ${e.propertyDetails?.bathrooms||"Not specified"}
    - Architectural Style: ${e.architecturalStyle||"Not specified"}
    - Year Built: ${e.yearBuilt||"Not specified"}
    - Lot Size: ${e.lotSize||"Not specified"}
    - Estimated Value Range: $${e.estimatedValueRange.min.toLocaleString()} - $${e.estimatedValueRange.max.toLocaleString()} ${e.currency}
    - Confidence Score: ${e.confidenceScore}%
    - Market Positioning: ${e.marketPositioning||"Not specified"}
    - Overall Condition: ${e.propertyCondition}
    
    **Key Value Drivers:**
    ${e.keyValueDrivers?e.keyValueDrivers.map(e=>`- ${e}`).join("\n"):"Not specified"}
    
    **Potential Concerns:**
    ${e.potentialConcerns?e.potentialConcerns.map(e=>`- ${e}`).join("\n"):"None identified"}
    
    **Detected Features:**
    ${e.detectedFeatures.join(", ")}
    
    **AI Valuation Analysis:**
    ${e.reasoning}
    
    **Strategic Investment Recommendations:**
    ${e.suggestedUpgrades.map(e=>`- **${e.upgrade}** (Priority: ${e.priority}, Timeline: ${e.timeline})
  - Reasoning: ${e.reasoning}
  - Estimated Cost: ${e.estimatedCost}
  - Value Impact: ${e.impactOnValue}`).join("\n\n")}
    
    **Market Research Sources:**
    ${e.sources&&e.sources.length>0?e.sources.map(e=>`- [${e.title}](${e.uri})`).join("\n"):"No external sources consulted"}

    **Professional Report Structure:**
    Create a comprehensive report with the following sections:
    
    1. **## Executive Summary**
       - Property overview and key metrics
       - Estimated value range and confidence level
       - Market positioning and investment potential
       - Key recommendations summary
    
    2. **## Property Analysis**
       - Detailed property description and characteristics
       - Architectural assessment and construction quality
       - Interior and exterior condition analysis
       - Unique features and amenities
       - Space utilization and functional layout
    
    3. **## Market Analysis & Valuation**
       - Local market conditions and trends
       - Comparable property analysis (if available)
       - Valuation methodology and rationale
       - Market positioning assessment
       - Risk factors and market considerations
    
    4. **## Investment Strategy**
       - Prioritized upgrade recommendations
       - Cost-benefit analysis for each improvement
       - Timeline and implementation strategy
       - Expected return on investment
       - Market timing considerations
    
    5. **## Risk Assessment**
       - Potential concerns and mitigation strategies
       - Market risks and economic factors
       - Property-specific challenges
       - Investment timeline recommendations
    
    6. **## Conclusion & Next Steps**
       - Investment recommendation summary
       - Key action items for buyers/sellers
       - Professional disclaimer and limitations
       - Recommendation for professional appraisal

    **Report Requirements:**
    - Use professional real estate terminology
    - Include specific data points and metrics
    - Provide actionable insights and recommendations
    - Maintain objective, analytical tone
    - Include relevant market context and trends
    - Format with clear headings and bullet points
    - Target length: 1,500-2,500 words

    Generate only the report text without any additional commentary.
  `;try{let e=await rE.models.generateContent({model:"gemini-2.5-flash",contents:t});if(!e.text)throw Error("No response text received from AI service.");return e.text}catch(e){if(console.error("Error generating detailed report:",e),e instanceof Error)throw Error(`Failed to generate detailed report: ${e.message}`);throw Error("An unknown error occurred while generating the report.")}};var rT=r(6005);let rS={randomUUID:rT.randomUUID},rC=new Uint8Array(256),rw=rC.length,rO=[];for(let e=0;e<256;++e)rO.push((e+256).toString(16).slice(1));var rI=r(25255),rN=r(13192),rk=r(38203),rR=r(98962);let rP=e=>new Promise((t,r)=>{let n=new FileReader;n.readAsDataURL(e),n.onload=()=>{t(n.result.split(",")[1])},n.onerror=e=>r(e)}),rj=()=>{let[e,t]=(0,er.useState)([]),[r,n]=(0,er.useState)({}),[i,s]=(0,er.useState)(null),[o,a]=(0,er.useState)(!1),[l,c]=(0,er.useState)(null),[u,d]=(0,er.useState)(!1),[p,h]=(0,er.useState)(null),[f,m]=(0,er.useState)(!1),g=(0,er.useCallback)(e=>{t(e)},[]),y=(0,er.useCallback)(e=>{n(e)},[]),v=async()=>{if(0===e.length){c("Please upload at least one image.");return}a(!0),c(null),s(null);try{let t=await Promise.all(e.map(rP)),n={...await rx(t,r),id:rS.randomUUID?rS.randomUUID():function(e,t,r){let n=(e=e||{}).random??e.rng?.()??(rw>rC.length-16&&((0,rT.randomFillSync)(rC),rw=0),rC.slice(rw,rw+=16));if(n.length<16)throw Error("Random bytes length must be >= 16");if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return(rO[e[t+0]]+rO[e[t+1]]+rO[e[t+2]]+rO[e[t+3]]+"-"+rO[e[t+4]]+rO[e[t+5]]+"-"+rO[e[t+6]]+rO[e[t+7]]+"-"+rO[e[t+8]]+rO[e[t+9]]+"-"+rO[e[t+10]]+rO[e[t+11]]+rO[e[t+12]]+rO[e[t+13]]+rO[e[t+14]]+rO[e[t+15]]).toLowerCase()}(n)}(void 0,void 0,void 0),timestamp:new Date().toISOString(),previewImage:`data:image/jpeg;base64,${t[0]}`,propertyDetails:r};s(n)}catch(t){let e=t instanceof Error?t.message:"An unexpected error occurred.";c(`Valuation failed: ${e}`)}finally{a(!1)}},_=async e=>{d(!0),c(null);try{let t=await rA(e);h(t),m(!0)}catch(t){let e=t instanceof Error?t.message:"An unexpected error occurred.";c(`Failed to generate detailed report: ${e}`)}finally{d(!1)}};return(0,et.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,et.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-3xl shadow-2xl border border-gray-200/50 overflow-hidden",children:[et.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-8 py-6 border-b border-gray-200/50",children:(0,et.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[et.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center",children:(0,et.jsxs)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,et.jsxs)("div",{children:[et.jsx("h2",{className:"text-3xl font-bold gradient-text mb-1",children:"HomeWorth AI Valuation"}),et.jsx("p",{className:"text-gray-600",children:"Upload property images and get an instant AI-powered valuation"})]})]})}),(0,et.jsxs)("div",{className:"p-8",children:[et.jsx(rI.Z,{onImagesChange:g,onDetailsChange:y,onSubmit:v,isLoading:o}),l&&et.jsx("div",{className:"mt-8 p-6 bg-red-50 border border-red-200 rounded-2xl",children:(0,et.jsxs)("div",{className:"flex items-start",children:[et.jsx("svg",{className:"w-6 h-6 text-red-400 mr-3 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:et.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,et.jsxs)("div",{children:[et.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Valuation Error"}),et.jsx("p",{className:"text-red-700",children:l})]})]})}),o&&et.jsx("div",{className:"mt-8",children:(0,et.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-8 text-center",children:[et.jsx(rN.Z,{}),et.jsx("p",{className:"text-gray-600 mt-4 font-medium",children:"Analyzing your property..."})]})}),i&&et.jsx("div",{className:"mt-8 fade-in",children:et.jsx(rk.Z,{report:i,onGenerateReport:_,isGeneratingReport:u})})]})]}),et.jsx(rR.Z,{isOpen:f,onClose:()=>m(!1),reportText:p})]})},rD=()=>{let[e,t]=(0,er.useState)(!1),r=()=>{t(!0)};return e?et.jsx("div",{className:"min-h-screen bg-slate-50",children:(0,et.jsxs)("div",{className:"py-8",children:[et.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-8",children:(0,et.jsxs)("button",{onClick:()=>{t(!1)},className:"flex items-center text-blue-600 hover:text-blue-700 font-medium transition-colors duration-200",children:[et.jsx("span",{className:"mr-2",children:"←"}),"Back to Homepage"]})}),et.jsx(rj,{})]})}):(0,et.jsxs)("div",{className:"min-h-screen bg-white",children:[et.jsx(en,{onNavigateToApp:r}),et.jsx(ei,{onNavigateToApp:r}),et.jsx(es,{}),et.jsx(eo,{onNavigateToApp:r}),et.jsx(ea,{}),et.jsx(el,{}),et.jsx(ec,{}),et.jsx(eu,{onNavigateToApp:r}),et.jsx(ed,{})]})}},33136:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>a,a:()=>l});var n=r(10326),i=r(17577),s=r(42945);let o=(0,i.createContext)(void 0);function a({children:e}){let[t,r]=(0,i.useState)(null),[a,l]=(0,i.useState)(!0),c=(0,s.e)(),u=async(e,t,r)=>{let{data:n,error:i}=await c.auth.signUp({email:e,password:t,options:{data:{full_name:r}}});if(!i&&n.user)try{await c.from("users").insert({id:n.user.id,email:n.user.email,full_name:r,credits:5,total_credits_purchased:0})}catch(e){console.error("Error creating user profile:",e)}return{error:i}},d=async(e,t)=>{let{error:r}=await c.auth.signInWithPassword({email:e,password:t});return{error:r}},p=async()=>{let{error:e}=await c.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/dashboard`}});return{error:e}},h=async()=>{await c.auth.signOut(),r(null)},f=async e=>{if(!t)return{error:"No user logged in"};let{error:n}=await c.from("users").update(e).eq("id",t.id);return n||r({...t,...e}),{error:n}},m=async()=>{if(t)try{let{data:e,error:n}=await c.from("users").select("*").eq("id",t.id).single();!n&&e&&r(e)}catch(e){console.error("Error refreshing user data:",e)}};return n.jsx(o.Provider,{value:{user:t,loading:a,signUp:u,signIn:d,signInWithGoogle:p,signOut:h,updateProfile:f,refreshUser:m},children:e})}function l(){let e=(0,i.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},56915:(e,t,r)=>{"use strict";r.d(t,{QueryProvider:()=>a});var n=r(10326),i=r(54618),s=r(44976),o=r(17577);function a({children:e}){let[t]=(0,o.useState)(()=>new i.S({defaultOptions:{queries:{staleTime:3e5,refetchOnWindowFocus:!1}}}));return n.jsx(s.aH,{client:t,children:e})}},42945:(e,t,r)=>{"use strict";r.d(t,{e:()=>i});var n=r(15847);function i(){return(0,n.createBrowserClient)("https://bbbengshbvpqxtzrphov.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJiYmVuZ3NoYnZwcXh0enJwaG92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzNzcxNjYsImV4cCI6MjA3Njk1MzE2Nn0.CkmmMBMjbQlJgsgMjRLGfjE6fO-BXiis8nZflT16VX8")}},714:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,s=l(e),o=s[0],a=s[1],c=new i((o+a)*3/4-a),u=0,d=a>0?o-4:o;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===a&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===a&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],o=0,a=n-i;o<a;o+=16383)s.push(function(e,t,n){for(var i,s=[],o=t;o<n;o+=3)s.push(r[(i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}(e,o,o+16383>a?a:o+16383));return 1===i?s.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&s.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},28254:function(e,t,r){var n;!function(i){"use strict";var s,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,l=Math.floor,c="[BigNumber Error] ",u=c+"Number primitive has more than 15 significant digits: ",d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function p(e){var t=0|e;return e>0||e===t?t:t-1}function h(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(r=14-(t=e[n++]+"").length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function f(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,l=e.e,c=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=l==c,!i||!s)return n?0:!i^r?1:-1;if(!n)return l>c^r?1:-1;for(o=0,a=(l=i.length)<(c=s.length)?l:c;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return l==c?0:l>c^r?1:-1}function m(e,t,r,n){if(e<t||e>r||e!==l(e))throw Error(c+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function g(e){var t=e.c.length-1;return p(e.e/14)==t&&e.c[t]%2!=0}function y(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function v(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(n=e.length,++t>n){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}(s=function e(t){var r,n,i,s,_,E,b,x,A,T=L.prototype={constructor:L,toString:null,valueOf:null},S=new L(1),C=20,w=4,O=-7,I=21,N=-1e7,k=1e7,R=!1,P=1,j=0,D={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},U="0123456789abcdefghijklmnopqrstuvwxyz",M=!0;function L(e,t){var r,n,i,s,a,c,d,p,h=this;if(!(h instanceof L))return new L(e,t);if(null==t){if(e&&!0===e._isBigNumber){h.s=e.s,!e.c||e.e>k?h.c=h.e=null:e.e<N?h.c=[h.e=0]:(h.e=e.e,h.c=e.c.slice());return}if((c="number"==typeof e)&&0*e==0){if(h.s=1/e<0?(e=-e,-1):1,e===~~e){for(s=0,a=e;a>=10;a/=10,s++);s>k?h.c=h.e=null:(h.e=s,h.c=[e]);return}p=String(e)}else{if(!o.test(p=String(e)))return A(h,p,c);h.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(s=p.indexOf("."))>-1&&(p=p.replace(".","")),(a=p.search(/e/i))>0?(s<0&&(s=a),s+=+p.slice(a+1),p=p.substring(0,a)):s<0&&(s=p.length)}else{if(m(t,2,U.length,"Base"),10==t&&M)return B(h=new L(e),C+h.e+1,w);if(p=String(e),c="number"==typeof e){if(0*e!=0)return A(h,p,c,t);if(h.s=1/e<0?(p=p.slice(1),-1):1,L.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(u+e)}else h.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=U.slice(0,t),s=a=0,d=p.length;a<d;a++)if(0>r.indexOf(n=p.charAt(a))){if("."==n){if(a>s){s=d;continue}}else if(!i&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){i=!0,a=-1,s=0;continue}return A(h,String(e),c,t)}c=!1,(s=(p=x(p,t,10,h.s)).indexOf("."))>-1?p=p.replace(".",""):s=p.length}for(a=0;48===p.charCodeAt(a);a++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(a,++d)){if(d-=a,c&&L.DEBUG&&d>15&&(e>9007199254740991||e!==l(e)))throw Error(u+h.s*e);if((s=s-a-1)>k)h.c=h.e=null;else if(s<N)h.c=[h.e=0];else{if(h.e=s,h.c=[],a=(s+1)%14,s<0&&(a+=14),a<d){for(a&&h.c.push(+p.slice(0,a)),d-=14;a<d;)h.c.push(+p.slice(a,a+=14));a=14-(p=p.slice(a)).length}else a-=d;for(;a--;p+="0");h.c.push(+p)}}else h.c=[h.e=0]}function G(e,t,r,n){var i,s,o,a,l;if(null==r?r=w:m(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)l=h(e.c),l=1==n||2==n&&(o<=O||o>=I)?y(l,o):v(l,o,"0");else if(s=(e=B(new L(e),t,r)).e,a=(l=h(e.c)).length,1==n||2==n&&(t<=s||s<=O)){for(;a<t;l+="0",a++);l=y(l,s)}else if(t-=o+(2===n&&s>o),l=v(l,s,"0"),s+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=s-a)>0)for(s+1==a&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function q(e,t){for(var r,n,i=1,s=new L(e[0]);i<e.length;i++)(n=new L(e[i])).s&&(r=f(s,n))!==t&&(0!==r||s.s!==t)||(s=n);return s}function F(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+14*r-1)>k?e.c=e.e=null:r<N?e.c=[e.e=0]:(e.e=r,e.c=t),e}function B(e,t,r,n){var i,s,o,c,u,p,h,f=e.c;if(f){e:{for(i=1,c=f[0];c>=10;c/=10,i++);if((s=t-i)<0)s+=14,o=t,h=l((u=f[p=0])/d[i-o-1]%10);else if((p=a((s+1)/14))>=f.length){if(n){for(;f.length<=p;f.push(0));u=h=0,i=1,s%=14,o=s-14+1}else break e}else{for(i=1,u=c=f[p];c>=10;c/=10,i++);s%=14,h=(o=s-14+i)<0?0:l(u/d[i-o-1]%10)}if(n=n||t<0||null!=f[p+1]||(o<0?u:u%d[i-o-1]),n=r<4?(h||n)&&(0==r||r==(e.s<0?3:2)):h>5||5==h&&(4==r||n||6==r&&(s>0?o>0?u/d[i-o]:0:f[p-1])%10&1||r==(e.s<0?8:7)),t<1||!f[0])return f.length=0,n?(t-=e.e+1,f[0]=d[(14-t%14)%14],e.e=-t||0):f[0]=e.e=0,e;if(0==s?(f.length=p,c=1,p--):(f.length=p+1,c=d[14-s],f[p]=o>0?l(u/d[i-o]%d[o])*c:0),n)for(;;){if(0==p){for(s=1,o=f[0];o>=10;o/=10,s++);for(o=f[0]+=c,c=1;o>=10;o/=10,c++);s!=c&&(e.e++,1e14==f[0]&&(f[0]=1));break}if(f[p]+=c,1e14!=f[p])break;f[p--]=0,c=1}for(s=f.length;0===f[--s];f.pop());}e.e>k?e.c=e.e=null:e.e<N&&(e.c=[e.e=0])}return e}function H(e){var t,r=e.e;return null===r?e.toString():(t=h(e.c),t=r<=O||r>=I?y(t,r):v(t,r,"0"),e.s<0?"-"+t:t)}return L.clone=e,L.ROUND_UP=0,L.ROUND_DOWN=1,L.ROUND_CEIL=2,L.ROUND_FLOOR=3,L.ROUND_HALF_UP=4,L.ROUND_HALF_DOWN=5,L.ROUND_HALF_EVEN=6,L.ROUND_HALF_CEIL=7,L.ROUND_HALF_FLOOR=8,L.EUCLID=9,L.config=L.set=function(e){var t,r;if(null!=e){if("object"==typeof e){if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(m(r=e[t],0,1e9,t),C=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(m(r=e[t],0,8,t),w=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(m(r[0],-1e9,0,t),m(r[1],0,1e9,t),O=r[0],I=r[1]):(m(r,-1e9,1e9,t),O=-(I=r<0?-r:r))),e.hasOwnProperty(t="RANGE")){if((r=e[t])&&r.pop)m(r[0],-1e9,-1,t),m(r[1],1,1e9,t),N=r[0],k=r[1];else if(m(r,-1e9,1e9,t),r)N=-(k=r<0?-r:r);else throw Error(c+t+" cannot be zero: "+r)}if(e.hasOwnProperty(t="CRYPTO")){if(!!(r=e[t])===r){if(r){if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))R=r;else throw R=!r,Error(c+"crypto unavailable")}else R=r}else throw Error(c+t+" not true or false: "+r)}if(e.hasOwnProperty(t="MODULO_MODE")&&(m(r=e[t],0,9,t),P=r),e.hasOwnProperty(t="POW_PRECISION")&&(m(r=e[t],0,1e9,t),j=r),e.hasOwnProperty(t="FORMAT")){if("object"==typeof(r=e[t]))D=r;else throw Error(c+t+" not an object: "+r)}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(c+t+" invalid: "+r);M="0123456789"==r.slice(0,10),U=r}}else throw Error(c+"Object expected: "+e)}return{DECIMAL_PLACES:C,ROUNDING_MODE:w,EXPONENTIAL_AT:[O,I],RANGE:[N,k],CRYPTO:R,MODULO_MODE:P,POW_PRECISION:j,FORMAT:D,ALPHABET:U}},L.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!L.DEBUG)return!0;var t,r,n=e.c,i=e.e,s=e.s;e:if("[object Array]"==({}).toString.call(n)){if((1===s||-1===s)&&i>=-1e9&&i<=1e9&&i===l(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%14)<1&&(t+=14),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=1e14||r!==l(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(c+"Invalid BigNumber: "+e)},L.maximum=L.max=function(){return q(arguments,-1)},L.minimum=L.min=function(){return q(arguments,1)},L.random=(r=9007199254740992*Math.random()&2097151?function(){return l(9007199254740992*Math.random())}:function(){return(1073741824*Math.random()|0)*8388608+(8388608*Math.random()|0)},function(e){var t,n,i,s,o,u=0,p=[],h=new L(S);if(null==e?e=C:m(e,0,1e9),s=a(e/14),R){if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(s*=2));u<s;)(o=131072*t[u]+(t[u+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[u]=n[0],t[u+1]=n[1]):(p.push(o%1e14),u+=2);u=s/2}else if(crypto.randomBytes){for(t=crypto.randomBytes(s*=7);u<s;)(o=(31&t[u])*281474976710656+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(p.push(o%1e14),u+=7);u=s/7}else throw R=!1,Error(c+"crypto unavailable")}if(!R)for(;u<s;)(o=r())<9e15&&(p[u++]=o%1e14);for(s=p[--u],e%=14,s&&e&&(o=d[14-e],p[u]=l(s/o)*o);0===p[u];p.pop(),u--);if(u<0)p=[i=0];else{for(i=-1;0===p[0];p.splice(0,1),i-=14);for(u=1,o=p[0];o>=10;o/=10,u++);u<14&&(i-=14-u)}return h.e=i,h.c=p,h}),L.sum=function(){for(var e=1,t=arguments,r=new L(t[0]);e<t.length;)r=r.plus(t[e++]);return r},x=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],a=0,l=e.length;a<l;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(r,n,i,s,o){var a,l,c,u,d,p,f,m,g=r.indexOf("."),y=C,_=w;for(g>=0&&(u=j,j=0,r=r.replace(".",""),p=(m=new L(n)).pow(r.length-g),j=u,m.c=t(v(h(p.c),p.e,"0"),10,i,e),m.e=m.c.length),c=u=(f=t(r,n,i,o?(a=U,e):(a=e,U))).length;0==f[--u];f.pop());if(!f[0])return a.charAt(0);if(g<0?--c:(p.c=f,p.e=c,p.s=s,f=(p=b(p,m,y,_,i)).c,d=p.r,c=p.e),g=f[l=c+y+1],u=i/2,d=d||l<0||null!=f[l+1],d=_<4?(null!=g||d)&&(0==_||_==(p.s<0?3:2)):g>u||g==u&&(4==_||d||6==_&&1&f[l-1]||_==(p.s<0?8:7)),l<1||!f[0])r=d?v(a.charAt(1),-y,a.charAt(0)):a.charAt(0);else{if(f.length=l,d)for(--i;++f[--l]>i;)f[l]=0,l||(++c,f=[1].concat(f));for(u=f.length;!f[--u];);for(g=0,r="";g<=u;r+=a.charAt(f[g++]));r=v(r,c,a.charAt(0))}return r}}(),b=function(){function e(e,t,r){var n,i,s,o,a=0,l=e.length,c=t%1e7,u=t/1e7|0;for(e=e.slice();l--;)n=u*(s=e[l]%1e7)+(o=e[l]/1e7|0)*c,a=((i=c*s+n%1e7*1e7+a)/r|0)+(n/1e7|0)+u*o,e[l]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,s,o,a){var c,u,d,h,f,m,g,y,v,_,E,b,x,A,T,S,C,w=n.s==i.s?1:-1,O=n.c,I=i.c;if(!O||!O[0]||!I||!I[0])return new L(n.s&&i.s&&(O?!I||O[0]!=I[0]:I)?O&&0==O[0]||!I?0*w:w/0:NaN);for(v=(y=new L(w)).c=[],w=s+(u=n.e-i.e)+1,a||(a=1e14,u=p(n.e/14)-p(i.e/14),w=w/14|0),d=0;I[d]==(O[d]||0);d++);if(I[d]>(O[d]||0)&&u--,w<0)v.push(1),h=!0;else{for(A=O.length,S=I.length,d=0,w+=2,(f=l(a/(I[0]+1)))>1&&(I=e(I,f,a),O=e(O,f,a),S=I.length,A=O.length),x=S,E=(_=O.slice(0,S)).length;E<S;_[E++]=0);C=[0].concat(C=I.slice()),T=I[0],I[1]>=a/2&&T++;do{if(f=0,(c=t(I,_,S,E))<0){if(b=_[0],S!=E&&(b=b*a+(_[1]||0)),(f=l(b/T))>1)for(f>=a&&(f=a-1),g=(m=e(I,f,a)).length,E=_.length;1==t(m,_,g,E);)f--,r(m,S<g?C:I,g,a),g=m.length,c=1;else 0==f&&(c=f=1),g=(m=I.slice()).length;if(g<E&&(m=[0].concat(m)),r(_,m,E,a),E=_.length,-1==c)for(;1>t(I,_,S,E);)f++,r(_,S<E?C:I,E,a),E=_.length}else 0===c&&(f++,_=[0]);v[d++]=f,_[0]?_[E++]=O[x]||0:(_=[O[x]],E=1)}while((x++<A||null!=_[0])&&w--);h=null!=_[0],v[0]||v.splice(0,1)}if(1e14==a){for(d=1,w=v[0];w>=10;w/=10,d++);B(y,s+(y.e=d+14*u-1)+1,o,h)}else y.e=u,y.r=+h;return y}}(),n=/^(-?)0([xbo])(?=\w[\w.]*$)/i,i=/^([^.]+)\.$/,s=/^\.([^.]+)$/,_=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g,A=function(e,t,r,o){var a,l=r?t:t.replace(E,"");if(_.test(l))e.s=isNaN(l)?null:l<0?-1:1;else{if(!r&&(l=l.replace(n,function(e,t,r){return a="x"==(r=r.toLowerCase())?16:"b"==r?2:8,o&&o!=a?e:t}),o&&(a=o,l=l.replace(i,"$1").replace(s,"0.$1")),t!=l))return new L(l,a);if(L.DEBUG)throw Error(c+"Not a"+(o?" base "+o:"")+" number: "+t);e.s=null}e.c=e.e=null},T.absoluteValue=T.abs=function(){var e=new L(this);return e.s<0&&(e.s=1),e},T.comparedTo=function(e,t){return f(this,new L(e,t))},T.decimalPlaces=T.dp=function(e,t){var r,n,i;if(null!=e)return m(e,0,1e9),null==t?t=w:m(t,0,8),B(new L(this),e+this.e+1,t);if(!(r=this.c))return null;if(n=((i=r.length-1)-p(this.e/14))*14,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},T.dividedBy=T.div=function(e,t){return b(this,new L(e,t),C,w)},T.dividedToIntegerBy=T.idiv=function(e,t){return b(this,new L(e,t),0,1)},T.exponentiatedBy=T.pow=function(e,t){var r,n,i,s,o,u,d,p,h,f=this;if((e=new L(e)).c&&!e.isInteger())throw Error(c+"Exponent not an integer: "+H(e));if(null!=t&&(t=new L(t)),u=e.e>14,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!e.c||!e.c[0])return h=new L(Math.pow(+H(f),u?e.s*(2-g(e)):+H(e))),t?h.mod(t):h;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new L(NaN);(n=!d&&f.isInteger()&&t.isInteger())&&(f=f.mod(t))}else{if(e.e>9&&(f.e>0||f.e<-1||(0==f.e?f.c[0]>1||u&&f.c[1]>=24e7:f.c[0]<8e13||u&&f.c[0]<=9999975e7)))return s=f.s<0&&g(e)?-0:0,f.e>-1&&(s=1/s),new L(d?1/s:s);j&&(s=a(j/14+2))}for(u?(r=new L(.5),d&&(e.s=1),p=g(e)):p=(i=Math.abs(+H(e)))%2,h=new L(S);;){if(p){if(!(h=h.times(f)).c)break;s?h.c.length>s&&(h.c.length=s):n&&(h=h.mod(t))}if(i){if(0===(i=l(i/2)))break;p=i%2}else if(B(e=e.times(r),e.e+1,1),e.e>14)p=g(e);else{if(0==(i=+H(e)))break;p=i%2}f=f.times(f),s?f.c&&f.c.length>s&&(f.c.length=s):n&&(f=f.mod(t))}return n?h:(d&&(h=S.div(h)),t?h.mod(t):s?B(h,j,w,o):h)},T.integerValue=function(e){var t=new L(this);return null==e?e=w:m(e,0,8),B(t,t.e+1,e)},T.isEqualTo=T.eq=function(e,t){return 0===f(this,new L(e,t))},T.isFinite=function(){return!!this.c},T.isGreaterThan=T.gt=function(e,t){return f(this,new L(e,t))>0},T.isGreaterThanOrEqualTo=T.gte=function(e,t){return 1===(t=f(this,new L(e,t)))||0===t},T.isInteger=function(){return!!this.c&&p(this.e/14)>this.c.length-2},T.isLessThan=T.lt=function(e,t){return 0>f(this,new L(e,t))},T.isLessThanOrEqualTo=T.lte=function(e,t){return -1===(t=f(this,new L(e,t)))||0===t},T.isNaN=function(){return!this.s},T.isNegative=function(){return this.s<0},T.isPositive=function(){return this.s>0},T.isZero=function(){return!!this.c&&0==this.c[0]},T.minus=function(e,t){var r,n,i,s,o=this.s;if(t=(e=new L(e,t)).s,!o||!t)return new L(NaN);if(o!=t)return e.s=-t,this.plus(e);var a=this.e/14,l=e.e/14,c=this.c,u=e.c;if(!a||!l){if(!c||!u)return c?(e.s=-t,e):new L(u?this:NaN);if(!c[0]||!u[0])return u[0]?(e.s=-t,e):new L(c[0]?this:3==w?-0:0)}if(a=p(a),l=p(l),c=c.slice(),o=a-l){for((s=o<0)?(o=-o,i=c):(l=a,i=u),i.reverse(),t=o;t--;i.push(0));i.reverse()}else for(n=(s=(o=c.length)<(t=u.length))?o:t,o=t=0;t<n;t++)if(c[t]!=u[t]){s=c[t]<u[t];break}if(s&&(i=c,c=u,u=i,e.s=-e.s),(t=(n=u.length)-(r=c.length))>0)for(;t--;c[r++]=0);for(t=1e14-1;n>o;){if(c[--n]<u[n]){for(r=n;r&&!c[--r];c[r]=t);--c[r],c[n]+=1e14}c[n]-=u[n]}for(;0==c[0];c.splice(0,1),--l);return c[0]?F(e,c,l):(e.s=3==w?-1:1,e.c=[e.e=0],e)},T.modulo=T.mod=function(e,t){var r,n;return(e=new L(e,t),this.c&&e.s&&(!e.c||e.c[0]))?e.c&&(!this.c||this.c[0])?(9==P?(n=e.s,e.s=1,r=b(this,e,0,3),e.s=n,r.s*=n):r=b(this,e,0,P),(e=this.minus(r.times(e))).c[0]||1!=P||(e.s=this.s),e):new L(this):new L(NaN)},T.multipliedBy=T.times=function(e,t){var r,n,i,s,o,a,l,c,u,d,h,f,m,g=this.c,y=(e=new L(e,t)).c;if(!g||!y||!g[0]||!y[0])return this.s&&e.s&&(!g||g[0]||y)&&(!y||y[0]||g)?(e.s*=this.s,g&&y?(e.c=[0],e.e=0):e.c=e.e=null):e.c=e.e=e.s=null,e;for(n=p(this.e/14)+p(e.e/14),e.s*=this.s,(l=g.length)<(d=y.length)&&(m=g,g=y,y=m,i=l,l=d,d=i),i=l+d,m=[];i--;m.push(0));for(i=d;--i>=0;){for(r=0,h=y[i]%1e7,f=y[i]/1e7|0,s=i+(o=l);s>i;)a=f*(c=g[--o]%1e7)+(u=g[o]/1e7|0)*h,r=((c=h*c+a%1e7*1e7+m[s]+r)/1e14|0)+(a/1e7|0)+f*u,m[s--]=c%1e14;m[s]=r}return r?++n:m.splice(0,1),F(e,m,n)},T.negated=function(){var e=new L(this);return e.s=-e.s||null,e},T.plus=function(e,t){var r,n=this.s;if(t=(e=new L(e,t)).s,!n||!t)return new L(NaN);if(n!=t)return e.s=-t,this.minus(e);var i=this.e/14,s=e.e/14,o=this.c,a=e.c;if(!i||!s){if(!o||!a)return new L(n/0);if(!o[0]||!a[0])return a[0]?e:new L(o[0]?this:0*n)}if(i=p(i),s=p(s),o=o.slice(),n=i-s){for(n>0?(s=i,r=a):(n=-n,r=o),r.reverse();n--;r.push(0));r.reverse()}for((n=o.length)-(t=a.length)<0&&(r=a,a=o,o=r,t=n),n=0;t;)n=(o[--t]=o[t]+a[t]+n)/1e14|0,o[t]=1e14===o[t]?0:o[t]%1e14;return n&&(o=[n].concat(o),++s),F(e,o,s)},T.precision=T.sd=function(e,t){var r,n,i;if(null!=e&&!!e!==e)return m(e,1,1e9),null==t?t=w:m(t,0,8),B(new L(this),e,t);if(!(r=this.c))return null;if(n=14*(i=r.length-1)+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&this.e+1>n&&(n=this.e+1),n},T.shiftedBy=function(e){return m(e,-9007199254740991,9007199254740991),this.times("1e"+e)},T.squareRoot=T.sqrt=function(){var e,t,r,n,i,s=this.c,o=this.s,a=this.e,l=C+4,c=new L("0.5");if(1!==o||!s||!s[0])return new L(!o||o<0&&(!s||s[0])?NaN:s?this:1/0);if(0==(o=Math.sqrt(+H(this)))||o==1/0?(((t=h(s)).length+a)%2==0&&(t+="0"),o=Math.sqrt(+t),a=p((a+1)/2)-(a<0||a%2),r=new L(t=o==1/0?"5e"+a:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+a)):r=new L(o+""),r.c[0]){for((o=(a=r.e)+l)<3&&(o=0);;)if(i=r,r=c.times(i.plus(b(this,i,l,1))),h(i.c).slice(0,o)===(t=h(r.c)).slice(0,o)){if(r.e<a&&--o,"9999"!=(t=t.slice(o-3,o+1))&&(n||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(B(r,r.e+C+2,1),e=!r.times(r).eq(this));break}if(!n&&(B(i,i.e+C+2,0),i.times(i).eq(this))){r=i;break}l+=4,o+=4,n=1}}return B(r,r.e+C+1,w,e)},T.toExponential=function(e,t){return null!=e&&(m(e,0,1e9),e++),G(this,e,t,1)},T.toFixed=function(e,t){return null!=e&&(m(e,0,1e9),e=e+this.e+1),G(this,e,t)},T.toFormat=function(e,t,r){var n;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=D;else if("object"!=typeof r)throw Error(c+"Argument not an object: "+r);if(n=this.toFixed(e,t),this.c){var i,s=n.split("."),o=+r.groupSize,a=+r.secondaryGroupSize,l=r.groupSeparator||"",u=s[0],d=s[1],p=this.s<0,h=p?u.slice(1):u,f=h.length;if(a&&(i=o,o=a,a=i,f-=i),o>0&&f>0){for(i=f%o||o,u=h.substr(0,i);i<f;i+=o)u+=l+h.substr(i,o);a>0&&(u+=l+h.slice(i)),p&&(u="-"+u)}n=d?u+(r.decimalSeparator||"")+((a=+r.fractionGroupSize)?d.replace(RegExp("\\d{"+a+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):d):u}return(r.prefix||"")+n+(r.suffix||"")},T.toFraction=function(e){var t,r,n,i,s,o,a,l,u,p,f,m,g=this.c;if(null!=e&&(!(a=new L(e)).isInteger()&&(a.c||1!==a.s)||a.lt(S)))throw Error(c+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+H(a));if(!g)return new L(this);for(t=new L(S),u=r=new L(S),n=l=new L(S),m=h(g),s=t.e=m.length-this.e-1,t.c[0]=d[(o=s%14)<0?14+o:o],e=!e||a.comparedTo(t)>0?s>0?t:u:a,o=k,k=1/0,a=new L(m),l.c[0]=0;p=b(a,t,0,1),1!=(i=r.plus(p.times(n))).comparedTo(e);)r=n,n=i,u=l.plus(p.times(i=u)),l=i,t=a.minus(p.times(i=t)),a=i;return i=b(e.minus(r),n,0,1),l=l.plus(i.times(u)),r=r.plus(i.times(n)),l.s=u.s=this.s,s*=2,f=1>b(u,n,s,w).minus(this).abs().comparedTo(b(l,r,s,w).minus(this).abs())?[u,n]:[l,r],k=o,f},T.toNumber=function(){return+H(this)},T.toPrecision=function(e,t){return null!=e&&m(e,1,1e9),G(this,e,t,2)},T.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=O||i>=I?y(h(r.c),i):v(h(r.c),i,"0"):10===e&&M?t=v(h((r=B(new L(r),C+i+1,w)).c),r.e,"0"):(m(e,2,U.length,"Base"),t=x(v(h(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},T.valueOf=T.toJSON=function(){return H(this)},T._isBigNumber=!0,null!=t&&L.set(t),L}()).default=s.BigNumber=s,void 0!==(n=(function(){return s}).call(t,r,t,e))&&(e.exports=n)}(0)},29916:(e,t,r)=>{"use strict";var n=r(78893).Buffer,i=r(78893).SlowBuffer;function s(e,t){if(!n.isBuffer(e)||!n.isBuffer(t)||e.length!==t.length)return!1;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}e.exports=s,s.install=function(){n.prototype.equal=i.prototype.equal=function(e){return s(this,e)}};var o=n.prototype.equal,a=i.prototype.equal;s.restore=function(){n.prototype.equal=o,i.prototype.equal=a}},3164:(e,t,r)=>{"use strict";var n=r(90892).Buffer,i=r(21887);function s(e){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function o(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=128&&--n,n}e.exports={derToJose:function(e,t){e=s(e);var r=i(t),o=r+1,a=e.length,l=0;if(48!==e[l++])throw Error('Could not find expected "seq"');var c=e[l++];if(129===c&&(c=e[l++]),a-l<c)throw Error('"seq" specified length of "'+c+'", only "'+(a-l)+'" remaining');if(2!==e[l++])throw Error('Could not find expected "int" for "r"');var u=e[l++];if(a-l-2<u)throw Error('"r" specified length of "'+u+'", only "'+(a-l-2)+'" available');if(o<u)throw Error('"r" specified length of "'+u+'", max of "'+o+'" is acceptable');var d=l;if(l+=u,2!==e[l++])throw Error('Could not find expected "int" for "s"');var p=e[l++];if(a-l!==p)throw Error('"s" specified length of "'+p+'", expected "'+(a-l)+'"');if(o<p)throw Error('"s" specified length of "'+p+'", max of "'+o+'" is acceptable');var h=l;if((l+=p)!==a)throw Error('Expected to consume entire buffer, but "'+(a-l)+'" bytes remain');var f=r-u,m=r-p,g=n.allocUnsafe(f+u+m+p);for(l=0;l<f;++l)g[l]=0;e.copy(g,l,d+Math.max(-f,0),d+u),l=r;for(var y=l;l<y+m;++l)g[l]=0;return e.copy(g,l,h+Math.max(-m,0),h+p),g=(g=g.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=s(e);var r=i(t),a=e.length;if(a!==2*r)throw TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+a+'"');var l=o(e,0,r),c=o(e,r,e.length),u=r-l,d=r-c,p=2+u+1+1+d,h=p<128,f=n.allocUnsafe((h?2:3)+p),m=0;return f[m++]=48,h?f[m++]=p:(f[m++]=129,f[m++]=255&p),f[m++]=2,f[m++]=u,l<0?(f[m++]=0,m+=e.copy(f,m,0,r)):m+=e.copy(f,m,l,r),f[m++]=2,f[m++]=d,c<0?(f[m++]=0,e.copy(f,m,r)):e.copy(f,m,r+c),f}}},21887:e=>{"use strict";function t(e){return(e/8|0)+(e%8==0?0:1)}var r={ES256:t(256),ES384:t(384),ES512:t(521)};e.exports=function(e){var t=r[e];if(t)return t;throw Error('Unknown algorithm "'+e+'"')}},71771:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===r.call(e)},o=function(e){if(!e||"[object Object]"!==r.call(e))return!1;var n,i=t.call(e,"constructor"),s=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!i&&!s)return!1;for(n in e);return void 0===n||t.call(e,n)},a=function(e,t){n&&"__proto__"===t.name?n(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},l=function(e,r){if("__proto__"===r){if(!t.call(e,r))return;if(i)return i(e,r).value}return e[r]};e.exports=function e(){var t,r,n,i,c,u,d=arguments[0],p=1,h=arguments.length,f=!1;for("boolean"==typeof d&&(f=d,d=arguments[1]||{},p=2),(null==d||"object"!=typeof d&&"function"!=typeof d)&&(d={});p<h;++p)if(t=arguments[p],null!=t)for(r in t)n=l(d,r),d!==(i=l(t,r))&&(f&&i&&(o(i)||(c=s(i)))?(c?(c=!1,u=n&&s(n)?n:[]):u=n&&o(n)?n:{},a(d,{name:r,newValue:e(f,u,i)})):void 0!==i&&a(d,{name:r,newValue:i}));return d}},41779:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GaxiosError=t.GAXIOS_ERROR_SYMBOL=void 0,t.defaultErrorRedactor=function e(t){let r="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function n(e){e&&e.forEach((t,n)=>{(/^authentication$/i.test(n)||/^authorization$/i.test(n)||/secret/i.test(n))&&e.set(n,r)})}function i(e,t){if("object"==typeof e&&null!==e&&"string"==typeof e[t]){let n=e[t];(/grant_type=/i.test(n)||/assertion=/i.test(n)||/secret/i.test(n))&&(e[t]=r)}}function s(e){e&&"object"==typeof e&&(e instanceof FormData||e instanceof URLSearchParams||"forEach"in e&&"set"in e?e.forEach((t,n)=>{(["grant_type","assertion"].includes(n)||/secret/.test(n))&&e.set(n,r)}):("grant_type"in e&&(e.grant_type=r),"assertion"in e&&(e.assertion=r),"client_secret"in e&&(e.client_secret=r)))}return t.config&&(n(t.config.headers),i(t.config,"data"),s(t.config.data),i(t.config,"body"),s(t.config.body),t.config.url.searchParams.has("token")&&t.config.url.searchParams.set("token",r),t.config.url.searchParams.has("client_secret")&&t.config.url.searchParams.set("client_secret",r)),t.response&&(e({config:t.response.config}),n(t.response.headers),t.response.bodyUsed&&(i(t.response,"data"),s(t.response.data))),t};let i=n(r(71771)),s=n(r(15506)).default.pkg;t.GAXIOS_ERROR_SYMBOL=Symbol.for(`${s.name}-gaxios-error`);class o extends Error{config;response;code;status;error;[t.GAXIOS_ERROR_SYMBOL]=s.version;static[Symbol.hasInstance](e){return!!e&&"object"==typeof e&&t.GAXIOS_ERROR_SYMBOL in e&&e[t.GAXIOS_ERROR_SYMBOL]===s.version||Function.prototype[Symbol.hasInstance].call(o,e)}constructor(e,t,r,n){if(super(e,{cause:n}),this.config=t,this.response=r,this.error=n instanceof Error?n:void 0,this.config=(0,i.default)(!0,{},t),this.response&&(this.response.config=(0,i.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(e,t){switch(e){case"stream":default:return t;case"json":return JSON.parse(JSON.stringify(t));case"arraybuffer":return JSON.parse(Buffer.from(t).toString("utf8"));case"blob":return JSON.parse(t.text())}}(this.config.responseType,this.response?.bodyUsed?this.response?.data:void 0)}catch{}this.status=this.response.status}n instanceof DOMException?this.code=n.name:n&&"object"==typeof n&&"code"in n&&("string"==typeof n.code||"number"==typeof n.code)&&(this.code=n.code)}static extractAPIErrorFromResponse(e,t="The request failed"){let r=t;if("string"==typeof e.data&&(r=e.data),e.data&&"object"==typeof e.data&&"error"in e.data&&e.data.error&&!e.ok){if("string"==typeof e.data.error)return{message:e.data.error,code:e.status,status:e.statusText};if("object"==typeof e.data.error){r="message"in e.data.error&&"string"==typeof e.data.error.message?e.data.error.message:r;let t="status"in e.data.error&&"string"==typeof e.data.error.status?e.data.error.status:e.statusText,n="code"in e.data.error&&"number"==typeof e.data.error.code?e.data.error.code:e.status;if("errors"in e.data.error&&Array.isArray(e.data.error.errors)){let i=[];for(let t of e.data.error.errors)"object"==typeof t&&"message"in t&&"string"==typeof t.message&&i.push(t.message);return Object.assign({message:i.join("\n")||r,code:n,status:t},e.data.error)}return Object.assign({message:r,code:n,status:t},e.data.error)}}return{message:r,code:e.status,status:e.statusText}}}t.GaxiosError=o},67622:function(e,t,r){"use strict";var n,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Gaxios=void 0;let s=i(r(71771)),o=r(35240),a=r(41779),l=r(41544),c=r(76162),u=r(24377),d=async()=>globalThis.crypto?.randomUUID()||(await Promise.resolve().then(r.t.bind(r,84770,23))).randomUUID();class p{agentCache=new Map;defaults;interceptors;constructor(e){this.defaults=e||{},this.interceptors={request:new u.GaxiosInterceptorManager,response:new u.GaxiosInterceptorManager}}fetch(...e){let t;let r=e[0],i=e[1],s=new Headers;return("string"==typeof r?t=new URL(r):r instanceof URL?t=r:r&&r.url&&(t=new URL(r.url)),r&&"object"==typeof r&&"headers"in r&&n.mergeHeaders(s,r.headers),i&&n.mergeHeaders(s,new Headers(i.headers)),"object"!=typeof r||r instanceof URL)?this.request({...i,headers:s,url:t}):this.request({...i,...r,headers:s,url:t})}async request(e={}){let t=await this.#e(e);return t=await this.#t(t),this.#r(this._request(t))}async _defaultAdapter(e){let t=e.fetchImplementation||this.defaults.fetchImplementation||await n.#n(),r={...e};delete r.data;let i=await t(e.url,r),s=await this.getResponseData(e,i);return Object.getOwnPropertyDescriptor(i,"data")?.configurable||Object.defineProperties(i,{data:{configurable:!0,writable:!0,enumerable:!0,value:s}}),Object.assign(i,{config:e,data:s})}async _request(e){try{let t;if(t=e.adapter?await e.adapter(e,this._defaultAdapter.bind(this)):await this._defaultAdapter(e),!e.validateStatus(t.status)){if("stream"===e.responseType){let e=[];for await(let r of t.data)e.push(r);t.data=e.toString()}let r=a.GaxiosError.extractAPIErrorFromResponse(t,`Request failed with status code ${t.status}`);throw new a.GaxiosError(r?.message,e,t,r)}return t}catch(i){let t;t=i instanceof a.GaxiosError?i:i instanceof Error?new a.GaxiosError(i.message,e,void 0,i):new a.GaxiosError("Unexpected Gaxios Error",e,void 0,i);let{shouldRetry:r,config:n}=await (0,l.getRetryConfig)(t);if(r&&n)return t.config.retryConfig.currentRetryAttempt=n.retryConfig.currentRetryAttempt,e.retryConfig=t.config?.retryConfig,this.#i(e),this._request(e);throw e.errorRedactor&&e.errorRedactor(t),t}}async getResponseData(e,t){if(e.maxContentLength&&t.headers.has("content-length")&&e.maxContentLength<Number.parseInt(t.headers?.get("content-length")||""))throw new a.GaxiosError("Response's `Content-Length` is over the limit.",e,Object.assign(t,{config:e}));switch(e.responseType){case"stream":return t.body;case"json":return t.json();case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"text":return t.text();default:return this.getResponseDataFromContentType(t)}}#s(e,t=[]){let r=new URL(e),n=[...t];for(let e of(process.env.NO_PROXY??process.env.no_proxy)?.split(",")||[])n.push(e.trim());for(let e of n)if(e instanceof RegExp){if(e.test(r.toString()))return!1}else if(e instanceof URL){if(e.origin===r.origin)return!1}else if(e.startsWith("*.")||e.startsWith(".")){let t=e.replace(/^\*\./,".");if(r.hostname.endsWith(t))return!1}else if(e===r.origin||e===r.hostname||e===r.href)return!1;return!0}async #t(e){let t=Promise.resolve(e);for(let e of this.interceptors.request.values())e&&(t=t.then(e.resolved,e.rejected));return t}async #r(e){let t=Promise.resolve(e);for(let e of this.interceptors.response.values())e&&(t=t.then(e.resolved,e.rejected));return t}async #e(e){let t=new Headers(this.defaults.headers);n.mergeHeaders(t,e.headers);let r=(0,s.default)(!0,{},this.defaults,e);if(!r.url)throw Error("URL is required.");if(r.baseURL&&(r.url=new URL(r.url,r.baseURL)),r.url=new URL(r.url),r.params){if(r.paramsSerializer){let e=r.paramsSerializer(r.params);e.startsWith("?")&&(e=e.slice(1));let t=r.url.toString().includes("?")?"&":"?";r.url=r.url+t+e}else{let e=r.url instanceof URL?r.url:new URL(r.url);for(let[t,n]of new URLSearchParams(r.params))e.searchParams.append(t,n);r.url=e}}"number"==typeof e.maxContentLength&&(r.size=e.maxContentLength),"number"==typeof e.maxRedirects&&(r.follow=e.maxRedirects);let i="string"==typeof r.data||r.data instanceof ArrayBuffer||r.data instanceof Blob||globalThis.File&&r.data instanceof File||r.data instanceof FormData||r.data instanceof c.Readable||r.data instanceof ReadableStream||r.data instanceof String||r.data instanceof URLSearchParams||ArrayBuffer.isView(r.data)||["Blob","File","FormData"].includes(r.data?.constructor?.name||"");if(r.multipart?.length){let e=await d();t.set("content-type",`multipart/related; boundary=${e}`),r.body=c.Readable.from(this.getMultipartRequest(r.multipart,e))}else i?r.body=r.data:"object"==typeof r.data?"application/x-www-form-urlencoded"===t.get("Content-Type")?r.body=r.paramsSerializer?r.paramsSerializer(r.data):new URLSearchParams(r.data):(t.has("content-type")||t.set("content-type","application/json"),r.body=JSON.stringify(r.data)):r.data&&(r.body=r.data);r.validateStatus=r.validateStatus||this.validateStatus,r.responseType=r.responseType||"unknown",t.has("accept")||"json"!==r.responseType||t.set("accept","application/json");let l=r.proxy||process?.env?.HTTPS_PROXY||process?.env?.https_proxy||process?.env?.HTTP_PROXY||process?.env?.http_proxy;if(r.agent);else if(l&&this.#s(r.url,r.noProxy)){let e=await n.#o();this.agentCache.has(l)?r.agent=this.agentCache.get(l):(r.agent=new e(l,{cert:r.cert,key:r.key}),this.agentCache.set(l,r.agent))}else r.cert&&r.key&&(this.agentCache.has(r.key)?r.agent=this.agentCache.get(r.key):(r.agent=new o.Agent({cert:r.cert,key:r.key}),this.agentCache.set(r.key,r.agent)));return"function"!=typeof r.errorRedactor&&!1!==r.errorRedactor&&(r.errorRedactor=a.defaultErrorRedactor),!r.body||"duplex"in r||(r.duplex="half"),this.#i(r),Object.assign(r,{headers:t,url:r.url instanceof URL?r.url:new URL(r.url)})}#i(e){if(e.timeout){let t=AbortSignal.timeout(e.timeout);e.signal&&!e.signal.aborted?e.signal=AbortSignal.any([e.signal,t]):e.signal=t}}validateStatus(e){return e>=200&&e<300}async getResponseDataFromContentType(e){let t=e.headers.get("Content-Type");if(null===t)return e.text();if((t=t.toLowerCase()).includes("application/json")){let t=await e.text();try{t=JSON.parse(t)}catch{}return t}return t.match(/^text\//)?e.text():e.blob()}async *getMultipartRequest(e,t){let r=`--${t}--`;for(let r of e){let e=r.headers.get("Content-Type")||"application/octet-stream",n=`--${t}\r
Content-Type: ${e}\r
\r
`;yield n,"string"==typeof r.content?yield r.content:yield*r.content,yield"\r\n"}yield r}static #a;static #l;static async #o(){return this.#a||=(await r.e(322).then(r.t.bind(r,58322,23))).HttpsProxyAgent,this.#a}static async #n(){let e="undefined"!=typeof window&&!!window;return this.#l||=e?window.fetch:(await r.e(472).then(r.bind(r,84472))).default,this.#l}static mergeHeaders(e,...t){for(let r of(e=e instanceof Headers?e:new Headers(e),t))(r instanceof Headers?r:new Headers(r)).forEach((t,r)=>{"set-cookie"===r?e.append(r,t):e.set(r,t)});return e}}t.Gaxios=p,n=p},90206:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.instance=t.Gaxios=t.GaxiosError=void 0,t.request=a;let s=r(67622);Object.defineProperty(t,"Gaxios",{enumerable:!0,get:function(){return s.Gaxios}});var o=r(41779);async function a(e){return t.instance.request(e)}Object.defineProperty(t,"GaxiosError",{enumerable:!0,get:function(){return o.GaxiosError}}),i(r(24377),t),t.instance=new s.Gaxios},24377:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GaxiosInterceptorManager=void 0;class r extends Set{}t.GaxiosInterceptorManager=r},41544:(e,t)=>{"use strict";async function r(e){var t;let r=i(e);if(!e||!e.config||!r&&!e.config.retry)return{shouldRetry:!1};(r=r||{}).currentRetryAttempt=r.currentRetryAttempt||0,r.retry=void 0===r.retry||null===r.retry?3:r.retry,r.httpMethodsToRetry=r.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],r.noResponseRetries=void 0===r.noResponseRetries||null===r.noResponseRetries?2:r.noResponseRetries,r.retryDelayMultiplier=r.retryDelayMultiplier?r.retryDelayMultiplier:2,r.timeOfFirstRequest=r.timeOfFirstRequest?r.timeOfFirstRequest:Date.now(),r.totalTimeout=r.totalTimeout?r.totalTimeout:Number.MAX_SAFE_INTEGER,r.maxRetryDelay=r.maxRetryDelay?r.maxRetryDelay:Number.MAX_SAFE_INTEGER,r.statusCodesToRetry=r.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],e.config.retryConfig=r;let s=r.shouldRetry||n;if(!await s(e))return{shouldRetry:!1,config:e.config};let o=Math.min(((t=r).currentRetryAttempt?0:t.retryDelay??100)+(Math.pow(t.retryDelayMultiplier,t.currentRetryAttempt)-1)/2*1e3,t.totalTimeout-(Date.now()-t.timeOfFirstRequest),t.maxRetryDelay);e.config.retryConfig.currentRetryAttempt+=1;let a=r.retryBackoff?r.retryBackoff(e,o):new Promise(e=>{setTimeout(e,o)});return r.onRetryAttempt&&await r.onRetryAttempt(e),await a,{shouldRetry:!0,config:e.config}}function n(e){let t=i(e);if(e.config.signal?.aborted&&"TimeoutError"!==e.code||"AbortError"===e.code||!t||0===t.retry||!e.response&&(t.currentRetryAttempt||0)>=t.noResponseRetries||!t.httpMethodsToRetry||!t.httpMethodsToRetry.includes(e.config.method?.toUpperCase()||"GET"))return!1;if(e.response&&e.response.status){let r=!1;for(let[n,i]of t.statusCodesToRetry){let t=e.response.status;if(t>=n&&t<=i){r=!0;break}}if(!r)return!1}return t.currentRetryAttempt=t.currentRetryAttempt||0,!(t.currentRetryAttempt>=t.retry)}function i(e){if(e&&e.config&&e.config.retryConfig)return e.config.retryConfig}Object.defineProperty(t,"__esModule",{value:!0}),t.getRetryConfig=r},56621:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthClient=t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=t.DEFAULT_UNIVERSE=void 0;let n=r(17702),i=r(90206),s=r(86538),o=r(15348),a=r(14574);t.DEFAULT_UNIVERSE="googleapis.com",t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class l extends n.EventEmitter{apiKey;projectId;quotaProjectId;transporter;credentials={};eagerRefreshThresholdMillis=t.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS;forceRefreshOnFailure=!1;universeDomain=t.DEFAULT_UNIVERSE;static RequestMethodNameSymbol=Symbol("request method name");static RequestLogIdSymbol=Symbol("request log id");constructor(e={}){super();let r=(0,s.originalOrCamelOptions)(e);this.apiKey=e.apiKey,this.projectId=r.get("project_id")??null,this.quotaProjectId=r.get("quota_project_id"),this.credentials=r.get("credentials")??{},this.universeDomain=r.get("universe_domain")??t.DEFAULT_UNIVERSE,this.transporter=e.transporter??new i.Gaxios(e.transporterOptions),!1!==r.get("useAuthRequestParameters")&&(this.transporter.interceptors.request.add(l.DEFAULT_REQUEST_INTERCEPTOR),this.transporter.interceptors.response.add(l.DEFAULT_RESPONSE_INTERCEPTOR)),e.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=e.forceRefreshOnFailure??!1}fetch(...e){let t;let r=e[0],n=e[1],s=new Headers;return("string"==typeof r?t=new URL(r):r instanceof URL?t=r:r&&r.url&&(t=new URL(r.url)),r&&"object"==typeof r&&"headers"in r&&i.Gaxios.mergeHeaders(s,r.headers),n&&i.Gaxios.mergeHeaders(s,new Headers(n.headers)),"object"!=typeof r||r instanceof URL)?this.request({...n,headers:s,url:t}):this.request({...n,...r,headers:s,url:t})}setCredentials(e){this.credentials=e}addSharedMetadataHeaders(e){return!e.has("x-goog-user-project")&&this.quotaProjectId&&e.set("x-goog-user-project",this.quotaProjectId),e}addUserProjectAndAuthHeaders(e,t){let r=t.get("x-goog-user-project"),n=t.get("authorization");return r&&e.set("x-goog-user-project",r),n&&e.set("authorization",n),e}static log=(0,o.log)("auth");static DEFAULT_REQUEST_INTERCEPTOR={resolved:async e=>{if(!e.headers.has("x-goog-api-client")){let t=process.version.replace(/^v/,"");e.headers.set("x-goog-api-client",`gl-node/${t}`)}let t=e.headers.get("User-Agent");t?t.includes(`${a.PRODUCT_NAME}/`)||e.headers.set("User-Agent",`${t} ${a.USER_AGENT}`):e.headers.set("User-Agent",a.USER_AGENT);try{let t=e[l.RequestMethodNameSymbol],r=`${Math.floor(1e3*Math.random())}`;e[l.RequestLogIdSymbol]=r;let n={url:e.url,headers:e.headers};t?l.log.info("%s [%s] request %j",t,r,n):l.log.info("[%s] request %j",r,n)}catch(e){}return e}};static DEFAULT_RESPONSE_INTERCEPTOR={resolved:async e=>{try{let t=e.config,r=t[l.RequestMethodNameSymbol],n=t[l.RequestLogIdSymbol];r?l.log.info("%s [%s] response %j",r,n,e.data):l.log.info("[%s] response %j",n,e.data)}catch(e){}return e},rejected:async e=>{try{let t=e.config,r=t[l.RequestMethodNameSymbol],n=t[l.RequestLogIdSymbol];r?l.log.info("%s [%s] error %j",r,n,e.response?.data):l.log.error("[%s] error %j",n,e.response?.data)}catch(e){}throw e}};static setMethodName(e,t){try{e[l.RequestMethodNameSymbol]=t}catch(e){}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}t.AuthClient=l},63321:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsClient=void 0;let n=r(43676),i=r(83318),s=r(29038),o=r(86538),a=r(90206);class l extends i.BaseExternalAccountClient{environmentId;awsSecurityCredentialsSupplier;regionalCredVerificationUrl;awsRequestSigner;region;static #c="https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15";static AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";static AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254";constructor(e){super(e);let t=(0,o.originalOrCamelOptions)(e),r=t.get("credential_source"),n=t.get("aws_security_credentials_supplier");if(!r&&!n)throw Error("A credential source or AWS security credentials supplier must be specified.");if(r&&n)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(n)this.awsSecurityCredentialsSupplier=n,this.regionalCredVerificationUrl=l.#c,this.credentialSourceType="programmatic";else{let e=(0,o.originalOrCamelOptions)(r);this.environmentId=e.get("environment_id");let t=e.get("region_url"),n=e.get("url"),i=e.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new s.DefaultAwsSecurityCredentialsSupplier({regionUrl:t,securityCredentialsUrl:n,imdsV2SessionTokenUrl:i}),this.regionalCredVerificationUrl=e.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){let e=this.environmentId?.match(/^(aws)(\d+)$/);if(e&&this.regionalCredVerificationUrl){if(1!==parseInt(e[2],10))throw Error(`aws version "${e[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new n.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let e=await this.awsRequestSigner.getRequestOptions({...l.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),t=[];return a.Gaxios.mergeHeaders({"x-goog-cloud-target-resource":this.audience},e.headers).forEach((e,r)=>t.push({key:r,value:e})),encodeURIComponent(JSON.stringify({url:e.url,method:e.method,headers:t}))}}t.AwsClient=l},43676:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsRequestSigner=void 0;let n=r(90206),i=r(10537),s="AWS4-HMAC-SHA256";class o{getCredentials;region;crypto;constructor(e,t){this.getCredentials=e,this.region=t,this.crypto=(0,i.createCrypto)()}async getRequestOptions(e){if(!e.url)throw RangeError('"url" is required in "amzOptions"');let t="object"==typeof e.data?JSON.stringify(e.data):e.data,r=e.url,i=e.method||"GET",s=e.body||t,o=e.headers,a=await this.getCredentials(),l=new URL(r);if("string"!=typeof s&&void 0!==s)throw TypeError(`'requestPayload' is expected to be a string if provided. Got: ${s}`);let u=await c({crypto:this.crypto,host:l.host,canonicalUri:l.pathname,canonicalQuerystring:l.search.slice(1),method:i,region:this.region,securityCredentials:a,requestPayload:s,additionalAmzHeaders:o}),d=n.Gaxios.mergeHeaders(u.amzDate?{"x-amz-date":u.amzDate}:{},{authorization:u.authorizationHeader,host:l.host},o||{});a.token&&n.Gaxios.mergeHeaders(d,{"x-amz-security-token":a.token});let p={url:r,method:i,headers:d};return void 0!==s&&(p.body=s),p}}async function a(e,t,r){return await e.signWithHmacSha256(t,r)}async function l(e,t,r,n,i){let s=await a(e,`AWS4${t}`,r),o=await a(e,s,n),l=await a(e,o,i);return await a(e,l,"aws4_request")}async function c(e){let t=n.Gaxios.mergeHeaders(e.additionalAmzHeaders),r=e.requestPayload||"",o=e.host.split(".")[0],c=new Date,u=c.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),d=c.toISOString().replace(/[-]/g,"").replace(/T.*/,"");e.securityCredentials.token&&t.set("x-amz-security-token",e.securityCredentials.token);let p=n.Gaxios.mergeHeaders({host:e.host},t.has("date")?{}:{"x-amz-date":u},t),h="",f=[...p.keys()].sort();f.forEach(e=>{h+=`${e}:${p.get(e)}
`});let m=f.join(";"),g=await e.crypto.sha256DigestHex(r),y=`${e.method.toUpperCase()}
${e.canonicalUri}
${e.canonicalQuerystring}
${h}
${m}
${g}`,v=`${d}/${e.region}/${o}/aws4_request`,_=`${s}
${u}
${v}
`+await e.crypto.sha256DigestHex(y),E=await l(e.crypto,e.securityCredentials.secretAccessKey,d,e.region,o),b=await a(e.crypto,E,_),x=`${s} Credential=${e.securityCredentials.accessKeyId}/${v}, SignedHeaders=${m}, Signature=${(0,i.fromArrayBufferToHex)(b)}`;return{amzDate:t.has("date")?void 0:u,authorizationHeader:x,canonicalQuerystring:e.canonicalQuerystring}}t.AwsRequestSigner=o},83318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseExternalAccountClient=t.CLOUD_RESOURCE_MANAGER=t.EXTERNAL_ACCOUNT_TYPE=t.EXPIRATION_TIME_OFFSET=void 0;let n=r(90206),i=r(76162),s=r(56621),o=r(50984),a=r(86538),l=r(14574),c="https://www.googleapis.com/auth/cloud-platform";t.EXPIRATION_TIME_OFFSET=3e5,t.EXTERNAL_ACCOUNT_TYPE="external_account",t.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";class u extends s.AuthClient{scopes;projectNumber;audience;subjectTokenType;stsCredential;clientAuth;credentialSourceType;cachedAccessToken;serviceAccountImpersonationUrl;serviceAccountImpersonationLifetime;workforcePoolUserProject;configLifetimeRequested;tokenUrl;cloudResourceManagerURL;supplierContext;#u=null;constructor(e){super(e);let r=(0,a.originalOrCamelOptions)(e),n=r.get("type");if(n&&n!==t.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${t.EXTERNAL_ACCOUNT_TYPE}" type but received "${e.type}"`);let i=r.get("client_id"),s=r.get("client_secret");this.tokenUrl=r.get("token_url")??"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain);let l=r.get("subject_token_type"),u=r.get("workforce_pool_user_project"),d=r.get("service_account_impersonation_url"),p=r.get("service_account_impersonation"),h=(0,a.originalOrCamelOptions)(p).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(r.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),i&&(this.clientAuth={confidentialClientType:"basic",clientId:i,clientSecret:s}),this.stsCredential=new o.StsCredentials({tokenExchangeEndpoint:this.tokenUrl,clientAuthentication:this.clientAuth}),this.scopes=r.get("scopes")||[c],this.cachedAccessToken=null,this.audience=r.get("audience"),this.subjectTokenType=l,this.workforcePoolUserProject=u;let f=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(f))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=d,this.serviceAccountImpersonationLifetime=h,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let e=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return e?.groups?.email||null}return null}setCredentials(e){super.setCredentials(e),this.cachedAccessToken=e}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t=new Headers({authorization:`Bearer ${e.token}`});return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async getProjectId(){let e=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(e){let t=await this.getRequestHeaders(),r={...u.RETRY_CONFIG,headers:t,url:`${this.cloudResourceManagerURL.toString()}${e}`};s.AuthClient.setMethodName(r,"getProjectId");let n=await this.transporter.request(r);return this.projectId=n.data.projectId,this.projectId}return null}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=n.Gaxios.mergeHeaders(e.headers),this.addUserProjectAndAuthHeaders(e.headers,t),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,s=r.config.data instanceof i.Readable;if(!t&&(401===n||403===n)&&!s&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw n}return r}async refreshAccessTokenAsync(){this.#u=this.#u||this.#d();try{return await this.#u}finally{this.#u=null}}async #d(){let e=await this.retrieveSubjectToken(),t={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:e,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[c]:this.getScopesArray()},r=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,n=new Headers({"x-goog-api-client":this.getMetricsHeaderValue()}),i=await this.stsCredential.exchangeToken(t,n,r);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(i.access_token):i.expires_in?this.cachedAccessToken={access_token:i.access_token,expiry_date:new Date().getTime()+1e3*i.expires_in,res:i.res}:this.cachedAccessToken={access_token:i.access_token,res:i.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}getProjectNumber(e){let t=e.match(/\/projects\/([^/]+)/);return t?t[1]:null}async getImpersonatedAccessToken(e){let t={...u.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${e}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"}};s.AuthClient.setMethodName(t,"getImpersonatedAccessToken");let r=await this.transporter.request(t),n=r.data;return{access_token:n.accessToken,expiry_date:new Date(n.expireTime).getTime(),res:r}}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[c]}getMetricsHeaderValue(){let e=process.version.replace(/^v/,""),t=void 0!==this.serviceAccountImpersonationUrl,r=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${e} auth/${l.pkg.version} google-byoid-sdk source/${r} sa-impersonation/${t} config-lifetime/${this.configLifetimeRequested}`}getTokenUrl(){return this.tokenUrl}}t.BaseExternalAccountClient=u},88332:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CertificateSubjectTokenSupplier=t.InvalidConfigurationError=t.CertificateSourceUnavailableError=t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE=void 0;let n=r(86538),i=r(92048),s=r(84770),o=r(35240);t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE="GOOGLE_API_CERTIFICATE_CONFIG";class a extends Error{constructor(e){super(e),this.name="CertificateSourceUnavailableError"}}t.CertificateSourceUnavailableError=a;class l extends Error{constructor(e){super(e),this.name="InvalidConfigurationError"}}t.InvalidConfigurationError=l;class c{certificateConfigPath;trustChainPath;cert;key;constructor(e){if(!e.useDefaultCertificateConfig&&!e.certificateConfigLocation)throw new l("Either `useDefaultCertificateConfig` must be true or a `certificateConfigLocation` must be provided.");if(e.useDefaultCertificateConfig&&e.certificateConfigLocation)throw new l("Both `useDefaultCertificateConfig` and `certificateConfigLocation` cannot be provided.");this.trustChainPath=e.trustChainPath,this.certificateConfigPath=e.certificateConfigLocation??""}async createMtlsHttpsAgent(){if(!this.key||!this.cert)throw new l("Cannot create mTLS Agent with missing certificate or key");return new o.Agent({key:this.key,cert:this.cert})}async getSubjectToken(){this.certificateConfigPath=await this.#p();let{certPath:e,keyPath:t}=await this.#h();return{cert:this.cert,key:this.key}=await this.#f(e,t),await this.#m(this.cert)}async #p(){let e=this.certificateConfigPath;if(e){if(await (0,n.isValidFile)(e))return e;throw new a(`Provided certificate config path is invalid: ${e}`)}let r=process.env[t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE];if(r){if(await (0,n.isValidFile)(r))return r;throw new a(`Path from environment variable "${t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" is invalid: ${r}`)}let i=(0,n.getWellKnownCertificateConfigFileLocation)();if(await (0,n.isValidFile)(i))return i;throw new a(`Could not find certificate configuration file. Searched override path, the "${t.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" env var, and the gcloud path (${i}).`)}async #h(){let e;let t=this.certificateConfigPath;try{e=await i.promises.readFile(t,"utf8")}catch(e){throw new a(`Failed to read certificate config file at: ${t}`)}try{let r=JSON.parse(e),n=r?.cert_configs?.workload?.cert_path,i=r?.cert_configs?.workload?.key_path;if(!n||!i)throw new l(`Certificate config file (${t}) is missing required "cert_path" or "key_path" in the workload config.`);return{certPath:n,keyPath:i}}catch(e){if(e instanceof l)throw e;throw new l(`Failed to parse certificate config from ${t}: ${e.message}`)}}async #f(e,t){let r,n;try{r=await i.promises.readFile(e),new s.X509Certificate(r)}catch(r){let t=r instanceof Error?r.message:String(r);throw new a(`Failed to read certificate file at ${e}: ${t}`)}try{n=await i.promises.readFile(t),(0,s.createPrivateKey)(n)}catch(r){let e=r instanceof Error?r.message:String(r);throw new a(`Failed to read private key file at ${t}: ${e}`)}return{cert:r,key:n}}async #m(e){let t=new s.X509Certificate(e);if(!this.trustChainPath)return JSON.stringify([t.raw.toString("base64")]);try{let e;let r=((await i.promises.readFile(this.trustChainPath,"utf8")).match(/-----BEGIN CERTIFICATE-----[^-]+-----END CERTIFICATE-----/g)??[]).map((e,t)=>{try{return new s.X509Certificate(e)}catch(r){let e=r instanceof Error?r.message:String(r);throw new l(`Failed to parse certificate at index ${t} in trust chain file ${this.trustChainPath}: ${e}`)}}),n=r.findIndex(e=>t.raw.equals(e.raw));if(-1===n)e=[t,...r];else if(0===n)e=r;else throw new l(`Leaf certificate exists in the trust chain but is not the first entry (found at index ${n}).`);return JSON.stringify(e.map(e=>e.raw.toString("base64")))}catch(t){if(t instanceof l)throw t;let e=t instanceof Error?t.message:String(t);throw new a(`Failed to process certificate chain from ${this.trustChainPath}: ${e}`)}}}t.CertificateSubjectTokenSupplier=c},10902:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Compute=void 0;let n=r(90206),i=r(80759),s=r(3490);class o extends s.OAuth2Client{serviceAccountEmail;scopes;constructor(e={}){super(e),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=e.serviceAccountEmail||"default",this.scopes=Array.isArray(e.scopes)?e.scopes:e.scopes?[e.scopes]:[]}async refreshTokenNoCache(){let e;let t=`service-accounts/${this.serviceAccountEmail}/token`;try{let r={property:t};this.scopes.length>0&&(r.params={scopes:this.scopes.join(",")}),e=await i.instance(r)}catch(e){throw e instanceof n.GaxiosError&&(e.message=`Could not refresh access token: ${e.message}`,this.wrapError(e)),e}let r=e;return e&&e.expires_in&&(r.expiry_date=new Date().getTime()+1e3*e.expires_in,delete r.expires_in),this.emit("tokens",r),{tokens:r,res:null}}async fetchIdToken(e){let t;let r=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${e}`;try{t=await i.instance({property:r})}catch(e){throw e instanceof Error&&(e.message=`Could not fetch ID token: ${e.message}`),e}return t}wrapError(e){let t=e.response;t&&t.status&&(e.status=t.status,403===t.status?e.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+e.message:404===t.status&&(e.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+e.message))}}t.Compute=o},29038:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultAwsSecurityCredentialsSupplier=void 0;let n=r(56621);class i{regionUrl;securityCredentialsUrl;imdsV2SessionTokenUrl;additionalGaxiosOptions;constructor(e){this.regionUrl=e.regionUrl,this.securityCredentialsUrl=e.securityCredentialsUrl,this.imdsV2SessionTokenUrl=e.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=e.additionalGaxiosOptions}async getAwsRegion(e){if(this.#g)return this.#g;let t=new Headers;if(!this.#g&&this.imdsV2SessionTokenUrl&&t.set("x-aws-ec2-metadata-token",await this.#y(e.transporter)),!this.regionUrl)throw RangeError('Unable to determine AWS region due to missing "options.credential_source.region_url"');let r={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",headers:t};n.AuthClient.setMethodName(r,"getAwsRegion");let i=await e.transporter.request(r);return i.data.substr(0,i.data.length-1)}async getAwsSecurityCredentials(e){if(this.#v)return this.#v;let t=new Headers;this.imdsV2SessionTokenUrl&&t.set("x-aws-ec2-metadata-token",await this.#y(e.transporter));let r=await this.#_(t,e.transporter),n=await this.#E(r,t,e.transporter);return{accessKeyId:n.AccessKeyId,secretAccessKey:n.SecretAccessKey,token:n.Token}}async #y(e){let t={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return n.AuthClient.setMethodName(t,"#getImdsV2SessionToken"),(await e.request(t)).data}async #_(e,t){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let r={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",headers:e};return n.AuthClient.setMethodName(r,"#getAwsRoleName"),(await t.request(r)).data}async #E(e,t,r){let i={...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${e}`,headers:t};return n.AuthClient.setMethodName(i,"#retrieveAwsSecurityCredentials"),(await r.request(i)).data}get #g(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null}get #v(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}}t.DefaultAwsSecurityCredentialsSupplier=i},63651:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownscopedClient=t.EXPIRATION_TIME_OFFSET=t.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let n=r(90206),i=r(76162),s=r(56621),o=r(50984);t.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,t.EXPIRATION_TIME_OFFSET=3e5;class a extends s.AuthClient{authClient;credentialAccessBoundary;cachedDownscopedAccessToken;stsCredential;constructor(e,r={accessBoundary:{accessBoundaryRules:[]}}){if(super(e instanceof s.AuthClient?{}:e),e instanceof s.AuthClient?(this.authClient=e,this.credentialAccessBoundary=r):(this.authClient=e.authClient,this.credentialAccessBoundary=e.credentialAccessBoundary),0===this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length>t.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${t.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(let e of this.credentialAccessBoundary.accessBoundary.accessBoundaryRules)if(0===e.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new o.StsCredentials({tokenExchangeEndpoint:`https://sts.${this.universeDomain}/v1/token`}),this.cachedDownscopedAccessToken=null}setCredentials(e){if(!e.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(e),this.cachedDownscopedAccessToken=e}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t=new Headers({authorization:`Bearer ${e.token}`});return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=n.Gaxios.mergeHeaders(e.headers),this.addUserProjectAndAuthHeaders(e.headers,t),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,s=r.config.data instanceof i.Readable;if(!t&&(401===n||403===n)&&!s&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw n}return r}async refreshAccessTokenAsync(){let e=(await this.authClient.getAccessToken()).token,t=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:e,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),r=this.authClient.credentials?.expiry_date||null,n=t.expires_in?new Date().getTime()+1e3*t.expires_in:r;return this.cachedDownscopedAccessToken={access_token:t.access_token,expiry_date:n,res:t.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}}t.DownscopedClient=a},71215:(e,t,r)=>{"use strict";var n;let i;Object.defineProperty(t,"__esModule",{value:!0}),t.GCPEnv=void 0,t.clear=function(){i=void 0},t.getEnv=o;let s=r(80759);async function o(){return i||(i=a())}async function a(){return n.NONE,process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?n.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?n.CLOUD_FUNCTIONS:await c()?await l()?n.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?n.CLOUD_RUN:process.env.CLOUD_RUN_JOB?n.CLOUD_RUN_JOBS:n.COMPUTE_ENGINE:n.NONE}async function l(){try{return await s.instance("attributes/cluster-name"),!0}catch(e){return!1}}async function c(){return s.isAvailable()}!function(e){e.APP_ENGINE="APP_ENGINE",e.KUBERNETES_ENGINE="KUBERNETES_ENGINE",e.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",e.COMPUTE_ENGINE="COMPUTE_ENGINE",e.CLOUD_RUN="CLOUD_RUN",e.CLOUD_RUN_JOBS="CLOUD_RUN_JOBS",e.NONE="NONE"}(n||(t.GCPEnv=n={}))},9402:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidSubjectTokenError=t.InvalidMessageFieldError=t.InvalidCodeFieldError=t.InvalidTokenTypeFieldError=t.InvalidExpirationTimeFieldError=t.InvalidSuccessFieldError=t.InvalidVersionFieldError=t.ExecutableResponseError=t.ExecutableResponse=void 0;let r="urn:ietf:params:oauth:token-type:saml2",n="urn:ietf:params:oauth:token-type:id_token",i="urn:ietf:params:oauth:token-type:jwt";class s{version;success;expirationTime;tokenType;errorCode;errorMessage;subjectToken;constructor(e){if(!e.version)throw new a("Executable response must contain a 'version' field.");if(void 0===e.success)throw new l("Executable response must contain a 'success' field.");if(this.version=e.version,this.success=e.success,this.success){if(this.expirationTime=e.expiration_time,this.tokenType=e.token_type,this.tokenType!==r&&this.tokenType!==n&&this.tokenType!==i)throw new u(`Executable response must contain a 'token_type' field when successful and it must be one of ${n}, ${i}, or ${r}.`);if(this.tokenType===r){if(!e.saml_response)throw new h(`Executable response must contain a 'saml_response' field when token_type=${r}.`);this.subjectToken=e.saml_response}else{if(!e.id_token)throw new h(`Executable response must contain a 'id_token' field when token_type=${n} or ${i}.`);this.subjectToken=e.id_token}}else{if(!e.code)throw new d("Executable response must contain a 'code' field when unsuccessful.");if(!e.message)throw new p("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=e.code,this.errorMessage=e.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}}t.ExecutableResponse=s;class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}t.ExecutableResponseError=o;class a extends o{}t.InvalidVersionFieldError=a;class l extends o{}t.InvalidSuccessFieldError=l;class c extends o{}t.InvalidExpirationTimeFieldError=c;class u extends o{}t.InvalidTokenTypeFieldError=u;class d extends o{}t.InvalidCodeFieldError=d;class p extends o{}t.InvalidMessageFieldError=p;class h extends o{}t.InvalidSubjectTokenError=h},83006:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalAccountAuthorizedUserClient=t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let n=r(56621),i=r(21673),s=r(90206),o=r(76162),a=r(83318);t.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class l extends i.OAuthClientAuthHandler{#b;constructor(e){super(e),this.#b=e.tokenRefreshEndpoint}async refreshToken(e,t){let r={...l.RETRY_CONFIG,url:this.#b,method:"POST",headers:t,data:new URLSearchParams({grant_type:"refresh_token",refresh_token:e})};n.AuthClient.setMethodName(r,"refreshToken"),this.applyClientAuthenticationOptions(r);try{let e=await this.transporter.request(r),t=e.data;return t.res=e,t}catch(e){if(e instanceof s.GaxiosError&&e.response)throw(0,i.getErrorFromOAuthErrorResponse)(e.response.data,e);throw e}}}class c extends n.AuthClient{cachedAccessToken;externalAccountAuthorizedUserHandler;refreshToken;constructor(e){super(e),e.universe_domain&&(this.universeDomain=e.universe_domain),this.refreshToken=e.refresh_token;let t={confidentialClientType:"basic",clientId:e.client_id,clientSecret:e.client_secret};this.externalAccountAuthorizedUserHandler=new l({tokenRefreshEndpoint:e.token_url??"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),transporter:this.transporter,clientAuthentication:t}),this.cachedAccessToken=null,this.quotaProjectId=e.quota_project_id,"number"!=typeof e?.eagerRefreshThresholdMillis?this.eagerRefreshThresholdMillis=a.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!e?.forceRefreshOnFailure}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let e=await this.getAccessToken(),t=new Headers({authorization:`Bearer ${e.token}`});return this.addSharedMetadataHeaders(t)}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){let r;try{let t=await this.getRequestHeaders();e.headers=s.Gaxios.mergeHeaders(e.headers),this.addUserProjectAndAuthHeaders(e.headers,t),r=await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,i=r.config.data instanceof o.Readable;if(!t&&(401===n||403===n)&&!i&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(e,!0)}throw n}return r}async refreshAccessTokenAsync(){let e=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res},void 0!==e.refresh_token&&(this.refreshToken=e.refresh_token),this.cachedAccessToken}isExpired(e){let t=new Date().getTime();return!!e.expiry_date&&t>=e.expiry_date-this.eagerRefreshThresholdMillis}}t.ExternalAccountAuthorizedUserClient=c},9273:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalAccountClient=void 0;let n=r(83318),i=r(49201),s=r(63321),o=r(84462);class a{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(e){return e&&e.type===n.EXTERNAL_ACCOUNT_TYPE?e.credential_source?.environment_id?new s.AwsClient(e):e.credential_source?.executable?new o.PluggableAuthClient(e):new i.IdentityPoolClient(e):null}}t.ExternalAccountClient=a},42986:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSubjectTokenSupplier=void 0;let n=r(21764),i=r(92048),s=(0,n.promisify)(i.readFile??(()=>{})),o=(0,n.promisify)(i.realpath??(()=>{})),a=(0,n.promisify)(i.lstat??(()=>{}));class l{filePath;formatType;subjectTokenFieldName;constructor(e){this.filePath=e.filePath,this.formatType=e.formatType,this.subjectTokenFieldName=e.subjectTokenFieldName}async getSubjectToken(){let e,t=this.filePath;try{if(t=await o(t),!(await a(t)).isFile())throw Error()}catch(e){throw e instanceof Error&&(e.message=`The file at ${t} does not exist, or it is not a file. ${e.message}`),e}let r=await s(t,{encoding:"utf8"});if("text"===this.formatType?e=r:"json"===this.formatType&&this.subjectTokenFieldName&&(e=JSON.parse(r)[this.subjectTokenFieldName]),!e)throw Error("Unable to parse the subject_token from the credential_source file");return e}}t.FileSubjectTokenSupplier=l},26614:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAuth=t.GoogleAuthExceptionMessages=void 0;let n=r(61282),i=r(92048),s=r(90206),o=r(80759),a=r(19801),l=r(55315),c=r(10537),u=r(10902),d=r(60502),p=r(71215),h=r(21316),f=r(57065),m=r(32119),g=r(9273),y=r(83318),v=r(56621),_=r(83006),E=r(86538);t.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"};class b{checkIsGCE=void 0;useJWTAccessWithScope;defaultServicePath;get isGCE(){return this.checkIsGCE}_findProjectIdPromise;_cachedProjectId;jsonContent=null;apiKey;cachedCredential=null;#x=null;defaultScopes;keyFilename;scopes;clientOptions={};constructor(e={}){if(this._cachedProjectId=e.projectId||null,this.cachedCredential=e.authClient||null,this.keyFilename=e.keyFilename||e.keyFile,this.scopes=e.scopes,this.clientOptions=e.clientOptions||{},this.jsonContent=e.credentials||null,this.apiKey=e.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(t.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);e.universeDomain&&(this.clientOptions.universeDomain=e.universeDomain)}setGapicJWTValues(e){e.defaultServicePath=this.defaultServicePath,e.useJWTAccessWithScope=this.useJWTAccessWithScope,e.defaultScopes=this.defaultScopes}getProjectId(e){if(!e)return this.getProjectIdAsync();this.getProjectIdAsync().then(t=>e(null,t),e)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(e){if(e instanceof Error&&e.message===t.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw e}}async findAndCacheProjectId(){let e=null;if(e||=await this.getProductionProjectId(),e||=await this.getFileProjectId(),e||=await this.getDefaultServiceProjectId(),e||=await this.getGCEProjectId(),e||=await this.getExternalAccountClientProjectId())return this._cachedProjectId=e,e;throw Error(t.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){let e;try{e=await o.universe("universe-domain"),e||=v.DEFAULT_UNIVERSE}catch(t){if(t&&t?.response?.status===404)e=v.DEFAULT_UNIVERSE;else throw t}return e}async getUniverseDomain(){let e=(0,E.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{e??=(await this.getClient()).universeDomain}catch{e??=v.DEFAULT_UNIVERSE}return e}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(e={},t){let r;if("function"==typeof e?t=e:r=e,!t)return this.getApplicationDefaultAsync(r);this.getApplicationDefaultAsync(r).then(e=>t(null,e.credential,e.projectId),t)}async getApplicationDefaultAsync(e={}){let r;if(this.cachedCredential)return await this.#A(this.cachedCredential,null);if((r=await this._tryGetApplicationCredentialsFromEnvironmentVariable(e))||(r=await this._tryGetApplicationCredentialsFromWellKnownFile(e)))return r instanceof h.JWT?r.scopes=this.scopes:r instanceof y.BaseExternalAccountClient&&(r.scopes=this.getAnyScopes()),await this.#A(r);if(await this._checkIsGCE())return e.scopes=this.getAnyScopes(),await this.#A(new u.Compute(e));throw Error(t.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async #A(e,t=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let r=await this.getProjectIdOptional();return t&&(e.quotaProjectId=t),this.cachedCredential=e,{credential:e,projectId:r}}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=o.getGCPResidency()||await o.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(e){let t=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!t||0===t.length)return null;try{return this._getApplicationCredentialsFromFilePath(t,e)}catch(e){throw e instanceof Error&&(e.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${e.message}`),e}}async _tryGetApplicationCredentialsFromWellKnownFile(e){let t=null;if(this._isWindows())t=process.env.APPDATA;else{let e=process.env.HOME;e&&(t=l.join(e,".config"))}return(t&&(t=l.join(t,"gcloud","application_default_credentials.json"),i.existsSync(t)||(t=null)),t)?await this._getApplicationCredentialsFromFilePath(t,e):null}async _getApplicationCredentialsFromFilePath(e,t={}){if(!e||0===e.length)throw Error("The file path is invalid.");try{if(e=i.realpathSync(e),!i.lstatSync(e).isFile())throw Error()}catch(t){throw t instanceof Error&&(t.message=`The file at ${e} does not exist, or it is not a file. ${t.message}`),t}let r=i.createReadStream(e);return this.fromStream(r,t)}fromImpersonatedJSON(e){if(!e)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(e.type!==m.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${m.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!e.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!e.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let t=this.fromJSON(e.source_credentials);if(e.service_account_impersonation_url?.length>256)throw RangeError(`Target principal is too long: ${e.service_account_impersonation_url}`);let r=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(e.service_account_impersonation_url)?.groups?.target;if(!r)throw RangeError(`Cannot extract target principal from ${e.service_account_impersonation_url}`);let n=this.getAnyScopes()??[];return new m.Impersonated({...e,sourceClient:t,targetPrincipal:r,targetScopes:Array.isArray(n)?n:[n]})}fromJSON(e,t={}){let r;let n=(0,E.originalOrCamelOptions)(t).get("universe_domain");return e.type===f.USER_REFRESH_ACCOUNT_TYPE?(r=new f.UserRefreshClient(t)).fromJSON(e):e.type===m.IMPERSONATED_ACCOUNT_TYPE?r=this.fromImpersonatedJSON(e):e.type===y.EXTERNAL_ACCOUNT_TYPE?(r=g.ExternalAccountClient.fromJSON({...e,...t})).scopes=this.getAnyScopes():e.type===_.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?r=new _.ExternalAccountAuthorizedUserClient({...e,...t}):(t.scopes=this.scopes,r=new h.JWT(t),this.setGapicJWTValues(r),r.fromJSON(e)),n&&(r.universeDomain=n),r}_cacheClientFromJSON(e,t){let r=this.fromJSON(e,t);return this.jsonContent=e,this.cachedCredential=r,r}fromStream(e,t={},r){let n={};if("function"==typeof t?r=t:n=t,!r)return this.fromStreamAsync(e,n);this.fromStreamAsync(e,n).then(e=>r(null,e),r)}fromStreamAsync(e,t){return new Promise((r,n)=>{if(!e)throw Error("Must pass in a stream containing the Google auth settings.");let i=[];e.setEncoding("utf8").on("error",n).on("data",e=>i.push(e)).on("end",()=>{try{try{let e=JSON.parse(i.join("")),n=this._cacheClientFromJSON(e,t);return r(n)}catch(t){if(!this.keyFilename)throw t;let e=new h.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=e,this.setGapicJWTValues(e),r(e)}}catch(e){return n(e)}})})}fromAPIKey(e,t={}){return new h.JWT({...t,apiKey:e})}_isWindows(){let e=a.platform();return!!e&&e.length>=3&&"win"===e.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(e=>{(0,n.exec)("gcloud config config-helper --format json",(t,r)=>{if(!t&&r)try{let t=JSON.parse(r).configuration.properties.core.project;e(t);return}catch(e){}e(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let e=await this.getClient();if(e&&e.projectId)return e.projectId}let e=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return e?e.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==y.EXTERNAL_ACCOUNT_TYPE)return null;let e=await this.getClient();return await e.getProjectId()}async getGCEProjectId(){try{return await o.project("project-id")}catch(e){return null}}getCredentials(e){if(!e)return this.getCredentialsAsync();this.getCredentialsAsync().then(t=>e(null,t),e)}async getCredentialsAsync(){let e=await this.getClient();if(e instanceof m.Impersonated)return{client_email:e.getTargetPrincipal()};if(e instanceof y.BaseExternalAccountClient){let t=e.getServiceAccountEmail();if(t)return{client_email:t,universe_domain:e.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[e,t]=await Promise.all([o.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:e,universe_domain:t}}throw Error(t.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;this.#x=this.#x||this.#T();try{return await this.#x}finally{this.#x=null}}async #T(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let e=l.resolve(this.keyFilename),t=i.createReadStream(e);return await this.fromStreamAsync(t,this.clientOptions)}if(this.apiKey){let e=await this.fromAPIKey(this.apiKey,this.clientOptions);e.scopes=this.scopes;let{credential:t}=await this.#A(e);return t}{let{credential:e}=await this.getApplicationDefaultAsync(this.clientOptions);return e}}async getIdTokenClient(e){let t=await this.getClient();if(!("fetchIdToken"in t))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new d.IdTokenClient({targetAudience:e,idTokenProvider:t})}async getAccessToken(){let e=await this.getClient();return(await e.getAccessToken()).token}async getRequestHeaders(e){return(await this.getClient()).getRequestHeaders(e)}async authorizeRequest(e={}){let t=e.url,r=await this.getClient(),n=await r.getRequestHeaders(t);return e.headers=s.Gaxios.mergeHeaders(e.headers,n),e}async fetch(...e){return(await this.getClient()).fetch(...e)}async request(e){return(await this.getClient()).request(e)}getEnv(){return(0,p.getEnv)()}async sign(e,t){let r=await this.getClient(),n=await this.getUniverseDomain();if(t=t||`https://iamcredentials.${n}/v1/projects/-/serviceAccounts/`,r instanceof m.Impersonated)return(await r.sign(e)).signedBlob;let i=(0,c.createCrypto)();if(r instanceof h.JWT&&r.key)return await i.sign(r.key,e);let s=await this.getCredentials();if(!s.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(i,s.client_email,e,t)}async signBlob(e,t,r,n){let i=new URL(n+`${t}:signBlob`);return(await this.request({method:"POST",url:i.href,data:{payload:e.encodeBase64StringUtf8(r)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}t.GoogleAuth=b},39120:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IAMAuth=void 0;class r{selector;token;constructor(e,t){this.selector=e,this.token=t,this.selector=e,this.token=t}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}t.IAMAuth=r},49201:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityPoolClient=void 0;let n=r(83318),i=r(86538),s=r(42986),o=r(60132),a=r(88332),l=r(50984),c=r(90206);class u extends n.BaseExternalAccountClient{subjectTokenSupplier;constructor(e){super(e);let t=(0,i.originalOrCamelOptions)(e),r=t.get("credential_source"),n=t.get("subject_token_supplier");if(!r&&!n)throw Error("A credential source or subject token supplier must be specified.");if(r&&n)throw Error("Only one of credential source or subject token supplier can be specified.");if(n)this.subjectTokenSupplier=n,this.credentialSourceType="programmatic";else{let e=(0,i.originalOrCamelOptions)(r),t=(0,i.originalOrCamelOptions)(e.get("format")),n=t.get("type")||"text",l=t.get("subject_token_field_name");if("json"!==n&&"text"!==n)throw Error(`Invalid credential_source format "${n}"`);if("json"===n&&!l)throw Error("Missing subject_token_field_name for JSON credential_source format");let c=e.get("file"),d=e.get("url"),p=e.get("certificate"),h=e.get("headers");if(c&&d||d&&p||c&&p)throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.');if(c)this.credentialSourceType="file",this.subjectTokenSupplier=new s.FileSubjectTokenSupplier({filePath:c,formatType:n,subjectTokenFieldName:l});else if(d)this.credentialSourceType="url",this.subjectTokenSupplier=new o.UrlSubjectTokenSupplier({url:d,formatType:n,subjectTokenFieldName:l,headers:h,additionalGaxiosOptions:u.RETRY_CONFIG});else if(p){this.credentialSourceType="certificate";let e=new a.CertificateSubjectTokenSupplier({useDefaultCertificateConfig:p.use_default_certificate_config,certificateConfigLocation:p.certificate_config_location,trustChainPath:p.trust_chain_path});this.subjectTokenSupplier=e}else throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.')}}async retrieveSubjectToken(){let e=await this.subjectTokenSupplier.getSubjectToken(this.supplierContext);if(this.subjectTokenSupplier instanceof a.CertificateSubjectTokenSupplier){let e=await this.subjectTokenSupplier.createMtlsHttpsAgent();this.stsCredential=new l.StsCredentials({tokenExchangeEndpoint:this.getTokenUrl(),clientAuthentication:this.clientAuth,transporter:new c.Gaxios({agent:e})}),this.transporter=new c.Gaxios({...this.transporter.defaults||{},agent:e})}return e}}t.IdentityPoolClient=u},60502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdTokenClient=void 0;let n=r(3490);class i extends n.OAuth2Client{targetAudience;idTokenProvider;constructor(e){super(e),this.targetAudience=e.targetAudience,this.idTokenProvider=e.idTokenProvider}async getRequestMetadataAsync(){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let e=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:e,expiry_date:this.getIdTokenExpiryDate(e)}}return{headers:new Headers({authorization:"Bearer "+this.credentials.id_token})}}getIdTokenExpiryDate(e){let t=e.split(".")[1];if(t)return 1e3*JSON.parse(Buffer.from(t,"base64").toString("ascii")).exp}}t.IdTokenClient=i},32119:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Impersonated=t.IMPERSONATED_ACCOUNT_TYPE=void 0;let n=r(3490),i=r(90206),s=r(86538);t.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class o extends n.OAuth2Client{sourceClient;targetPrincipal;targetScopes;delegates;lifetime;endpoint;constructor(e={}){if(super(e),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=e.sourceClient??new n.OAuth2Client,this.targetPrincipal=e.targetPrincipal??"",this.delegates=e.delegates??[],this.targetScopes=e.targetScopes??[],this.lifetime=e.lifetime??3600,(0,s.originalOrCamelOptions)(e).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=e.endpoint??`https://iamcredentials.${this.universeDomain}`}async sign(e){await this.sourceClient.getAccessToken();let t=`projects/-/serviceAccounts/${this.targetPrincipal}`,r=`${this.endpoint}/v1/${t}:signBlob`,n={delegates:this.delegates,payload:Buffer.from(e).toString("base64")};return(await this.sourceClient.request({...o.RETRY_CONFIG,url:r,data:n,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){try{await this.sourceClient.getAccessToken();let e="projects/-/serviceAccounts/"+this.targetPrincipal,t=`${this.endpoint}/v1/${e}:generateAccessToken`,r={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},n=await this.sourceClient.request({...o.RETRY_CONFIG,url:t,data:r,method:"POST"}),i=n.data;return this.credentials.access_token=i.accessToken,this.credentials.expiry_date=Date.parse(i.expireTime),{tokens:this.credentials,res:n}}catch(r){if(!(r instanceof Error))throw r;let e=0,t="";if(r instanceof i.GaxiosError&&(e=r?.response?.data?.error?.status,t=r?.response?.data?.error?.message),e&&t)throw r.message=`${e}: unable to impersonate: ${t}`,r;throw r.message=`unable to impersonate: ${r}`,r}}async fetchIdToken(e,t){await this.sourceClient.getAccessToken();let r=`projects/-/serviceAccounts/${this.targetPrincipal}`,n=`${this.endpoint}/v1/${r}:generateIdToken`,i={delegates:this.delegates,audience:e,includeEmail:t?.includeEmail??!0,useEmailAzp:t?.includeEmail??!0};return(await this.sourceClient.request({...o.RETRY_CONFIG,url:n,data:i,method:"POST"})).data.token}}t.Impersonated=o},77951:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWTAccess=void 0;let n=r(8287),i=r(86538),s={alg:"RS256",typ:"JWT"};class o{email;key;keyId;projectId;eagerRefreshThresholdMillis;cache=new i.LRUCache({capacity:500,maxAge:36e5});constructor(e,t,r,n){this.email=e,this.key=t,this.keyId=r,this.eagerRefreshThresholdMillis=n??3e5}getCachedKey(e,t){let r=e;if(t&&Array.isArray(t)&&t.length?r=e?`${e}_${t.join("_")}`:`${t.join("_")}`:"string"==typeof t&&(r=e?`${e}_${t}`:t),!r)throw Error("Scopes or url must be provided");return r}getRequestHeaders(e,t,r){let i;let a=this.getCachedKey(e,r),l=this.cache.get(a),c=Date.now();if(l&&l.expiration-c>this.eagerRefreshThresholdMillis)return new Headers(l.headers);let u=Math.floor(Date.now()/1e3),d=o.getExpirationTime(u);if(Array.isArray(r)&&(r=r.join(" ")),i=r?{iss:this.email,sub:this.email,scope:r,exp:d,iat:u}:{iss:this.email,sub:this.email,aud:e,exp:d,iat:u},t){for(let e in i)if(t[e])throw Error(`The '${e}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let p=this.keyId?{...s,kid:this.keyId}:s,h=Object.assign(i,t),f=n.sign({header:p,payload:h,secret:this.key}),m=new Headers({authorization:`Bearer ${f}`});return this.cache.set(a,{expiration:1e3*d,headers:m}),m}static getExpirationTime(e){return e+3600}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{e||r(Error("Must pass in a stream containing the service account auth settings."));let n="";e.setEncoding("utf8").on("data",e=>n+=e).on("error",r).on("end",()=>{try{let e=JSON.parse(n);this.fromJSON(e),t()}catch(e){r(e)}})})}}t.JWTAccess=o},21316:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWT=void 0;let n=r(1838),i=r(77951),s=r(3490),o=r(56621);class a extends s.OAuth2Client{email;keyFile;key;keyId;defaultScopes;scopes;scope;subject;gtoken;additionalClaims;useJWTAccessWithScope;defaultServicePath;access;constructor(e={}){super(e),this.email=e.email,this.keyFile=e.keyFile,this.key=e.key,this.keyId=e.keyId,this.scopes=e.scopes,this.subject=e.subject,this.additionalClaims=e.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(e){let t=new a(this);return t.scopes=e,t}async getRequestMetadataAsync(e){e=this.defaultServicePath?`https://${this.defaultServicePath}/`:e;let t=!this.hasUserScopes()&&e||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==o.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==o.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${o.DEFAULT_UNIVERSE}`);if(!this.apiKey&&t){if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:e}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders(new Headers({authorization:`Bearer ${e.id_token}`}))}}{let t;this.access||(this.access=new i.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?t=this.scopes:e||(t=this.defaultScopes);let r=this.useJWTAccessWithScope||this.universeDomain!==o.DEFAULT_UNIVERSE,n=await this.access.getRequestHeaders(e??void 0,this.additionalClaims,r?t:void 0);return{headers:this.addSharedMetadataHeaders(n)}}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(e):{headers:new Headers}}async fetchIdToken(e){let t=new n.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:e},transporter:this.transporter});if(await t.getToken({forceRefresh:!0}),!t.idToken)throw Error("Unknown error: Failed to fetch ID token");return t.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&this.scopes.length>0||!!this.defaultScopes&&this.defaultScopes.length>0}authorize(e){if(!e)return this.authorizeAsync();this.authorizeAsync().then(t=>e(null,t),e)}async authorizeAsync(){let e=await this.refreshToken();if(!e)throw Error("No result returned");return this.credentials=e.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,e.tokens}async refreshTokenNoCache(){let e=this.createGToken(),t={access_token:(await e.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:e.expiresAt,id_token:e.idToken};return this.emit("tokens",t),{res:null,tokens:t}}createGToken(){return this.gtoken||(this.gtoken=new n.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!e.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!e.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=e.client_email,this.key=e.private_key,this.keyId=e.private_key_id,this.projectId=e.project_id,this.quotaProjectId=e.quota_project_id,this.universeDomain=e.universe_domain||this.universeDomain}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}fromStreamAsync(e){return new Promise((t,r)=>{if(!e)throw Error("Must pass in a stream containing the service account auth settings.");let n="";e.setEncoding("utf8").on("error",r).on("data",e=>n+=e).on("end",()=>{try{let e=JSON.parse(n);this.fromJSON(e),t()}catch(e){r(e)}})})}fromAPIKey(e){if("string"!=typeof e)throw Error("Must provide an API Key string.");this.apiKey=e}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let e=this.createGToken(),t=await e.getCredentials(this.keyFile);return{private_key:t.privateKey,client_email:t.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}t.JWT=a},90434:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoginTicket=void 0;class r{envelope;payload;constructor(e,t){this.envelope=e,this.payload=t}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let e=this.getPayload();return e&&e.sub?e.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}t.LoginTicket=r},3490:(e,t,r)=>{"use strict";var n,i,s;Object.defineProperty(t,"__esModule",{value:!0}),t.OAuth2Client=t.ClientAuthentication=t.CertificateFormat=t.CodeChallengeMethod=void 0;let o=r(90206),a=r(86624),l=r(76162),c=r(3164),u=r(86538),d=r(10537),p=r(56621),h=r(90434);(function(e){e.Plain="plain",e.S256="S256"})(n||(t.CodeChallengeMethod=n={})),function(e){e.PEM="PEM",e.JWK="JWK"}(i||(t.CertificateFormat=i={})),function(e){e.ClientSecretPost="ClientSecretPost",e.ClientSecretBasic="ClientSecretBasic",e.None="None"}(s||(t.ClientAuthentication=s={}));class f extends p.AuthClient{redirectUri;certificateCache={};certificateExpiry=null;certificateCacheFormat=i.PEM;refreshTokenPromises=new Map;endpoints;issuers;clientAuthentication;_clientId;_clientSecret;refreshHandler;constructor(e={},t,r){super("object"==typeof e?e:{}),"object"!=typeof e&&(e={clientId:e,clientSecret:t,redirectUri:r}),this._clientId=e.clientId||e.client_id,this._clientSecret=e.clientSecret||e.client_secret,this.redirectUri=e.redirectUri||e.redirect_uris?.[0],this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...e.endpoints},this.clientAuthentication=e.clientAuthentication||s.ClientSecretPost,this.issuers=e.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}static GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo";static CLOCK_SKEW_SECS_=300;static DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400;generateAuthUrl(e={}){if(e.code_challenge_method&&!e.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return e.response_type=e.response_type||"code",e.client_id=e.client_id||this._clientId,e.redirect_uri=e.redirect_uri||this.redirectUri,Array.isArray(e.scope)&&(e.scope=e.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+a.stringify(e)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let e=(0,d.createCrypto)(),t=e.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),r=(await e.sha256DigestBase64(t)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:t,codeChallenge:r}}getToken(e,t){let r="string"==typeof e?{code:e}:e;if(!t)return this.getTokenAsync(r);this.getTokenAsync(r).then(e=>t(null,e.tokens,e.res),e=>t(e,null,e.response))}async getTokenAsync(e){let t=this.endpoints.oauth2TokenUrl.toString(),r=new Headers,n={client_id:e.client_id||this._clientId,code_verifier:e.codeVerifier,code:e.code,grant_type:"authorization_code",redirect_uri:e.redirect_uri||this.redirectUri};if(this.clientAuthentication===s.ClientSecretBasic){let e=Buffer.from(`${this._clientId}:${this._clientSecret}`);r.set("authorization",`Basic ${e.toString("base64")}`)}this.clientAuthentication===s.ClientSecretPost&&(n.client_secret=this._clientSecret);let i={...f.RETRY_CONFIG,method:"POST",url:t,data:new URLSearchParams((0,u.removeUndefinedValuesInObject)(n)),headers:r};p.AuthClient.setMethodName(i,"getTokenAsync");let o=await this.transporter.request(i),a=o.data;return o.data&&o.data.expires_in&&(a.expiry_date=new Date().getTime()+1e3*o.data.expires_in,delete a.expires_in),this.emit("tokens",a),{tokens:a,res:o}}async refreshToken(e){if(!e)return this.refreshTokenNoCache(e);if(this.refreshTokenPromises.has(e))return this.refreshTokenPromises.get(e);let t=this.refreshTokenNoCache(e).then(t=>(this.refreshTokenPromises.delete(e),t),t=>{throw this.refreshTokenPromises.delete(e),t});return this.refreshTokenPromises.set(e,t),t}async refreshTokenNoCache(e){let t;if(!e)throw Error("No refresh token is set.");let r=this.endpoints.oauth2TokenUrl.toString(),n={refresh_token:e,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{let e={...f.RETRY_CONFIG,method:"POST",url:r,data:new URLSearchParams((0,u.removeUndefinedValuesInObject)(n))};p.AuthClient.setMethodName(e,"refreshTokenNoCache"),t=await this.transporter.request(e)}catch(e){throw e instanceof o.GaxiosError&&"invalid_grant"===e.message&&e.response?.data&&/ReAuth/i.test(e.response.data.error_description)&&(e.message=JSON.stringify(e.response.data)),e}let i=t.data;return t.data&&t.data.expires_in&&(i.expiry_date=new Date().getTime()+1e3*t.data.expires_in,delete i.expires_in),this.emit("tokens",i),{tokens:i,res:t}}refreshAccessToken(e){if(!e)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(t=>e(null,t.credentials,t.res),e)}async refreshAccessTokenAsync(){let e=await this.refreshToken(this.credentials.refresh_token),t=e.tokens;return t.refresh_token=this.credentials.refresh_token,this.credentials=t,{credentials:this.credentials,res:e.res}}getAccessToken(e){if(!e)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(t=>e(null,t.token,t.res),e)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token){if(this.refreshHandler){let e=await this.processAndValidateRefreshHandler();if(e?.access_token)return this.setCredentials(e),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.")}let e=await this.refreshAccessTokenAsync();if(!e.credentials||e.credentials&&!e.credentials.access_token)throw Error("Could not refresh access token.");return{token:e.credentials.access_token,res:e.res}}}async getRequestHeaders(e){return(await this.getRequestMetadataAsync(e)).headers}async getRequestMetadataAsync(e){let t=this.credentials;if(!t.access_token&&!t.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(t.access_token&&!this.isTokenExpiring()){t.token_type=t.token_type||"Bearer";let e=new Headers({authorization:t.token_type+" "+t.access_token});return{headers:this.addSharedMetadataHeaders(e)}}if(this.refreshHandler){let e=await this.processAndValidateRefreshHandler();if(e?.access_token){this.setCredentials(e);let t=new Headers({authorization:"Bearer "+this.credentials.access_token});return{headers:this.addSharedMetadataHeaders(t)}}}if(this.apiKey)return{headers:new Headers({"X-Goog-Api-Key":this.apiKey})};let r=null,n=null;try{n=(r=await this.refreshToken(t.refresh_token)).tokens}catch(e){throw e.response&&(403===e.response.status||404===e.response.status)&&(e.message=`Could not refresh access token: ${e.message}`),e}let i=this.credentials;i.token_type=i.token_type||"Bearer",n.refresh_token=i.refresh_token,this.credentials=n;let s=new Headers({authorization:i.token_type+" "+n.access_token});return{headers:this.addSharedMetadataHeaders(s),res:r.res}}static getRevokeTokenUrl(e){return new f().getRevokeTokenURL(e).toString()}getRevokeTokenURL(e){let t=new URL(this.endpoints.oauth2RevokeUrl);return t.searchParams.append("token",e),t}revokeToken(e,t){let r={...f.RETRY_CONFIG,url:this.getRevokeTokenURL(e).toString(),method:"POST"};if(p.AuthClient.setMethodName(r,"revokeToken"),!t)return this.transporter.request(r);this.transporter.request(r).then(e=>t(null,e),t)}revokeCredentials(e){if(!e)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(t=>e(null,t),e)}async revokeCredentialsAsync(){let e=this.credentials.access_token;if(this.credentials={},e)return this.revokeToken(e);throw Error("No access token to revoke.")}request(e,t){if(!t)return this.requestAsync(e);this.requestAsync(e).then(e=>t(null,e),e=>t(e,e.response))}async requestAsync(e,t=!1){try{let t=await this.getRequestMetadataAsync();return e.headers=o.Gaxios.mergeHeaders(e.headers),this.addUserProjectAndAuthHeaders(e.headers,t.headers),this.apiKey&&e.headers.set("X-Goog-Api-Key",this.apiKey),await this.transporter.request(e)}catch(n){let r=n.response;if(r){let n=r.status,i=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),s=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,o=r.config.data instanceof l.Readable,a=401===n||403===n;if(!t&&a&&!o&&i)return await this.refreshAccessTokenAsync(),this.requestAsync(e,!0);if(!t&&a&&!o&&s){let t=await this.processAndValidateRefreshHandler();return t?.access_token&&this.setCredentials(t),this.requestAsync(e,!0)}}throw n}}verifyIdToken(e,t){if(t&&"function"!=typeof t)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!t)return this.verifyIdTokenAsync(e);this.verifyIdTokenAsync(e).then(e=>t(null,e),t)}async verifyIdTokenAsync(e){if(!e.idToken)throw Error("The verifyIdToken method requires an ID Token");let t=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(e.idToken,t.certs,e.audience,this.issuers,e.maxExpiry)}async getTokenInfo(e){let{data:t}=await this.transporter.request({...f.RETRY_CONFIG,method:"POST",headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8",authorization:`Bearer ${e}`},url:this.endpoints.tokenInfoUrl.toString()}),r=Object.assign({expiry_date:new Date().getTime()+1e3*t.expires_in,scopes:t.scope.split(" ")},t);return delete r.expires_in,delete r.scope,r}getFederatedSignonCerts(e){if(!e)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(t=>e(null,t.certs,t.res),e)}async getFederatedSignonCertsAsync(){let e,t;let r=new Date().getTime(),n=(0,d.hasBrowserCrypto)()?i.JWK:i.PEM;if(this.certificateExpiry&&r<this.certificateExpiry.getTime()&&this.certificateCacheFormat===n)return{certs:this.certificateCache,format:n};switch(n){case i.PEM:t=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case i.JWK:t=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${n}`)}try{let r={...f.RETRY_CONFIG,url:t};p.AuthClient.setMethodName(r,"getFederatedSignonCertsAsync"),e=await this.transporter.request(r)}catch(e){throw e instanceof Error&&(e.message=`Failed to retrieve verification certificates: ${e.message}`),e}let s=e?.headers.get("cache-control"),o=-1;if(s){let e=/max-age=(?<maxAge>[0-9]+)/.exec(s)?.groups?.maxAge;e&&(o=1e3*Number(e))}let a={};switch(n){case i.PEM:a=e.data;break;case i.JWK:for(let t of e.data.keys)a[t.kid]=t;break;default:throw Error(`Unsupported certificate format ${n}`)}let l=new Date;return this.certificateExpiry=-1===o?null:new Date(l.getTime()+o),this.certificateCache=a,this.certificateCacheFormat=n,{certs:a,format:n,res:e}}getIapPublicKeys(e){if(!e)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(t=>e(null,t.pubkeys,t.res),e)}async getIapPublicKeysAsync(){let e;let t=this.endpoints.oauth2IapPublicKeyUrl.toString();try{let r={...f.RETRY_CONFIG,url:t};p.AuthClient.setMethodName(r,"getIapPublicKeysAsync"),e=await this.transporter.request(r)}catch(e){throw e instanceof Error&&(e.message=`Failed to retrieve verification certificates: ${e.message}`),e}return{pubkeys:e.data,res:e}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(e,t,r,n,i){let s,o;let a=(0,d.createCrypto)();i||(i=f.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let l=e.split(".");if(3!==l.length)throw Error("Wrong number of segments in token: "+e);let u=l[0]+"."+l[1],p=l[2];try{s=JSON.parse(a.decodeBase64StringUtf8(l[0]))}catch(e){throw e instanceof Error&&(e.message=`Can't parse token envelope: ${l[0]}': ${e.message}`),e}if(!s)throw Error("Can't parse token envelope: "+l[0]);try{o=JSON.parse(a.decodeBase64StringUtf8(l[1]))}catch(e){throw e instanceof Error&&(e.message=`Can't parse token payload '${l[0]}`),e}if(!o)throw Error("Can't parse token payload: "+l[1]);if(!Object.prototype.hasOwnProperty.call(t,s.kid))throw Error("No pem found for envelope: "+JSON.stringify(s));let m=t[s.kid];if("ES256"===s.alg&&(p=c.joseToDer(p,"ES256").toString("base64")),!await a.verify(m,u,p))throw Error("Invalid token signature: "+e);if(!o.iat)throw Error("No issue time in token: "+JSON.stringify(o));if(!o.exp)throw Error("No expiration time in token: "+JSON.stringify(o));let g=Number(o.iat);if(isNaN(g))throw Error("iat field using invalid format");let y=Number(o.exp);if(isNaN(y))throw Error("exp field using invalid format");let v=new Date().getTime()/1e3;if(y>=v+i)throw Error("Expiration time too far in future: "+JSON.stringify(o));let _=g-f.CLOCK_SKEW_SECS_,E=y+f.CLOCK_SKEW_SECS_;if(v<_)throw Error("Token used too early, "+v+" < "+_+": "+JSON.stringify(o));if(v>E)throw Error("Token used too late, "+v+" > "+E+": "+JSON.stringify(o));if(n&&0>n.indexOf(o.iss))throw Error("Invalid issuer, expected one of ["+n+"], but got "+o.iss);if(null!=r){let e=o.aud;if(!(r.constructor===Array?r.indexOf(e)>-1:e===r))throw Error("Wrong recipient, payload audience != requiredAudience")}return new h.LoginTicket(s,o)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let e=await this.refreshHandler();if(!e.access_token)throw Error("No access token is returned by the refreshHandler callback.");return e}}isTokenExpiring(){let e=this.credentials.expiry_date;return!!e&&e<=new Date().getTime()+this.eagerRefreshThresholdMillis}}t.OAuth2Client=f},21673:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OAuthClientAuthHandler=void 0,t.getErrorFromOAuthErrorResponse=function(e,t){let r=e.error,n=e.error_description,i=e.error_uri,s=`Error code ${r}`;void 0!==n&&(s+=`: ${n}`),void 0!==i&&(s+=` - ${i}`);let o=Error(s);if(t){let e=Object.keys(t);t.stack&&e.push("stack"),e.forEach(e=>{"message"!==e&&Object.defineProperty(o,e,{value:t[e],writable:!1,enumerable:!0})})}return o};let n=r(90206),i=r(10537),s=["PUT","POST","PATCH"];class o{#S=(0,i.createCrypto)();#C;transporter;constructor(e){e&&"clientId"in e?(this.#C=e,this.transporter=new n.Gaxios):(this.#C=e?.clientAuthentication,this.transporter=e?.transporter||new n.Gaxios)}applyClientAuthenticationOptions(e,t){e.headers=n.Gaxios.mergeHeaders(e.headers),this.injectAuthenticatedHeaders(e,t),t||this.injectAuthenticatedRequestBody(e)}injectAuthenticatedHeaders(e,t){if(t)e.headers=n.Gaxios.mergeHeaders(e.headers,{authorization:`Bearer ${t}`});else if(this.#C?.confidentialClientType==="basic"){e.headers=n.Gaxios.mergeHeaders(e.headers);let t=this.#C.clientId,r=this.#C.clientSecret||"",i=this.#S.encodeBase64StringUtf8(`${t}:${r}`);n.Gaxios.mergeHeaders(e.headers,{authorization:`Basic ${i}`})}}injectAuthenticatedRequestBody(e){if(this.#C?.confidentialClientType==="request-body"){let t=(e.method||"GET").toUpperCase();if(!s.includes(t))throw Error(`${t} HTTP method does not support ${this.#C.confidentialClientType} client authentication`);let r=new Headers(e.headers).get("content-type");if(r?.startsWith("application/x-www-form-urlencoded")||e.data instanceof URLSearchParams){let t=new URLSearchParams(e.data??"");t.append("client_id",this.#C.clientId),t.append("client_secret",this.#C.clientSecret||""),e.data=t}else if(r?.startsWith("application/json"))e.data=e.data||{},Object.assign(e.data,{client_id:this.#C.clientId,client_secret:this.#C.clientSecret||""});else throw Error(`${r} content-types are not supported with ${this.#C.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}t.OAuthClientAuthHandler=o},26733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PassThroughClient=void 0;let n=r(56621);class i extends n.AuthClient{async request(e){return this.transporter.request(e)}async getAccessToken(){return{}}async getRequestHeaders(){return new Headers}}t.PassThroughClient=i},84462:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluggableAuthClient=t.ExecutableError=void 0;let n=r(83318),i=r(9402),s=r(6895);var o=r(6895);Object.defineProperty(t,"ExecutableError",{enumerable:!0,get:function(){return o.ExecutableError}});class a extends n.BaseExternalAccountClient{command;timeoutMillis;outputFile;handler;constructor(e){if(super(e),!e.credential_source.executable||(this.command=e.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===e.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=e.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=e.credential_source.executable.output_file,this.handler=new s.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let e;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(e=await this.handler.retrieveCachedResponse()),!e){let t=new Map;t.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),t.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),t.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&t.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let r=this.getServiceAccountEmail();r&&t.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",r),e=await this.handler.retrieveResponseFromExecutable(t)}if(e.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!e.success)throw new s.ExecutableError(e.errorMessage,e.errorCode);if(this.outputFile&&!e.expirationTime)throw new i.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(e.isExpired())throw Error("Executable response is expired.");return e.subjectToken}}t.PluggableAuthClient=a},6895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluggableAuthHandler=t.ExecutableError=void 0;let n=r(9402),i=r(61282),s=r(92048);class o extends Error{code;constructor(e,t){super(`The executable failed with exit code: ${t} and error message: ${e}.`),this.code=t,Object.setPrototypeOf(this,new.target.prototype)}}t.ExecutableError=o;class a{commandComponents;timeoutMillis;outputFile;constructor(e){if(!e.command)throw Error("No command provided.");if(this.commandComponents=a.parseCommand(e.command),this.timeoutMillis=e.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=e.outputFile}retrieveResponseFromExecutable(e){return new Promise((t,r)=>{let s=i.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(e)}}),a="";s.stdout.on("data",e=>{a+=e}),s.stderr.on("data",e=>{a+=e});let l=setTimeout(()=>(s.removeAllListeners(),s.kill(),r(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);s.on("close",e=>{if(clearTimeout(l),0!==e)return r(new o(a,e.toString()));try{let e=JSON.parse(a),r=new n.ExecutableResponse(e);return t(r)}catch(e){if(e instanceof n.ExecutableResponseError)return r(e);return r(new n.ExecutableResponseError(`The executable returned an invalid response: ${a}`))}})})}async retrieveCachedResponse(){let e;if(!this.outputFile||0===this.outputFile.length)return;try{e=await s.promises.realpath(this.outputFile)}catch{return}if(!(await s.promises.lstat(e)).isFile())return;let t=await s.promises.readFile(e,{encoding:"utf8"});if(""!==t)try{let e=JSON.parse(t);if(new n.ExecutableResponse(e).isValid())return new n.ExecutableResponse(e);return}catch(e){if(e instanceof n.ExecutableResponseError)throw e;throw new n.ExecutableResponseError(`The output file contained an invalid response: ${t}`)}}static parseCommand(e){let t=e.match(/(?:[^\s"]+|"[^"]*")+/g);if(!t)throw Error(`Provided command: "${e}" could not be parsed.`);for(let e=0;e<t.length;e++)'"'===t[e][0]&&'"'===t[e].slice(-1)&&(t[e]=t[e].slice(1,-1));return t}}t.PluggableAuthHandler=a},57065:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserRefreshClient=t.USER_REFRESH_ACCOUNT_TYPE=void 0;let n=r(3490),i=r(56621);t.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class s extends n.OAuth2Client{_refreshToken;constructor(e,t,r,n,i){let s=e&&"object"==typeof e?e:{clientId:e,clientSecret:t,refreshToken:r,eagerRefreshThresholdMillis:n,forceRefreshOnFailure:i};super(s),this._refreshToken=s.refreshToken,this.credentials.refresh_token=s.refreshToken}async refreshTokenNoCache(){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(e){let t={...s.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,method:"POST",data:new URLSearchParams({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:e})};return i.AuthClient.setMethodName(t,"fetchIdToken"),(await this.transporter.request(t)).data.id_token}fromJSON(e){if(!e)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==e.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!e.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!e.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!e.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=e.client_id,this._clientSecret=e.client_secret,this._refreshToken=e.refresh_token,this.credentials.refresh_token=e.refresh_token,this.quotaProjectId=e.quota_project_id,this.universeDomain=e.universe_domain||this.universeDomain}fromStream(e,t){if(!t)return this.fromStreamAsync(e);this.fromStreamAsync(e).then(()=>t(),t)}async fromStreamAsync(e){return new Promise((t,r)=>{if(!e)return r(Error("Must pass in a stream containing the user refresh token."));let n="";e.setEncoding("utf8").on("error",r).on("data",e=>n+=e).on("end",()=>{try{let e=JSON.parse(n);return this.fromJSON(e),t()}catch(e){return r(e)}})})}static fromJSON(e){let t=new s;return t.fromJSON(e),t}}t.UserRefreshClient=s},50984:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StsCredentials=void 0;let n=r(90206),i=r(56621),s=r(21673),o=r(86538);class a extends s.OAuthClientAuthHandler{#w;constructor(e={tokenExchangeEndpoint:""},t){("object"!=typeof e||e instanceof URL)&&(e={tokenExchangeEndpoint:e,clientAuthentication:t}),super(e),this.#w=e.tokenExchangeEndpoint}async exchangeToken(e,t,r){let l={grant_type:e.grantType,resource:e.resource,audience:e.audience,scope:e.scope?.join(" "),requested_token_type:e.requestedTokenType,subject_token:e.subjectToken,subject_token_type:e.subjectTokenType,actor_token:e.actingParty?.actorToken,actor_token_type:e.actingParty?.actorTokenType,options:r&&JSON.stringify(r)},c={...a.RETRY_CONFIG,url:this.#w.toString(),method:"POST",headers:t,data:new URLSearchParams((0,o.removeUndefinedValuesInObject)(l))};i.AuthClient.setMethodName(c,"exchangeToken"),this.applyClientAuthenticationOptions(c);try{let e=await this.transporter.request(c),t=e.data;return t.res=e,t}catch(e){if(e instanceof n.GaxiosError&&e.response)throw(0,s.getErrorFromOAuthErrorResponse)(e.response.data,e);throw e}}}t.StsCredentials=a},60132:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrlSubjectTokenSupplier=void 0;let n=r(56621);class i{url;headers;formatType;subjectTokenFieldName;additionalGaxiosOptions;constructor(e){this.url=e.url,this.formatType=e.formatType,this.subjectTokenFieldName=e.subjectTokenFieldName,this.headers=e.headers,this.additionalGaxiosOptions=e.additionalGaxiosOptions}async getSubjectToken(e){let t;let r={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers};if(n.AuthClient.setMethodName(r,"getSubjectToken"),"text"===this.formatType?t=(await e.transporter.request(r)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(t=(await e.transporter.request(r)).data[this.subjectTokenFieldName]),!t)throw Error("Unable to parse the subject_token from the credential_source URL");return t}}t.UrlSubjectTokenSupplier=i},13244:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserCrypto=void 0;let n=r(714),i=r(97277);class s{constructor(){if("undefined"==typeof window||void 0===window.crypto||void 0===window.crypto.subtle)throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(e){let t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return n.fromByteArray(new Uint8Array(r))}randomBytesBase64(e){let t=new Uint8Array(e);return window.crypto.getRandomValues(t),n.fromByteArray(t)}static padBase64(e){for(;e.length%4!=0;)e+="=";return e}async verify(e,t,r){let i={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},o=new TextEncoder().encode(t),a=n.toByteArray(s.padBase64(r)),l=await window.crypto.subtle.importKey("jwk",e,i,!0,["verify"]);return await window.crypto.subtle.verify(i,l,a,o)}async sign(e,t){let r={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},i=new TextEncoder().encode(t),s=await window.crypto.subtle.importKey("jwk",e,r,!0,["sign"]),o=await window.crypto.subtle.sign(r,s,i);return n.fromByteArray(new Uint8Array(o))}decodeBase64StringUtf8(e){let t=n.toByteArray(s.padBase64(e));return new TextDecoder().decode(t)}encodeBase64StringUtf8(e){let t=new TextEncoder().encode(e);return n.fromByteArray(t)}async sha256DigestHex(e){let t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return(0,i.fromArrayBufferToHex)(r)}async signWithHmacSha256(e,t){let r="string"==typeof e?e:String.fromCharCode(...new Uint16Array(e)),n=new TextEncoder,i=await window.crypto.subtle.importKey("raw",n.encode(r),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",i,n.encode(t))}}t.BrowserCrypto=s},10537:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createCrypto=function(){return a()?new s.BrowserCrypto:new o.NodeCrypto},t.hasBrowserCrypto=a;let s=r(13244),o=r(85455);function a(){return"undefined"!=typeof window&&void 0!==window.crypto&&void 0!==window.crypto.subtle}i(r(97277),t)},85455:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCrypto=void 0;let n=r(84770);class i{async sha256DigestBase64(e){return n.createHash("sha256").update(e).digest("base64")}randomBytesBase64(e){return n.randomBytes(e).toString("base64")}async verify(e,t,r){let i=n.createVerify("RSA-SHA256");return i.update(t),i.end(),i.verify(e,r,"base64")}async sign(e,t){let r=n.createSign("RSA-SHA256");return r.update(t),r.end(),r.sign(e,"base64")}decodeBase64StringUtf8(e){return Buffer.from(e,"base64").toString("utf-8")}encodeBase64StringUtf8(e){return Buffer.from(e,"utf-8").toString("base64")}async sha256DigestHex(e){return n.createHash("sha256").update(e).digest("hex")}async signWithHmacSha256(e,t){var r;let i="string"==typeof e?e:Buffer.from(e);return(r=n.createHmac("sha256",i).update(t).digest()).buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}}t.NodeCrypto=i},97277:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromArrayBufferToHex=function(e){return Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")}},44401:(e,t,r)=>{"use strict";t.eE=void 0;let n=r(26614);Object.defineProperty(t,"eE",{enumerable:!0,get:function(){return n.GoogleAuth}}),r(80759),r(90206),r(56621),r(10902),r(71215),r(39120),r(60502),r(77951),r(21316),r(32119),r(3490),r(90434),r(57065),r(63321),r(43676),r(49201),r(9273),r(83318),r(63651),r(84462),r(83006),r(26733),new n.GoogleAuth},86538:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LRUCache=void 0,t.snakeToCamel=a,t.originalOrCamelOptions=function(e){return{get:function(t){let r=e||{};return r[t]??r[a(t)]}}},t.removeUndefinedValuesInObject=function(e){return Object.entries(e).forEach(([t,r])=>{(void 0===r||"undefined"===r)&&delete e[t]}),e},t.isValidFile=c,t.getWellKnownCertificateConfigFileLocation=function(){let e=process.env.CLOUDSDK_CONFIG||(i.platform().startsWith("win")?s.join(process.env.APPDATA||"",o):s.join(process.env.HOME||"",".config",o));return s.join(e,"certificate_config.json")};let n=r(92048),i=r(19801),s=r(55315),o="gcloud";function a(e){return e.replace(/([_][^_])/g,e=>e.slice(1).toUpperCase())}class l{capacity;#O=new Map;maxAge;constructor(e){this.capacity=e.capacity,this.maxAge=e.maxAge}#I(e,t){this.#O.delete(e),this.#O.set(e,{value:t,lastAccessed:Date.now()})}set(e,t){this.#I(e,t),this.#N()}get(e){let t=this.#O.get(e);if(t)return this.#I(e,t.value),this.#N(),t.value}#N(){let e=this.maxAge?Date.now()-this.maxAge:0,t=this.#O.entries().next();for(;!t.done&&(this.#O.size>this.capacity||t.value[1].lastAccessed<e);)this.#O.delete(t.value[0]),t=this.#O.entries().next()}}async function c(e){try{return(await n.promises.lstat(e)).isFile()}catch(e){return!1}}t.LRUCache=l},50762:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Colours=void 0;class r{static isEnabled(e){return e&&e.isTTY&&("function"!=typeof e.getColorDepth||e.getColorDepth()>2)}static refresh(){r.enabled=r.isEnabled(null==process?void 0:process.stderr),this.enabled?(r.reset="\x1b[0m",r.bright="\x1b[1m",r.dim="\x1b[2m",r.red="\x1b[31m",r.green="\x1b[32m",r.yellow="\x1b[33m",r.blue="\x1b[34m",r.magenta="\x1b[35m",r.cyan="\x1b[36m",r.white="\x1b[37m",r.grey="\x1b[90m"):(r.reset="",r.bright="",r.dim="",r.red="",r.green="",r.yellow="",r.blue="",r.magenta="",r.cyan="",r.white="",r.grey="")}}t.Colours=r,r.enabled=!1,r.reset="",r.bright="",r.dim="",r.red="",r.green="",r.yellow="",r.blue="",r.magenta="",r.cyan="",r.white="",r.grey="",r.refresh()},15348:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(27042),t)},27042:function(e,t,r){"use strict";let n;var i,s,o,a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||(i=function(e){return(i=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=i(e),n=0;n<r.length;n++)"default"!==r[n]&&a(t,e,r[n]);return l(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.env=t.DebugLogBackendBase=t.placeholder=t.AdhocDebugLogger=t.LogSeverity=void 0,t.getNodeBackend=y,t.getDebugBackend=function(e){return new v(e)},t.getStructuredBackend=function(e){return new _(e)},t.setBackend=function(e){n=e,E.clear()},t.log=b;let u=r(17702),d=c(r(35816)),p=c(r(21764)),h=r(50762);(s=o||(t.LogSeverity=o={})).DEFAULT="DEFAULT",s.DEBUG="DEBUG",s.INFO="INFO",s.WARNING="WARNING",s.ERROR="ERROR";class f extends u.EventEmitter{constructor(e,t){super(),this.namespace=e,this.upstream=t,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(e,t)=>this.on(e,t)}),this.func.debug=(...e)=>this.invokeSeverity(o.DEBUG,...e),this.func.info=(...e)=>this.invokeSeverity(o.INFO,...e),this.func.warn=(...e)=>this.invokeSeverity(o.WARNING,...e),this.func.error=(...e)=>this.invokeSeverity(o.ERROR,...e),this.func.sublog=e=>b(e,this.func)}invoke(e,...t){if(this.upstream)try{this.upstream(e,...t)}catch(e){}try{this.emit("log",e,t)}catch(e){}}invokeSeverity(e,...t){this.invoke({severity:e},...t)}}t.AdhocDebugLogger=f,t.placeholder=new f("",()=>{}).func;class m{constructor(){var e;this.cached=new Map,this.filters=[],this.filtersSet=!1;let r=null!==(e=d.env[t.env.nodeEnables])&&void 0!==e?e:"*";"all"===r&&(r="*"),this.filters=r.split(",")}log(e,t,...r){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let n=this.cached.get(e);n||(n=this.makeLogger(e),this.cached.set(e,n)),n(t,...r)}catch(e){console.error(e)}}}t.DebugLogBackendBase=m;class g extends m{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(e){return this.enabledRegexp.test(e)}makeLogger(e){return this.enabledRegexp.test(e)?(t,...r)=>{var n;let i;let s=`${h.Colours.green}${e}${h.Colours.reset}`,a=`${h.Colours.yellow}${d.pid}${h.Colours.reset}`;switch(t.severity){case o.ERROR:i=`${h.Colours.red}${t.severity}${h.Colours.reset}`;break;case o.INFO:i=`${h.Colours.magenta}${t.severity}${h.Colours.reset}`;break;case o.WARNING:i=`${h.Colours.yellow}${t.severity}${h.Colours.reset}`;break;default:i=null!==(n=t.severity)&&void 0!==n?n:o.DEFAULT}let l=p.formatWithOptions({colors:h.Colours.enabled},...r),c=Object.assign({},t);delete c.severity;let u=Object.getOwnPropertyNames(c).length?JSON.stringify(c):"",f=u?`${h.Colours.grey}${u}${h.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",a,s,i,l,u?` ${f}`:"")}:()=>{}}setFilters(){let e=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${e}$`,"i")}}function y(){return new g}class v extends m{constructor(e){super(),this.debugPkg=e}makeLogger(e){let t=this.debugPkg(e);return(e,...r)=>{t(r[0],...r.slice(1))}}setFilters(){var e;let t=null!==(e=d.env.NODE_DEBUG)&&void 0!==e?e:"";d.env.NODE_DEBUG=`${t}${t?",":""}${this.filters.join(",")}`}}class _ extends m{constructor(e){super(),this.upstream=null!=e?e:void 0}makeLogger(e){var t;let r=null===(t=this.upstream)||void 0===t?void 0:t.makeLogger(e);return(e,...t)=>{var n;let i=JSON.stringify(Object.assign({severity:null!==(n=e.severity)&&void 0!==n?n:o.INFO,message:p.format(...t)},e));r?r(e,i):console.log("%s",i)}}setFilters(){var e;null===(e=this.upstream)||void 0===e||e.setFilters()}}t.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let E=new Map;function b(e,r){let i;if(!n&&!d.env[t.env.nodeEnables]||!e)return t.placeholder;r&&(e=`${r.instance.namespace}:${e}`);let s=E.get(e);if(s)return s.func;if(null===n)return t.placeholder;void 0===n&&(n=y());let o=new f(e,(t,...r)=>{if(i!==n){if(null===n)return;void 0===n&&(n=y()),i=n}null==n||n.log(e,t,...r)});return E.set(e,o),o.func}},99361:(e,t,r)=>{var n=r(82102).stringify,i=r(96712);e.exports=function(e){return{parse:i(e),stringify:n}},e.exports.parse=i(),e.exports.stringify=n},96712:(e,t,r)=>{var n=null;let i=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,s=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;e.exports=function(e){"use strict";var t={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=e){if(!0===e.strict&&(t.strict=!0),!0===e.storeAsString&&(t.storeAsString=!0),t.alwaysParseAsBig=!0===e.alwaysParseAsBig&&e.alwaysParseAsBig,t.useNativeBigInt=!0===e.useNativeBigInt&&e.useNativeBigInt,void 0!==e.constructorAction){if("error"===e.constructorAction||"ignore"===e.constructorAction||"preserve"===e.constructorAction)t.constructorAction=e.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${e.constructorAction}`)}if(void 0!==e.protoAction){if("error"===e.protoAction||"ignore"===e.protoAction||"preserve"===e.protoAction)t.protoAction=e.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${e.protoAction}`)}}var o,a,l,c,u={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},d=function(e){throw{name:"SyntaxError",message:e,at:o,text:l}},p=function(e){return e&&e!==a&&d("Expected '"+e+"' instead of '"+a+"'"),a=l.charAt(o),o+=1,a},h=function(){var e,i="";for("-"===a&&(i="-",p("-"));a>="0"&&a<="9";)i+=a,p();if("."===a)for(i+=".";p()&&a>="0"&&a<="9";)i+=a;if("e"===a||"E"===a)for(i+=a,p(),("-"===a||"+"===a)&&(i+=a,p());a>="0"&&a<="9";)i+=a,p();if(isFinite(e=+i))return(null==n&&(n=r(28254)),i.length>15)?t.storeAsString?i:t.useNativeBigInt?BigInt(i):new n(i):t.alwaysParseAsBig?t.useNativeBigInt?BigInt(e):new n(e):e;d("Bad number")},f=function(){var e,t,r,n="";if('"'===a)for(var i=o;p();){if('"'===a)return o-1>i&&(n+=l.substring(i,o-1)),p(),n;if("\\"===a){if(o-1>i&&(n+=l.substring(i,o-1)),p(),"u"===a){for(t=0,r=0;t<4&&isFinite(e=parseInt(p(),16));t+=1)r=16*r+e;n+=String.fromCharCode(r)}else if("string"==typeof u[a])n+=u[a];else break;i=o}}d("Bad string")},m=function(){for(;a&&a<=" ";)p()},g=function(){switch(a){case"t":return p("t"),p("r"),p("u"),p("e"),!0;case"f":return p("f"),p("a"),p("l"),p("s"),p("e"),!1;case"n":return p("n"),p("u"),p("l"),p("l"),null}d("Unexpected '"+a+"'")},y=function(){var e=[];if("["===a){if(p("["),m(),"]"===a)return p("]"),e;for(;a;){if(e.push(c()),m(),"]"===a)return p("]"),e;p(","),m()}}d("Bad array")},v=function(){var e,r=Object.create(null);if("{"===a){if(p("{"),m(),"}"===a)return p("}"),r;for(;a;){if(e=f(),m(),p(":"),!0===t.strict&&Object.hasOwnProperty.call(r,e)&&d('Duplicate key "'+e+'"'),!0===i.test(e)?"error"===t.protoAction?d("Object contains forbidden prototype property"):"ignore"===t.protoAction?c():r[e]=c():!0===s.test(e)?"error"===t.constructorAction?d("Object contains forbidden constructor property"):"ignore"===t.constructorAction?c():r[e]=c():r[e]=c(),m(),"}"===a)return p("}"),r;p(","),m()}}d("Bad object")};return c=function(){switch(m(),a){case"{":return v();case"[":return y();case'"':return f();case"-":return h();default:return a>="0"&&a<="9"?h():g()}},function(e,t){var r;return l=e+"",o=0,a=" ",r=c(),m(),a&&d("Syntax error"),"function"==typeof t?function e(r,n){var i,s=r[n];return s&&"object"==typeof s&&Object.keys(s).forEach(function(t){void 0!==(i=e(s,t))?s[t]=i:delete s[t]}),t.call(r,n,s)}({"":r},""):r}}},82102:(e,t,r)=>{var n=r(28254),i=e.exports;!function(){"use strict";var e,t,r,s=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(e){return s.lastIndex=0,s.test(e)?'"'+e.replace(s,function(e){var t=o[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}"function"!=typeof i.stringify&&(i.stringify=function(i,s,o){var l;if(e="",t="","number"==typeof o)for(l=0;l<o;l+=1)t+=" ";else"string"==typeof o&&(t=o);if(r=s,s&&"function"!=typeof s&&("object"!=typeof s||"number"!=typeof s.length))throw Error("JSON.stringify");return function i(s,o){var l,c,u,d,p,h=e,f=o[s],m=null!=f&&(f instanceof n||n.isBigNumber(f));switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(s)),"function"==typeof r&&(f=r.call(o,s,f)),typeof f){case"string":if(m)return f;return a(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":case"bigint":return String(f);case"object":if(!f)return"null";if(e+=t,p=[],"[object Array]"===Object.prototype.toString.apply(f)){for(l=0,d=f.length;l<d;l+=1)p[l]=i(l,f)||"null";return u=0===p.length?"[]":e?"[\n"+e+p.join(",\n"+e)+"\n"+h+"]":"["+p.join(",")+"]",e=h,u}if(r&&"object"==typeof r)for(l=0,d=r.length;l<d;l+=1)"string"==typeof r[l]&&(u=i(c=r[l],f))&&p.push(a(c)+(e?": ":":")+u);else Object.keys(f).forEach(function(t){var r=i(t,f);r&&p.push(a(t)+(e?": ":":")+r)});return u=0===p.length?"{}":e?"{\n"+e+p.join(",\n"+e)+"\n"+h+"}":"{"+p.join(",")+"}",e=h,u}}("",{"":i})})}()},95350:(e,t,r)=>{var n,i=r(90892).Buffer,s=r(84770),o=r(3164),a=r(21764),l="secret must be a string or buffer",c="key must be a string or a buffer",u="function"==typeof s.createPublicKey;function d(e){if(!i.isBuffer(e)&&"string"!=typeof e&&(!u||"object"!=typeof e||"string"!=typeof e.type||"string"!=typeof e.asymmetricKeyType||"function"!=typeof e.export))throw m(c)}function p(e){if(!i.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw m("key must be a string, a buffer or an object")}function h(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function m(e){var t=[].slice.call(arguments,1);return TypeError(a.format.bind(a,e).apply(null,t))}function g(e){var t;return t=e,i.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function y(e){return function(t,r){(function(e){if(!i.isBuffer(e)&&"string"!=typeof e&&(!u||"object"!=typeof e||"secret"!==e.type||"function"!=typeof e.export))throw m(l)})(r),t=g(t);var n=s.createHmac("sha"+e,r);return h((n.update(t),n.digest("base64")))}}u&&(c+=" or a KeyObject",l+="or a KeyObject");var v="timingSafeEqual"in s?function(e,t){return e.byteLength===t.byteLength&&s.timingSafeEqual(e,t)}:function(e,t){return n||(n=r(29916)),n(e,t)};function _(e){return function(t,r,n){var s=y(e)(t,n);return v(i.from(r),i.from(s))}}function E(e){return function(t,r){p(r),t=g(t);var n=s.createSign("RSA-SHA"+e);return h((n.update(t),n.sign(r,"base64")))}}function b(e){return function(t,r,n){d(n),t=g(t),r=f(r);var i=s.createVerify("RSA-SHA"+e);return i.update(t),i.verify(n,r,"base64")}}function x(e){return function(t,r){p(r),t=g(t);var n=s.createSign("RSA-SHA"+e);return h((n.update(t),n.sign({key:r,padding:s.constants.RSA_PKCS1_PSS_PADDING,saltLength:s.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function A(e){return function(t,r,n){d(n),t=g(t),r=f(r);var i=s.createVerify("RSA-SHA"+e);return i.update(t),i.verify({key:n,padding:s.constants.RSA_PKCS1_PSS_PADDING,saltLength:s.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function T(e){var t=E(e);return function(){var r=t.apply(null,arguments);return o.derToJose(r,"ES"+e)}}function S(e){var t=b(e);return function(r,n,i){return t(r,n=o.joseToDer(n,"ES"+e).toString("base64"),i)}}function C(){return function(){return""}}function w(){return function(e,t){return""===t}}e.exports=function(e){var t=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!t)throw m('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var r=(t[1]||t[3]).toLowerCase(),n=t[2];return{sign:({hs:y,rs:E,ps:x,es:T,none:C})[r](n),verify:({hs:_,rs:b,ps:A,es:S,none:w})[r](n)}}},8287:(e,t,r)=>{var n=r(99505),i=r(55850);t.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],t.sign=n.sign,t.verify=i.verify,t.decode=i.decode,t.isValid=i.isValid,t.createSign=function(e){return new n(e)},t.createVerify=function(e){return new i(e)}},34630:(e,t,r)=>{var n=r(90892).Buffer,i=r(76162);function s(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=n.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=n.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick((function(){this.emit("end",e),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof e+")")}r(21764).inherits(s,i),s.prototype.write=function(e){this.buffer=n.concat([this.buffer,n.from(e)]),this.emit("data",e)},s.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1},e.exports=s},99505:(e,t,r)=>{var n=r(90892).Buffer,i=r(34630),s=r(95350),o=r(76162),a=r(60904),l=r(21764);function c(e,t){return n.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function u(e){var t,r,n,i=e.header,o=e.payload,u=e.secret||e.privateKey,d=e.encoding,p=s(i.alg),h=(t=(t=d)||"utf8",r=c(a(i),"binary"),n=c(a(o),t),l.format("%s.%s",r,n)),f=p.sign(h,u);return l.format("%s.%s",h,f)}function d(e){var t=new i(e.secret||e.privateKey||e.key);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=t,this.payload=new i(e.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}l.inherits(d,o),d.prototype.sign=function(){try{var e=u({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},d.sign=u,e.exports=d},60904:(e,t,r)=>{var n=r(78893).Buffer;e.exports=function(e){return"string"==typeof e?e:"number"==typeof e||n.isBuffer(e)?e.toString():JSON.stringify(e)}},55850:(e,t,r)=>{var n=r(90892).Buffer,i=r(34630),s=r(95350),o=r(76162),a=r(60904),l=r(21764),c=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function u(e){var t=e.split(".",1)[0];return function(e){if("[object Object]"===Object.prototype.toString.call(e))return e;try{return JSON.parse(e)}catch(e){return}}(n.from(t,"base64").toString("binary"))}function d(e){return e.split(".")[2]}function p(e){return c.test(e)&&!!u(e)}function h(e,t,r){if(!t){var n=Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=d(e=a(e)),o=e.split(".",2).join(".");return s(t).verify(o,i,r)}function f(e,t){if(t=t||{},!p(e=a(e)))return null;var r,i,s=u(e);if(!s)return null;var o=(r=r||"utf8",i=e.split(".")[1],n.from(i,"base64").toString(r));return("JWT"===s.typ||t.json)&&(o=JSON.parse(o,t.encoding)),{header:s,payload:o,signature:d(e)}}function m(e){var t=new i((e=e||{}).secret||e.publicKey||e.key);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=t,this.signature=new i(e.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}l.inherits(m,o),m.prototype.verify=function(){try{var e=h(this.signature.buffer,this.algorithm,this.key.buffer),t=f(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},m.decode=f,m.isValid=p,m.verify=h,e.exports=m},90892:(e,t,r)=>{var n=r(78893),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n.SlowBuffer(e)}},17878:(e,t,r)=>{"use strict";let{EMPTY_BUFFER:n}=r(39353),i=Buffer[Symbol.species];function s(e,t,r,n,i){for(let s=0;s<i;s++)r[n+s]=e[s]^t[3&s]}function o(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}if(e.exports={concat:function(e,t){if(0===e.length)return n;if(1===e.length)return e[0];let r=Buffer.allocUnsafe(t),s=0;for(let t=0;t<e.length;t++){let n=e[t];r.set(n,s),s+=n.length}return s<t?new i(r.buffer,r.byteOffset,s):r},mask:s,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){let r;return(e.readOnly=!0,Buffer.isBuffer(t))?t:(t instanceof ArrayBuffer?r=new i(t):ArrayBuffer.isView(t)?r=new i(t.buffer,t.byteOffset,t.byteLength):(r=Buffer.from(t),e.readOnly=!1),r)},unmask:o},!process.env.WS_NO_BUFFER_UTIL)try{let t=r(58359);e.exports.mask=function(e,r,n,i,o){o<48?s(e,r,n,i,o):t.mask(e,r,n,i,o)},e.exports.unmask=function(e,r){e.length<32?o(e,r):t.unmask(e,r)}}catch(e){}},39353:e=>{"use strict";let t=["nodebuffer","arraybuffer","fragments"],r="undefined"!=typeof Blob;r&&t.push("blob"),e.exports={BINARY_TYPES:t,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:r,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},91368:(e,t,r)=>{"use strict";let{kForOnEventAttribute:n,kListener:i}=r(39353),s=Symbol("kCode"),o=Symbol("kData"),a=Symbol("kError"),l=Symbol("kMessage"),c=Symbol("kReason"),u=Symbol("kTarget"),d=Symbol("kType"),p=Symbol("kWasClean");class h{constructor(e){this[u]=null,this[d]=e}get target(){return this[u]}get type(){return this[d]}}Object.defineProperty(h.prototype,"target",{enumerable:!0}),Object.defineProperty(h.prototype,"type",{enumerable:!0});class f extends h{constructor(e,t={}){super(e),this[s]=void 0===t.code?0:t.code,this[c]=void 0===t.reason?"":t.reason,this[p]=void 0!==t.wasClean&&t.wasClean}get code(){return this[s]}get reason(){return this[c]}get wasClean(){return this[p]}}Object.defineProperty(f.prototype,"code",{enumerable:!0}),Object.defineProperty(f.prototype,"reason",{enumerable:!0}),Object.defineProperty(f.prototype,"wasClean",{enumerable:!0});class m extends h{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[l]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[l]}}Object.defineProperty(m.prototype,"error",{enumerable:!0}),Object.defineProperty(m.prototype,"message",{enumerable:!0});class g extends h{constructor(e,t={}){super(e),this[o]=void 0===t.data?null:t.data}get data(){return this[o]}}function y(e,t,r){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}Object.defineProperty(g.prototype,"data",{enumerable:!0}),e.exports={CloseEvent:f,ErrorEvent:m,Event:h,EventTarget:{addEventListener(e,t,r={}){let s;for(let s of this.listeners(e))if(!r[n]&&s[i]===t&&!s[n])return;if("message"===e)s=function(e,r){let n=new g("message",{data:r?e:e.toString()});n[u]=this,y(t,this,n)};else if("close"===e)s=function(e,r){let n=new f("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});n[u]=this,y(t,this,n)};else if("error"===e)s=function(e){let r=new m("error",{error:e,message:e.message});r[u]=this,y(t,this,r)};else{if("open"!==e)return;s=function(){let e=new h("open");e[u]=this,y(t,this,e)}}s[n]=!!r[n],s[i]=t,r.once?this.once(e,s):this.on(e,s)},removeEventListener(e,t){for(let r of this.listeners(e))if(r[i]===t&&!r[n]){this.removeListener(e,r);break}}},MessageEvent:g}},49964:(e,t,r)=>{"use strict";let{tokenChars:n}=r(94568);function i(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}e.exports={format:function(e){return Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>[t].concat(Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){let t,r;let s=Object.create(null),o=Object.create(null),a=!1,l=!1,c=!1,u=-1,d=-1,p=-1,h=0;for(;h<e.length;h++)if(d=e.charCodeAt(h),void 0===t){if(-1===p&&1===n[d])-1===u&&(u=h);else if(0!==h&&(32===d||9===d))-1===p&&-1!==u&&(p=h);else if(59===d||44===d){if(-1===u)throw SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h);let r=e.slice(u,p);44===d?(i(s,r,o),o=Object.create(null)):t=r,u=p=-1}else throw SyntaxError(`Unexpected character at index ${h}`)}else if(void 0===r){if(-1===p&&1===n[d])-1===u&&(u=h);else if(32===d||9===d)-1===p&&-1!==u&&(p=h);else if(59===d||44===d){if(-1===u)throw SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h),i(o,e.slice(u,p),!0),44===d&&(i(s,t,o),o=Object.create(null),t=void 0),u=p=-1}else if(61===d&&-1!==u&&-1===p)r=e.slice(u,h),u=p=-1;else throw SyntaxError(`Unexpected character at index ${h}`)}else if(l){if(1!==n[d])throw SyntaxError(`Unexpected character at index ${h}`);-1===u?u=h:a||(a=!0),l=!1}else if(c){if(1===n[d])-1===u&&(u=h);else if(34===d&&-1!==u)c=!1,p=h;else if(92===d)l=!0;else throw SyntaxError(`Unexpected character at index ${h}`)}else if(34===d&&61===e.charCodeAt(h-1))c=!0;else if(-1===p&&1===n[d])-1===u&&(u=h);else if(-1!==u&&(32===d||9===d))-1===p&&(p=h);else if(59===d||44===d){if(-1===u)throw SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h);let n=e.slice(u,p);a&&(n=n.replace(/\\/g,""),a=!1),i(o,r,n),44===d&&(i(s,t,o),o=Object.create(null),t=void 0),r=void 0,u=p=-1}else throw SyntaxError(`Unexpected character at index ${h}`);if(-1===u||c||32===d||9===d)throw SyntaxError("Unexpected end of input");-1===p&&(p=h);let f=e.slice(u,p);return void 0===t?i(s,f,o):(void 0===r?i(o,f,!0):a?i(o,r,f.replace(/\\/g,"")):i(o,r,f),i(s,t,o)),s}}},25936:e=>{"use strict";let t=Symbol("kDone"),r=Symbol("kRun");class n{constructor(e){this[t]=()=>{this.pending--,this[r]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[r]()}[r](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[t])}}}e.exports=n},97959:(e,t,r)=>{"use strict";let n;let i=r(71568),s=r(17878),o=r(25936),{kStatusCode:a}=r(39353),l=Buffer[Symbol.species],c=Buffer.from([0,0,255,255]),u=Symbol("permessage-deflate"),d=Symbol("total-length"),p=Symbol("callback"),h=Symbol("buffers"),f=Symbol("error");class m{constructor(e,t,r){this._maxPayload=0|r,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,n||(n=new o(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[p];this._deflate.close(),this._deflate=null,e&&e(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,r=e.find(e=>(!1!==t.serverNoContextTakeover||!e.server_no_context_takeover)&&(!e.server_max_window_bits||!1!==t.serverMaxWindowBits&&("number"!=typeof t.serverMaxWindowBits||!(t.serverMaxWindowBits>e.server_max_window_bits)))&&("number"!=typeof t.clientMaxWindowBits||!!e.client_max_window_bits));if(!r)throw Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:(!0===r.client_max_window_bits||!1===t.clientMaxWindowBits)&&delete r.client_max_window_bits,r}acceptAsClient(e){let t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let r=e[t];if(r.length>1)throw Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if("client_no_context_takeover"===t||"server_no_context_takeover"===t){if(!0!==r)throw TypeError(`Invalid value for parameter "${t}": ${r}`)}else throw Error(`Unknown parameter "${t}"`);e[t]=r})}),e}decompress(e,t,r){n.add(n=>{this._decompress(e,t,(e,t)=>{n(),r(e,t)})})}compress(e,t,r){n.add(n=>{this._compress(e,t,(e,t)=>{n(),r(e,t)})})}_decompress(e,t,r){let n=this._isServer?"client":"server";if(!this._inflate){let e=`${n}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:t}),this._inflate[u]=this,this._inflate[d]=0,this._inflate[h]=[],this._inflate.on("error",v),this._inflate.on("data",y)}this._inflate[p]=r,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush(()=>{let e=this._inflate[f];if(e){this._inflate.close(),this._inflate=null,r(e);return}let i=s.concat(this._inflate[h],this._inflate[d]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[d]=0,this._inflate[h]=[],t&&this.params[`${n}_no_context_takeover`]&&this._inflate.reset()),r(null,i)})}_compress(e,t,r){let n=this._isServer?"server":"client";if(!this._deflate){let e=`${n}_max_window_bits`,t="number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:t}),this._deflate[d]=0,this._deflate[h]=[],this._deflate.on("data",g)}this._deflate[p]=r,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=s.concat(this._deflate[h],this._deflate[d]);t&&(e=new l(e.buffer,e.byteOffset,e.length-4)),this._deflate[p]=null,this._deflate[d]=0,this._deflate[h]=[],t&&this.params[`${n}_no_context_takeover`]&&this._deflate.reset(),r(null,e)})}}function g(e){this[h].push(e),this[d]+=e.length}function y(e){if(this[d]+=e.length,this[u]._maxPayload<1||this[d]<=this[u]._maxPayload){this[h].push(e);return}this[f]=RangeError("Max payload size exceeded"),this[f].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[f][a]=1009,this.removeListener("data",y),this.reset()}function v(e){if(this[u]._inflate=null,this[f]){this[p](this[f]);return}e[a]=1007,this[p](e)}e.exports=m},83958:(e,t,r)=>{"use strict";let{Writable:n}=r(76162),i=r(97959),{BINARY_TYPES:s,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:l}=r(39353),{concat:c,toArrayBuffer:u,unmask:d}=r(17878),{isValidStatusCode:p,isValidUTF8:h}=r(94568),f=Buffer[Symbol.species];class m extends n{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||s[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[l]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let t=this._buffers[0];return this._buffers[0]=new f(t.buffer,t.byteOffset+e,t.length-e),new f(t.buffer,t.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let r=this._buffers[0],n=t.length-e;e>=r.length?t.set(this._buffers.shift(),n):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),n),this._buffers[0]=new f(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((48&t[0])!=0){e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));return}let r=(64&t[0])==64;if(r&&!this._extensions[i.extensionName]){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(this._fin=(128&t[0])==128,this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(r){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(!this._fragmented){e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));return}this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented){e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));return}this._compressed=r}else if(this._opcode>7&&this._opcode<11){if(!this._fin){e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));return}if(r){e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));return}if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength){e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"));return}}else{e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));return}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&t[1])==128,this._isServer){if(!this._masked){e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"));return}}else if(this._masked){e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));return}126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),r=t.readUInt32BE(0);if(r>2097151){e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"));return}this._payloadLength=4294967296*r+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));return}this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(e){let t=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&d(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=5,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,(e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0){t(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));return}this._fragments.push(r)}this.dataMessage(t),0===this._state&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=0;return}let t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let n;n="nodebuffer"===this._binaryType?c(r,t):"arraybuffer"===this._binaryType?u(c(r,t)):"blob"===this._binaryType?new Blob(r):r,this._allowSynchronousEvents?(this.emit("message",n,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",n,!0),this._state=0,this.startLoop(e)}))}else{let n=c(r,t);if(!this._skipUTF8Validation&&!h(n)){e(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));return}5===this._state||this._allowSynchronousEvents?(this.emit("message",n,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",n,!1),this._state=0,this.startLoop(e)}))}}controlMessage(e,t){if(8===this._opcode){if(0===e.length)this._loop=!1,this.emit("conclude",1005,o),this.end();else{let r=e.readUInt16BE(0);if(!p(r)){t(this.createError(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));return}let n=new f(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!h(n)){t(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));return}this._loop=!1,this.emit("conclude",r,n),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)}))}createError(e,t,r,n,i){this._loop=!1,this._errored=!0;let s=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(s,this.createError),s.code=i,s[a]=n,s}}e.exports=m},74036:(e,t,r)=>{"use strict";let n;let{Duplex:i}=r(76162),{randomFillSync:s}=r(84770),o=r(97959),{EMPTY_BUFFER:a,kWebSocket:l,NOOP:c}=r(39353),{isBlob:u,isValidStatusCode:d}=r(94568),{mask:p,toBuffer:h}=r(17878),f=Symbol("kByteLength"),m=Buffer.alloc(4),g=8192;class y{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=c,this[l]=void 0}static frame(e,t){let r,i;let o=!1,a=2,l=!1;t.mask&&(r=t.maskBuffer||m,t.generateMask?t.generateMask(r):(8192===g&&(void 0===n&&(n=Buffer.alloc(8192)),s(n,0,8192),g=0),r[0]=n[g++],r[1]=n[g++],r[2]=n[g++],r[3]=n[g++]),l=(r[0]|r[1]|r[2]|r[3])==0,a=6),"string"==typeof e?i=(!t.mask||l)&&void 0!==t[f]?t[f]:(e=Buffer.from(e)).length:(i=e.length,o=t.mask&&t.readOnly&&!l);let c=i;i>=65536?(a+=8,c=127):i>125&&(a+=2,c=126);let u=Buffer.allocUnsafe(o?i+a:a);return(u[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(u[0]|=64),u[1]=c,126===c?u.writeUInt16BE(i,2):127===c&&(u[2]=u[3]=0,u.writeUIntBE(i,4,6)),t.mask)?(u[1]|=128,u[a-4]=r[0],u[a-3]=r[1],u[a-2]=r[2],u[a-1]=r[3],l)?[u,e]:o?(p(e,r,u,a,i),[u]):(p(e,r,e,0,i),[u,e]):[u,e]}close(e,t,r,n){let i;if(void 0===e)i=a;else if("number"==typeof e&&d(e)){if(void 0!==t&&t.length){let r=Buffer.byteLength(t);if(r>123)throw RangeError("The message must not be greater than 123 bytes");(i=Buffer.allocUnsafe(2+r)).writeUInt16BE(e,0),"string"==typeof t?i.write(t,2):i.set(t,2)}else(i=Buffer.allocUnsafe(2)).writeUInt16BE(e,0)}else throw TypeError("First argument must be a valid error code number");let s={[f]:i.length,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,i,!1,s,n]):this.sendFrame(y.frame(i,s),n)}ping(e,t,r){let n,i;if("string"==typeof e?(n=Buffer.byteLength(e),i=!1):u(e)?(n=e.size,i=!1):(n=(e=h(e)).length,i=h.readOnly),n>125)throw RangeError("The data size must not be greater than 125 bytes");let s={[f]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:i,rsv1:!1};u(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,s,r]):this.getBlobData(e,!1,s,r):0!==this._state?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(y.frame(e,s),r)}pong(e,t,r){let n,i;if("string"==typeof e?(n=Buffer.byteLength(e),i=!1):u(e)?(n=e.size,i=!1):(n=(e=h(e)).length,i=h.readOnly),n>125)throw RangeError("The data size must not be greater than 125 bytes");let s={[f]:n,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:i,rsv1:!1};u(e)?0!==this._state?this.enqueue([this.getBlobData,e,!1,s,r]):this.getBlobData(e,!1,s,r):0!==this._state?this.enqueue([this.dispatch,e,!1,s,r]):this.sendFrame(y.frame(e,s),r)}send(e,t,r){let n,i;let s=this._extensions[o.extensionName],a=t.binary?2:1,l=t.compress;"string"==typeof e?(n=Buffer.byteLength(e),i=!1):u(e)?(n=e.size,i=!1):(n=(e=h(e)).length,i=h.readOnly),this._firstFragment?(this._firstFragment=!1,l&&s&&s.params[s._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(l=n>=s._threshold),this._compress=l):(l=!1,a=0),t.fin&&(this._firstFragment=!0);let c={[f]:n,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:a,readOnly:i,rsv1:l};u(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,c,r]):this.getBlobData(e,this._compress,c,r):0!==this._state?this.enqueue([this.dispatch,e,this._compress,c,r]):this.dispatch(e,this._compress,c,r)}getBlobData(e,t,r,n){this._bufferedBytes+=r[f],this._state=2,e.arrayBuffer().then(e=>{if(this._socket.destroyed){let e=Error("The socket was closed while the blob was being read");process.nextTick(v,this,e,n);return}this._bufferedBytes-=r[f];let i=h(e);t?this.dispatch(i,t,r,n):(this._state=0,this.sendFrame(y.frame(i,r),n),this.dequeue())}).catch(e=>{process.nextTick(_,this,e,n)})}dispatch(e,t,r,n){if(!t){this.sendFrame(y.frame(e,r),n);return}let i=this._extensions[o.extensionName];this._bufferedBytes+=r[f],this._state=1,i.compress(e,r.fin,(e,t)=>{if(this._socket.destroyed){v(this,Error("The socket was closed while data was being compressed"),n);return}this._bufferedBytes-=r[f],this._state=0,r.readOnly=!1,this.sendFrame(y.frame(t,r),n),this.dequeue()})}dequeue(){for(;0===this._state&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][f],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][f],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}function v(e,t,r){"function"==typeof r&&r(t);for(let r=0;r<e._queue.length;r++){let n=e._queue[r],i=n[n.length-1];"function"==typeof i&&i(t)}}function _(e,t,r){v(e,t,r),e.onerror(t)}e.exports=y},42504:(e,t,r)=>{"use strict";r(46342);let{Duplex:n}=r(76162);function i(e){e.emit("close")}function s(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(e){this.removeListener("error",o),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}e.exports=function(e,t){let r=!0,a=new n({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",function(t,r){let n=!r&&a._readableState.objectMode?t.toString():t;a.push(n)||e.pause()}),e.once("error",function(e){a.destroyed||(r=!1,a.destroy(e))}),e.once("close",function(){a.destroyed||a.push(null)}),a._destroy=function(t,n){if(e.readyState===e.CLOSED){n(t),process.nextTick(i,a);return}let s=!1;e.once("error",function(e){s=!0,n(e)}),e.once("close",function(){s||n(t),process.nextTick(i,a)}),r&&e.terminate()},a._final=function(t){if(e.readyState===e.CONNECTING){e.once("open",function(){a._final(t)});return}null!==e._socket&&(e._socket._writableState.finished?(t(),a._readableState.endEmitted&&a.destroy()):(e._socket.once("finish",function(){t()}),e.close()))},a._read=function(){e.isPaused&&e.resume()},a._write=function(t,r,n){if(e.readyState===e.CONNECTING){e.once("open",function(){a._write(t,r,n)});return}e.send(t,n)},a.on("end",s),a.on("error",o),a}},62444:(e,t,r)=>{"use strict";let{tokenChars:n}=r(94568);e.exports={parse:function(e){let t=new Set,r=-1,i=-1,s=0;for(;s<e.length;s++){let o=e.charCodeAt(s);if(-1===i&&1===n[o])-1===r&&(r=s);else if(0!==s&&(32===o||9===o))-1===i&&-1!==r&&(i=s);else if(44===o){if(-1===r)throw SyntaxError(`Unexpected character at index ${s}`);-1===i&&(i=s);let n=e.slice(r,i);if(t.has(n))throw SyntaxError(`The "${n}" subprotocol is duplicated`);t.add(n),r=i=-1}else throw SyntaxError(`Unexpected character at index ${s}`)}if(-1===r||-1!==i)throw SyntaxError("Unexpected end of input");let o=e.slice(r,s);if(t.has(o))throw SyntaxError(`The "${o}" subprotocol is duplicated`);return t.add(o),t}}},94568:(e,t,r)=>{"use strict";let{isUtf8:n}=r(78893),{hasBlob:i}=r(39353);function s(e){let t=e.length,r=0;for(;r<t;)if((128&e[r])==0)r++;else if((224&e[r])==192){if(r+1===t||(192&e[r+1])!=128||(254&e[r])==192)return!1;r+=2}else if((240&e[r])==224){if(r+2>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||224===e[r]&&(224&e[r+1])==128||237===e[r]&&(224&e[r+1])==160)return!1;r+=3}else{if((248&e[r])!=240||r+3>=t||(192&e[r+1])!=128||(192&e[r+2])!=128||(192&e[r+3])!=128||240===e[r]&&(240&e[r+1])==128||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}return!0}if(e.exports={isBlob:function(e){return i&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:s,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},n)e.exports.isValidUTF8=function(e){return e.length<24?s(e):n(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=r(93739);e.exports.isValidUTF8=function(e){return e.length<32?s(e):t(e)}}catch(e){}},30359:(e,t,r)=>{"use strict";let n=r(17702),i=r(32615),{Duplex:s}=r(76162),{createHash:o}=r(84770),a=r(49964),l=r(97959),c=r(62444),u=r(46342),{GUID:d,kWebSocket:p}=r(39353),h=/^[+/0-9A-Za-z]{22}==$/;class f extends n{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:u,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer((e,t)=>{let r=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(let r of Object.keys(t))e.on(r,t[r]);return function(){for(let r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,n)=>{this.handleUpgrade(t,r,n,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state){e&&this.once("close",()=>{e(Error("The server is not running"))}),process.nextTick(m,this);return}if(e&&this.once("close",e),1!==this._state){if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(m,this);else{let e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close(()=>{m(this)})}}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,n){t.on("error",g);let i=e.headers["sec-websocket-key"],s=e.headers.upgrade,o=+e.headers["sec-websocket-version"];if("GET"!==e.method){v(this,e,t,405,"Invalid HTTP method");return}if(void 0===s||"websocket"!==s.toLowerCase()){v(this,e,t,400,"Invalid Upgrade header");return}if(void 0===i||!h.test(i)){v(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(13!==o&&8!==o){v(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});return}if(!this.shouldHandle(e)){y(t,400);return}let u=e.headers["sec-websocket-protocol"],d=new Set;if(void 0!==u)try{d=c.parse(u)}catch(r){v(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let p=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==p){let r=new l(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let e=a.parse(p);e[l.extensionName]&&(r.accept(e[l.extensionName]),f[l.extensionName]=r)}catch(r){v(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let s={origin:e.headers[`${8===o?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(2===this.options.verifyClient.length){this.options.verifyClient(s,(s,o,a,l)=>{if(!s)return y(t,o||401,a,l);this.completeUpgrade(f,i,d,e,t,r,n)});return}if(!this.options.verifyClient(s))return y(t,401)}this.completeUpgrade(f,i,d,e,t,r,n)}completeUpgrade(e,t,r,n,i,s,c){if(!i.readable||!i.writable)return i.destroy();if(i[p])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return y(i,503);let u=o("sha1").update(t+d).digest("base64"),h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${u}`],f=new this.options.WebSocket(null,void 0,this.options);if(r.size){let e=this.options.handleProtocols?this.options.handleProtocols(r,n):r.values().next().value;e&&(h.push(`Sec-WebSocket-Protocol: ${e}`),f._protocol=e)}if(e[l.extensionName]){let t=e[l.extensionName].params,r=a.format({[l.extensionName]:[t]});h.push(`Sec-WebSocket-Extensions: ${r}`),f._extensions=e}this.emit("headers",h,n),i.write(h.concat("\r\n").join("\r\n")),i.removeListener("error",g),f.setSocket(i,s,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(f),f.on("close",()=>{this.clients.delete(f),this._shouldEmitClose&&!this.clients.size&&process.nextTick(m,this)})),c(f,n)}}function m(e){e._state=2,e.emit("close")}function g(){this.destroy()}function y(e,t,r,n){r=r||i.STATUS_CODES[t],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r
`+Object.keys(n).map(e=>`${e}: ${n[e]}`).join("\r\n")+"\r\n\r\n"+r)}function v(e,t,r,n,i,s){if(e.listenerCount("wsClientError")){let n=Error(i);Error.captureStackTrace(n,v),e.emit("wsClientError",n,r,t)}else y(r,n,i,s)}e.exports=f},46342:(e,t,r)=>{"use strict";let n=r(17702),i=r(35240),s=r(32615),o=r(98216),a=r(82452),{randomBytes:l,createHash:c}=r(84770),{Duplex:u,Readable:d}=r(76162),{URL:p}=r(17360),h=r(97959),f=r(83958),m=r(74036),{isBlob:g}=r(94568),{BINARY_TYPES:y,EMPTY_BUFFER:v,GUID:_,kForOnEventAttribute:E,kListener:b,kStatusCode:x,kWebSocket:A,NOOP:T}=r(39353),{EventTarget:{addEventListener:S,removeEventListener:C}}=r(91368),{format:w,parse:O}=r(49964),{toBuffer:I}=r(17878),N=Symbol("kAborted"),k=[8,13],R=["CONNECTING","OPEN","CLOSING","CLOSED"],P=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class j extends n{constructor(e,t,r){super(),this._binaryType=y[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=v,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=j.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===t?t=[]:Array.isArray(t)||("object"==typeof t&&null!==t?(r=t,t=[]):t=[t]),function e(t,r,n,o){let a,u,d,f;let m={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:k[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...o,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=m.autoPong,!k.includes(m.protocolVersion))throw RangeError(`Unsupported protocol version: ${m.protocolVersion} (supported versions: ${k.join(", ")})`);if(r instanceof p)a=r;else try{a=new p(r)}catch(e){throw SyntaxError(`Invalid URL: ${r}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),t._url=a.href;let g="wss:"===a.protocol,y="ws+unix:"===a.protocol;if("ws:"===a.protocol||g||y?y&&!a.pathname?u="The URL's pathname is empty":a.hash&&(u="The URL contains a fragment identifier"):u='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',u){let e=SyntaxError(u);if(0===t._redirects)throw e;D(t,e);return}let v=g?443:80,E=l(16).toString("base64"),b=g?i.request:s.request,x=new Set;if(m.createConnection=m.createConnection||(g?M:U),m.defaultPort=m.defaultPort||v,m.port=a.port||v,m.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,m.headers={...m.headers,"Sec-WebSocket-Version":m.protocolVersion,"Sec-WebSocket-Key":E,Connection:"Upgrade",Upgrade:"websocket"},m.path=a.pathname+a.search,m.timeout=m.handshakeTimeout,m.perMessageDeflate&&(d=new h(!0!==m.perMessageDeflate?m.perMessageDeflate:{},!1,m.maxPayload),m.headers["Sec-WebSocket-Extensions"]=w({[h.extensionName]:d.offer()})),n.length){for(let e of n){if("string"!=typeof e||!P.test(e)||x.has(e))throw SyntaxError("An invalid or duplicated subprotocol was specified");x.add(e)}m.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(m.origin&&(m.protocolVersion<13?m.headers["Sec-WebSocket-Origin"]=m.origin:m.headers.Origin=m.origin),(a.username||a.password)&&(m.auth=`${a.username}:${a.password}`),y){let e=m.path.split(":");m.socketPath=e[0],m.path=e[1]}if(m.followRedirects){if(0===t._redirects){t._originalIpc=y,t._originalSecure=g,t._originalHostOrSocketPath=y?m.socketPath:a.host;let e=o&&o.headers;if(o={...o,headers:{}},e)for(let[t,r]of Object.entries(e))o.headers[t.toLowerCase()]=r}else if(0===t.listenerCount("redirect")){let e=y?!!t._originalIpc&&m.socketPath===t._originalHostOrSocketPath:!t._originalIpc&&a.host===t._originalHostOrSocketPath;e&&(!t._originalSecure||g)||(delete m.headers.authorization,delete m.headers.cookie,e||delete m.headers.host,m.auth=void 0)}m.auth&&!o.headers.authorization&&(o.headers.authorization="Basic "+Buffer.from(m.auth).toString("base64")),f=t._req=b(m),t._redirects&&t.emit("redirect",t.url,f)}else f=t._req=b(m);m.timeout&&f.on("timeout",()=>{L(t,f,"Opening handshake has timed out")}),f.on("error",e=>{null===f||f[N]||(f=t._req=null,D(t,e))}),f.on("response",i=>{let s=i.headers.location,a=i.statusCode;if(s&&m.followRedirects&&a>=300&&a<400){let i;if(++t._redirects>m.maxRedirects){L(t,f,"Maximum redirects exceeded");return}f.abort();try{i=new p(s,r)}catch(e){D(t,SyntaxError(`Invalid URL: ${s}`));return}e(t,i,n,o)}else t.emit("unexpected-response",f,i)||L(t,f,`Unexpected server response: ${i.statusCode}`)}),f.on("upgrade",(e,r,n)=>{let i;if(t.emit("upgrade",e),t.readyState!==j.CONNECTING)return;f=t._req=null;let s=e.headers.upgrade;if(void 0===s||"websocket"!==s.toLowerCase()){L(t,r,"Invalid Upgrade header");return}let o=c("sha1").update(E+_).digest("base64");if(e.headers["sec-websocket-accept"]!==o){L(t,r,"Invalid Sec-WebSocket-Accept header");return}let a=e.headers["sec-websocket-protocol"];if(void 0!==a?x.size?x.has(a)||(i="Server sent an invalid subprotocol"):i="Server sent a subprotocol but none was requested":x.size&&(i="Server sent no subprotocol"),i){L(t,r,i);return}a&&(t._protocol=a);let l=e.headers["sec-websocket-extensions"];if(void 0!==l){let e;if(!d){L(t,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}try{e=O(l)}catch(e){L(t,r,"Invalid Sec-WebSocket-Extensions header");return}let n=Object.keys(e);if(1!==n.length||n[0]!==h.extensionName){L(t,r,"Server indicated an extension that was not requested");return}try{d.accept(e[h.extensionName])}catch(e){L(t,r,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[h.extensionName]=d}t.setSocket(r,n,{allowSynchronousEvents:m.allowSynchronousEvents,generateMask:m.generateMask,maxPayload:m.maxPayload,skipUTF8Validation:m.skipUTF8Validation})}),m.finishRequest?m.finishRequest(f,t):f.end()}(this,e,t,r)):(this._autoPong=r.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){y.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,r){let n=new f({allowSynchronousEvents:r.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:r.maxPayload,skipUTF8Validation:r.skipUTF8Validation}),i=new m(e,this._extensions,r.generateMask);this._receiver=n,this._sender=i,this._socket=e,n[A]=this,i[A]=this,e[A]=this,n.on("conclude",q),n.on("drain",F),n.on("error",B),n.on("message",V),n.on("ping",$),n.on("pong",J),i.onerror=K,e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",z),e.on("data",X),e.on("end",Z),e.on("error",Q),this._readyState=j.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=j.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=j.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==j.CLOSED){if(this.readyState===j.CONNECTING){L(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===j.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=j.CLOSING,this._sender.close(e,t,!this._isServer,e=>{!e&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),Y(this)}}pause(){this.readyState!==j.CONNECTING&&this.readyState!==j.CLOSED&&(this._paused=!0,this._socket.pause())}ping(e,t,r){if(this.readyState===j.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==j.OPEN){G(this,e,r);return}void 0===t&&(t=!this._isServer),this._sender.ping(e||v,t,r)}pong(e,t,r){if(this.readyState===j.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),"number"==typeof e&&(e=e.toString()),this.readyState!==j.OPEN){G(this,e,r);return}void 0===t&&(t=!this._isServer),this._sender.pong(e||v,t,r)}resume(){this.readyState!==j.CONNECTING&&this.readyState!==j.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,r){if(this.readyState===j.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof t&&(r=t,t={}),"number"==typeof e&&(e=e.toString()),this.readyState!==j.OPEN){G(this,e,r);return}let n={binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[h.extensionName]||(n.compress=!1),this._sender.send(e||v,n,r)}terminate(){if(this.readyState!==j.CLOSED){if(this.readyState===j.CONNECTING){L(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=j.CLOSING,this._socket.destroy())}}}function D(e,t){e._readyState=j.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function U(e){return e.path=e.socketPath,o.connect(e)}function M(e){return e.path=void 0,e.servername||""===e.servername||(e.servername=o.isIP(e.host)?"":e.host),a.connect(e)}function L(e,t,r){e._readyState=j.CLOSING;let n=Error(r);Error.captureStackTrace(n,L),t.setHeader?(t[N]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(D,e,n)):(t.destroy(n),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function G(e,t,r){if(t){let r=g(t)?t.size:I(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){let t=Error(`WebSocket is not open: readyState ${e.readyState} (${R[e.readyState]})`);process.nextTick(r,t)}}function q(e,t){let r=this[A];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[A]&&(r._socket.removeListener("data",X),process.nextTick(W,r._socket),1005===e?r.close():r.close(e,t))}function F(){let e=this[A];e.isPaused||e._socket.resume()}function B(e){let t=this[A];void 0!==t._socket[A]&&(t._socket.removeListener("data",X),process.nextTick(W,t._socket),t.close(e[x])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function H(){this[A].emitClose()}function V(e,t){this[A].emit("message",e,t)}function $(e){let t=this[A];t._autoPong&&t.pong(e,!this._isServer,T),t.emit("ping",e)}function J(e){this[A].emit("pong",e)}function W(e){e.resume()}function K(e){let t=this[A];t.readyState===j.CLOSED||(t.readyState===j.OPEN&&(t._readyState=j.CLOSING,Y(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function Y(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),3e4)}function z(){let e;let t=this[A];this.removeListener("close",z),this.removeListener("data",X),this.removeListener("end",Z),t._readyState=j.CLOSING,this._readableState.endEmitted||t._closeFrameReceived||t._receiver._writableState.errorEmitted||null===(e=t._socket.read())||t._receiver.write(e),t._receiver.end(),this[A]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",H),t._receiver.on("finish",H))}function X(e){this[A]._receiver.write(e)||this.pause()}function Z(){let e=this[A];e._readyState=j.CLOSING,e._receiver.end(),this.end()}function Q(){let e=this[A];this.removeListener("error",Q),this.on("error",T),e&&(e._readyState=j.CLOSING,this.destroy())}Object.defineProperty(j,"CONNECTING",{enumerable:!0,value:R.indexOf("CONNECTING")}),Object.defineProperty(j.prototype,"CONNECTING",{enumerable:!0,value:R.indexOf("CONNECTING")}),Object.defineProperty(j,"OPEN",{enumerable:!0,value:R.indexOf("OPEN")}),Object.defineProperty(j.prototype,"OPEN",{enumerable:!0,value:R.indexOf("OPEN")}),Object.defineProperty(j,"CLOSING",{enumerable:!0,value:R.indexOf("CLOSING")}),Object.defineProperty(j.prototype,"CLOSING",{enumerable:!0,value:R.indexOf("CLOSING")}),Object.defineProperty(j,"CLOSED",{enumerable:!0,value:R.indexOf("CLOSED")}),Object.defineProperty(j.prototype,"CLOSED",{enumerable:!0,value:R.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(e=>{Object.defineProperty(j.prototype,e,{enumerable:!0})}),["open","error","close","message"].forEach(e=>{Object.defineProperty(j.prototype,`on${e}`,{enumerable:!0,get(){for(let t of this.listeners(e))if(t[E])return t[b];return null},set(t){for(let t of this.listeners(e))if(t[E]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[E]:!0})}})}),j.prototype.addEventListener=S,j.prototype.removeEventListener=C,e.exports=j},4817:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l,metadata:()=>a});var n=r(19510);r(67272);var i=r(68570);let s=(0,i.createProxy)(String.raw`/Users/macbook/Desktop/Projects/visionvalu_-ai-property-valuation/contexts/AuthContext.tsx#AuthProvider`);(0,i.createProxy)(String.raw`/Users/macbook/Desktop/Projects/visionvalu_-ai-property-valuation/contexts/AuthContext.tsx#useAuth`);let o=(0,i.createProxy)(String.raw`/Users/macbook/Desktop/Projects/visionvalu_-ai-property-valuation/lib/query-client.tsx#QueryProvider`),a={title:"HomeWorth - AI Property Valuation",description:"Get instant AI-powered property valuations with just a few photos"};function l({children:e}){return n.jsx("html",{lang:"en",children:n.jsx("body",{children:n.jsx(o,{children:n.jsx(s,{children:e})})})})}},33079:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(19510),i=r(19692),s=r(58585);let o=(0,r(68570).createProxy)(String.raw`/Users/macbook/Desktop/Projects/visionvalu_-ai-property-valuation/components/Homepage.tsx#default`);async function a(){let e=await (0,i.e)(),{data:{user:t}}=await e.auth.getUser();return t&&(0,s.redirect)("/dashboard"),n.jsx(o,{})}},19692:(e,t,r)=>{"use strict";r.d(t,{e:()=>s});var n=r(2305),i=r(71615);async function s(){let e=await (0,i.cookies)();return(0,n.createServerClient)("https://bbbengshbvpqxtzrphov.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJiYmVuZ3NoYnZwcXh0enJwaG92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEzNzcxNjYsImV4cCI6MjA3Njk1MzE2Nn0.CkmmMBMjbQlJgsgMjRLGfjE6fO-BXiis8nZflT16VX8",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:n})=>e.set(t,r,n))}catch{}}}})}},67272:()=>{},15506:(e,t,r)=>{"use strict";let n=r(83674);e.exports={pkg:n}},41324:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GCE_LINUX_BIOS_PATHS=void 0,t.isGoogleCloudServerless=o,t.isGoogleComputeEngineLinux=a,t.isGoogleComputeEngineMACAddress=l,t.isGoogleComputeEngine=c,t.detectGCPResidency=function(){return o()||c()};let n=r(92048),i=r(19801);t.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let s=/^42:01/;function o(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function a(){if("linux"!==(0,i.platform)())return!1;try{(0,n.statSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_DATE);let e=(0,n.readFileSync)(t.GCE_LINUX_BIOS_PATHS.BIOS_VENDOR,"utf8");return/Google/.test(e)}catch{return!1}}function l(){for(let e of Object.values((0,i.networkInterfaces)()))if(e){for(let{mac:t}of e)if(s.test(t))return!0}return!1}function c(){return a()||l()}},80759:function(e,t,r){"use strict";let n;var i,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(i=function(e){return(i=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t})(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=i(e),n=0;n<r.length;n++)"default"!==r[n]&&s(t,e,r[n]);return o(t,e),t}),l=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||s(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.gcpResidencyCache=t.METADATA_SERVER_DETECTION=t.HEADERS=t.HEADER_VALUE=t.HEADER_NAME=t.SECONDARY_HOST_ADDRESS=t.HOST_ADDRESS=t.BASE_PATH=void 0,t.instance=function(e){return m("instance",e)},t.project=function(e){return m("project",e)},t.universe=function(e){return m("universe",e)},t.bulk=y,t.isAvailable=v,t.resetIsAvailableCache=function(){n=void 0},t.getGCPResidency=_,t.setGCPResidency=E,t.requestTimeout=b;let c=r(90206),u=r(99361),d=r(41324),p=a(r(15348));t.BASE_PATH="/computeMetadata/v1",t.HOST_ADDRESS="http://169.254.169.254",t.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",t.HEADER_NAME="Metadata-Flavor",t.HEADER_VALUE="Google",t.HEADERS=Object.freeze({[t.HEADER_NAME]:t.HEADER_VALUE});let h=p.log("gcp-metadata");function f(e){return e||(e=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||t.HOST_ADDRESS),/^https?:\/\//.test(e)||(e=`http://${e}`),new URL(t.BASE_PATH,e).href}async function m(e,r={},n=3,i=!1){let s=new Headers(t.HEADERS),o="",a={};"object"==typeof e?(new Headers(e.headers).forEach((e,t)=>s.set(t,e)),o=e.metadataKey,a=e.params||a,n=e.noResponseRetries||n,i=e.fastFail||i):o=e,"string"==typeof r?o+=`/${r}`:(function(e){Object.keys(e).forEach(e=>{switch(e){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${e}' is not a valid configuration option.`)}})}(r),r.property&&(o+=`/${r.property}`),new Headers(r.headers).forEach((e,t)=>s.set(t,e)),a=r.params||a);let l=i?g:c.request,d={url:`${f()}/${o}`,headers:s,retryConfig:{noResponseRetries:n},params:a,responseType:"text",timeout:b()};h.info("instance request %j",d);let p=await l(d);h.info("instance metadata is %s",p.data);let m=p.headers.get(t.HEADER_NAME);if(m!==t.HEADER_VALUE)throw RangeError(`Invalid response from metadata service: incorrect ${t.HEADER_NAME} header. Expected '${t.HEADER_VALUE}', got ${m?`'${m}'`:"no header"}`);if("string"==typeof p.data)try{return u.parse(p.data)}catch{}return p.data}async function g(e){let r={...e,url:e.url?.toString().replace(f(),f(t.SECONDARY_HOST_ADDRESS))};return Promise.any([(0,c.request)(e),(0,c.request)(r)])}async function y(e){let t={};return await Promise.all(e.map(e=>(async()=>{let r=await m(e);t[e.metadataKey]=r})())),t}async function v(){if(process.env.METADATA_SERVER_DETECTION){let e=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(e in t.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${e}\`, but it should be \`${Object.keys(t.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(e){case"assume-present":return!0;case"none":return!1;case"bios-only":return _()}}try{return void 0===n&&(n=m("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await n,!0}catch(e){if(process.env.DEBUG_AUTH&&console.info(e),"request-timeout"===e.type||e.response&&404===e.response.status)return!1;if(!(e.response&&404===e.response.status)&&(!e.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(e.code.toString()))){let t="UNKNOWN";e.code&&(t=e.code.toString()),process.emitWarning(`received unexpected error = ${e.message} code = ${t}`,"MetadataLookupWarning")}return!1}}function _(){return null===t.gcpResidencyCache&&E(),t.gcpResidencyCache}function E(e=null){t.gcpResidencyCache=null!==e?e:(0,d.detectGCPResidency)()}function b(){return _()?0:3e3}t.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),t.gcpResidencyCache=null,l(r(41324),t)},14574:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_AGENT=t.PRODUCT_NAME=t.pkg=void 0;let n=r(99830);t.pkg=n;let i="google-api-nodejs-client";t.PRODUCT_NAME=i;let s=`${i}/${n.version}`;t.USER_AGENT=s},1838:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleToken=void 0;var n=l(r(92048)),i=r(90206),s=l(r(8287)),o=l(r(55315)),a=r(21764);function l(e,t){if("function"==typeof WeakMap)var r=new WeakMap,n=new WeakMap;return(l=function(e,t){if(!t&&e&&e.__esModule)return e;var i,s,o={__proto__:null,default:e};if(null===e||"object"!=c(e)&&"function"!=typeof e)return o;if(i=t?n:r){if(i.has(e))return i.get(e);i.set(e,o)}for(var a in e)"default"!==a&&({}).hasOwnProperty.call(e,a)&&((s=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,a))&&(s.get||s.set)?i(o,a,s):o[a]=e[a]);return o})(e,t)}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function d(e,t,r){return e.set(p(e,t),r),r}function p(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw TypeError("Private element is not present on this object")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function f(e,t,r){return t&&h(e.prototype,t),r&&h(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function m(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function g(e){var t="function"==typeof Map?new Map:void 0;return(g=function(e){if(null===e||!function(e){try{return -1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(y())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&v(i,r.prototype),i}(e,arguments,_(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),v(r,e)})(e)}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t,r){return(t=b(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=c(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==c(t)?t:t+""}function x(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var l=Object.create((n&&n.prototype instanceof a?n:a).prototype);return A(l,"_invoke",function(r,n,i){var s,a,l,c=0,u=i||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,r){return s=t,a=0,l=e,p.n=r,o}};function h(r,n){for(a=r,l=n,t=0;!d&&c&&!i&&t<u.length;t++){var i,s=u[t],h=p.p,f=s[2];r>3?(i=f===n)&&(l=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=h&&((i=r<2&&h<s[1])?(a=0,p.v=n,p.n=s[1]):h<f&&(i=r<3||s[0]>n||n>f)&&(s[4]=r,s[5]=n,p.n=f,a=0))}if(i||r>1)return o;throw d=!0,n}return function(i,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),a=u,l=f;(t=a<2?e:l)||!d;){s||(a?a<3?(a>1&&(p.n=-1),h(a,l)):p.n=l:p.v=l);try{if(c=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(d=p.n<0)?l:r.call(n,p))!==o)break}catch(t){s=e,a=1,l=t}finally{c=1}}return{value:t,done:d}}}(r,i,s),!0),l}var o={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(A(t={},n,function(){return this}),t),d=c.prototype=a.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,A(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,A(d,"constructor",c),A(c,"constructor",l),l.displayName="GeneratorFunction",A(c,i,"GeneratorFunction"),A(d),A(d,i,"Generator"),A(d,n,function(){return this}),A(d,"toString",function(){return"[object Generator]"}),(x=function(){return{w:s,m:p}})()}function A(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}(A=function(e,t,r,n){if(t)i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{var s=function(t,r){A(e,t,function(e){return this._invoke(t,r,e)})};s("next",0),s("throw",1),s("return",2)}})(e,t,r,n)}function T(e,t,r,n,i,s,o){try{var a=e[s](o),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function S(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){T(s,n,i,o,a,"next",e)}function a(e){T(s,n,i,o,a,"throw",e)}o(void 0)})}}var C=n.readFile?(0,a.promisify)(n.readFile):S(x().m(function e(){return x().w(function(e){for(;;)switch(e.n){case 0:throw new O("use key rather than keyFile.","MISSING_CREDENTIALS");case 1:return e.a(2)}},e)})),w="https://oauth2.googleapis.com/token",O=function(e){function t(e,r){var n,i,s;return m(this,t),i=t,s=[e],i=_(i),E(n=function(e,t){if(t&&("object"==c(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,y()?Reflect.construct(i,s||[],_(this).constructor):i.apply(this,s)),"code",void 0),n.code=r,n}return function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(t,e),f(t)}(g(Error)),I=new WeakMap,N=new WeakSet;function k(e){return R.apply(this,arguments)}function R(){return(R=S(x().m(function e(t){return x().w(function(e){for(;;)switch(e.n){case 0:if(!I.get(p(I,this))||t.forceRefresh){e.n=1;break}return e.a(2,I.get(p(I,this)));case 1:return e.p=1,e.n=2,d(I,this,p(N,this,P).call(this,t));case 2:return e.a(2,e.v);case 3:return e.p=3,d(I,this,void 0),e.f(3);case 4:return e.a(2)}},e,this,[[1,,3,4]])}))).apply(this,arguments)}function P(e){return j.apply(this,arguments)}function j(){return(j=S(x().m(function e(t){var r;return x().w(function(e){for(;;)switch(e.n){case 0:if(!(!1===this.isTokenExpiring()&&!1===t.forceRefresh)){e.n=1;break}return e.a(2,Promise.resolve(this.rawToken));case 1:if(!(!this.key&&!this.keyFile)){e.n=2;break}throw Error("No key or keyFile set.");case 2:if(!(!this.key&&this.keyFile)){e.n=4;break}return e.n=3,this.getCredentials(this.keyFile);case 3:r=e.v,this.key=r.privateKey,this.iss=r.clientEmail||this.iss,r.clientEmail||p(N,this,D).call(this);case 4:return e.a(2,p(N,this,G).call(this))}},e,this)}))).apply(this,arguments)}function D(){if(!this.iss)throw new O("email is required.","MISSING_CREDENTIALS")}function U(){return M.apply(this,arguments)}function M(){return(M=S(x().m(function e(){var t;return x().w(function(e){for(;;)switch(e.n){case 0:if(this.accessToken){e.n=1;break}throw Error("No token to revoke.");case 1:return t="https://oauth2.googleapis.com/revoke?token="+this.accessToken,e.n=2,this.transporter.request({url:t,retry:!0});case 2:p(N,this,L).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims});case 3:return e.a(2)}},e,this)}))).apply(this,arguments)}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.keyFile=e.keyFile,this.key=e.key,this.rawToken=void 0,this.iss=e.email||e.iss,this.sub=e.sub,this.additionalClaims=e.additionalClaims,"object"===c(e.scope)?this.scope=e.scope.join(" "):this.scope=e.scope,this.eagerRefreshThresholdMillis=e.eagerRefreshThresholdMillis,e.transporter&&(this.transporter=e.transporter)}function G(){return q.apply(this,arguments)}function q(){return(q=S(x().m(function e(){var t,r,n,i,o,a,l,c,u,d;return x().w(function(e){for(;;)switch(e.n){case 0:return t=Math.floor(new Date().getTime()/1e3),r=this.additionalClaims||{},n=Object.assign({iss:this.iss,scope:this.scope,aud:w,exp:t+3600,iat:t,sub:this.sub},r),i=s.sign({header:{alg:"RS256"},payload:n,secret:this.key}),e.p=1,e.n=2,this.transporter.request({method:"POST",url:w,data:new URLSearchParams({grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:i}),responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});case 2:return o=e.v,this.rawToken=o.data,this.expiresAt=null===o.data.expires_in||void 0===o.data.expires_in?void 0:(t+o.data.expires_in)*1e3,e.a(2,this.rawToken);case 3:throw e.p=3,d=e.v,this.rawToken=void 0,this.tokenExpires=void 0,(c=d.response&&null!==(a=d.response)&&void 0!==a&&a.data?null===(l=d.response)||void 0===l?void 0:l.data:{}).error&&(u=c.error_description?": ".concat(c.error_description):"",d.message="".concat(c.error).concat(u)),d;case 4:return e.a(2)}},e,this,[[1,3]])}))).apply(this,arguments)}t.GoogleToken=function(){var e;return f(function e(t){var r;m(this,e),u(this,N),N.add(this),E(this,"expiresAt",void 0),E(this,"key",void 0),E(this,"keyFile",void 0),E(this,"iss",void 0),E(this,"sub",void 0),E(this,"scope",void 0),E(this,"rawToken",void 0),E(this,"tokenExpires",void 0),E(this,"email",void 0),E(this,"additionalClaims",void 0),E(this,"eagerRefreshThresholdMillis",void 0),E(this,"transporter",{request:function(e){return(0,i.request)(e)}}),r=void 0,u(this,I),I.set(this,r),p(N,this,L).call(this,t)},[{key:"accessToken",get:function(){return this.rawToken?this.rawToken.access_token:void 0}},{key:"idToken",get:function(){return this.rawToken?this.rawToken.id_token:void 0}},{key:"tokenType",get:function(){return this.rawToken?this.rawToken.token_type:void 0}},{key:"refreshToken",get:function(){return this.rawToken?this.rawToken.refresh_token:void 0}},{key:"hasExpired",value:function(){var e=new Date().getTime();return!this.rawToken||!this.expiresAt||e>=this.expiresAt}},{key:"isTokenExpiring",value:function(){var e,t=new Date().getTime(),r=null!==(e=this.eagerRefreshThresholdMillis)&&void 0!==e?e:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=t+r}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===c(e)&&(t=e,e=void 0),t=Object.assign({forceRefresh:!1},t),e){var r=e;p(N,this,k).call(this,t).then(function(e){return r(null,e)},e);return}return p(N,this,k).call(this,t)}},{key:"getCredentials",value:(e=S(x().m(function e(t){var r,n,i,s,a;return x().w(function(e){for(;;)switch(e.n){case 0:a=o.extname(t),e.n=".json"===a?1:".der"===a?4:".crt"===a?4:".pem"===a?4:".p12"===a?6:".pfx"===a?6:7;break;case 1:return e.n=2,C(t,"utf8");case 2:if(n=(r=JSON.parse(e.v)).private_key,i=r.client_email,!(!n||!i)){e.n=3;break}throw new O("private_key and client_email are required.","MISSING_CREDENTIALS");case 3:return e.a(2,{privateKey:n,clientEmail:i});case 4:return e.n=5,C(t,"utf8");case 5:return s=e.v,e.a(2,{privateKey:s});case 6:throw new O("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");case 7:throw new O("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE");case 8:return e.a(2)}},e)})),function(t){return e.apply(this,arguments)})},{key:"revokeToken",value:function(e){if(e){p(N,this,U).call(this).then(function(){return e()},e);return}return p(N,this,U).call(this)}}])}()},83674:e=>{"use strict";e.exports=JSON.parse('{"name":"gaxios","version":"7.1.2","description":"A simple common HTTP client specifically for Google APIs and services.","main":"build/cjs/src/index.js","types":"build/cjs/src/index.d.ts","files":["build/"],"exports":{".":{"import":{"types":"./build/esm/src/index.d.ts","default":"./build/esm/src/index.js"},"require":{"types":"./build/cjs/src/index.d.ts","default":"./build/cjs/src/index.js"}}},"scripts":{"lint":"gts check --no-inline-config","test":"c8 mocha build/esm/test","presystem-test":"npm run compile","system-test":"mocha build/esm/system-test --timeout 80000","compile":"tsc -b ./tsconfig.json ./tsconfig.cjs.json && node utils/enable-esm.mjs","fix":"gts fix","prepare":"npm run compile","pretest":"npm run compile","webpack":"webpack","prebrowser-test":"npm run compile","browser-test":"node build/browser-test/browser-test-runner.js","docs":"jsdoc -c .jsdoc.js","docs-test":"linkinator docs","predocs-test":"npm run docs","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","prelint":"cd samples; npm link ../; npm install","clean":"gts clean"},"repository":"googleapis/gaxios","keywords":["google"],"engines":{"node":">=18"},"author":"Google, LLC","license":"Apache-2.0","devDependencies":{"@babel/plugin-proposal-private-methods":"^7.18.6","@types/cors":"^2.8.6","@types/express":"^5.0.0","@types/extend":"^3.0.1","@types/mocha":"^10.0.10","@types/multiparty":"4.2.1","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","@types/tmp":"0.2.6","assert":"^2.0.0","browserify":"^17.0.0","c8":"^10.0.0","cors":"^2.8.5","express":"^5.0.0","gts":"^6.0.0","is-docker":"^3.0.0","jsdoc":"^4.0.0","jsdoc-fresh":"^4.0.0","jsdoc-region-tag":"^3.0.0","karma":"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1","linkinator":"^6.1.2","mocha":"^11.1.0","multiparty":"^4.2.1","mv":"^2.1.1","ncp":"^2.0.0","nock":"^14.0.0-beta.13","null-loader":"^4.0.0","pack-n-play":"^3.0.0","puppeteer":"^24.0.0","sinon":"^21.0.0","stream-browserify":"^3.0.0","tmp":"0.2.5","ts-loader":"^9.5.2","typescript":"^5.8.3","webpack":"^5.35.0","webpack-cli":"^6.0.1"},"dependencies":{"extend":"^3.0.2","https-proxy-agent":"^7.0.1","node-fetch":"^3.3.2"}}')},99830:e=>{"use strict";e.exports=JSON.parse('{"name":"google-auth-library","version":"10.4.2","author":"Google Inc.","description":"Google APIs Authentication Client Library for Node.js","engines":{"node":">=18"},"main":"./build/src/index.js","types":"./build/src/index.d.ts","repository":"googleapis/google-auth-library-nodejs.git","keywords":["google","api","google apis","client","client library"],"dependencies":{"base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11","gaxios":"^7.0.0","gcp-metadata":"^8.0.0","google-logging-utils":"^1.0.0","gtoken":"^8.0.0","jws":"^4.0.0"},"devDependencies":{"@types/base64-js":"^1.2.5","@types/jws":"^3.1.0","@types/mocha":"^10.0.10","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","assert-rejects":"^1.0.0","c8":"^10.0.0","codecov":"^3.0.2","gts":"^6.0.0","is-docker":"^3.0.0","jsdoc":"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0","karma":"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1","keypair":"^1.0.4","mocha":"^11.1.0","mv":"^2.1.1","ncp":"^2.0.0","nock":"^14.0.5","null-loader":"^4.0.0","puppeteer":"^24.0.0","sinon":"^21.0.0","ts-loader":"^8.0.0","typescript":"5.8.2","webpack":"^5.21.2","webpack-cli":"^4.0.0"},"files":["build/src","!build/src/**/*.map"],"scripts":{"test":"c8 mocha build/test","clean":"gts clean","prepare":"npm run compile","lint":"gts check --no-inline-config","compile":"tsc -p .","fix":"gts fix","pretest":"npm run compile -- --sourceMap","docs":"jsdoc -c .jsdoc.js","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile -- --sourceMap","webpack":"webpack","browser-test":"karma start","docs-test":"echo \'disabled until linkinator is fixed\'","predocs-test":"npm run docs","prelint":"cd samples; npm link ../; npm install"},"license":"Apache-2.0"}')}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,456,14,79],()=>r(53721));module.exports=n})();